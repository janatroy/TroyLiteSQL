using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Text;
using System.IO;


public partial class ReportXLStock : System.Web.UI.Page
{
    int catid = 0;
    string brand = "";
    string model = "";
    string product = "";
    decimal Gtotal = 0;
    decimal Gttl = 0;
    decimal Pttls = 0;
    decimal Ittls = 0;
    decimal brandTotal = 0, catIDTotal = 0, modelTotal = 0;
    string grpBy = "", selCols = "", selLevels = "", field1 = "", field2 = "", ordrby = "", cond = "", Subordrby="";

    //DBClass objBL = new DBClass();
    BusinessLogic objBL = new BusinessLogic();
    private string sDataSource = string.Empty;

    protected void Page_Load(object sender, EventArgs e)
    {
        try
        {
            ModalPopupStock.Show();
            objBL = new BusinessLogic(ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString());
            sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();

            //hiding label and displaying popup message
            lblMsg.Visible = false;
            if (!Page.IsPostBack)
            {

                RequiredFieldValidator5.Enabled = false;
                //fillfBrand();
                //fillCategorys();
                //fillProduct();
                //fillModel();
                //fillitemcode();
                LoadProducts(this, null);
                //loadCategories();
                fillCategorys();
                txtStartDate.Text = DateTime.Now.ToString("dd/MM/yyyy");
                //  fillProduct();
                //fillStock();
                ddlFirst();
                ddlSconed();
                ddlThird();
                ddlFour();
                ddlFifth();
                odlFirst();
                odlSconed();
                odlThird();
                odlFour();
                odlFifth();
                fillretrive();
                ddlFirstSub();
                ddlSecondSub();
                ddlThirdSub();
                ddlFourSub();
                ddlFiveSub();

                Stocktxtbox.Visible = false;
                Ratetxtbox.Visible = false;
                Vattxtbox.Visible = false;
                buyratetxtbox.Visible = false;
                Nlctxtbox.Visible = false;

            }
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }

    private void loadCategories()
    {
        //string sDataSource = Server.MapPath(ConfigurationSettings.AppSettings["DataSource"].ToString());
        BusinessLogic bl = new BusinessLogic();
        DataSet ds = new DataSet();
        ds = bl.ListCategory(sDataSource,"");
        ddlCategory.DataTextField = "CategoryName";
        ddlCategory.DataValueField = "CategoryID";
        ddlCategory.DataSource = ds;
        ddlCategory.DataBind();
    }

    protected void LoadProducts(object sender, EventArgs e)
    {
        sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();
        string CategoryID = ddlCategory.SelectedValue;
        BusinessLogic bl = new BusinessLogic(sDataSource);
        DataSet ds = new DataSet();
        ds = bl.ListProductsForCategoryID(CategoryID, "");
        ddlItemCode.Items.Clear();
        ddlItemCode.DataSource = ds;
        ddlItemCode.Items.Insert(0, new ListItem("All", "0"));
        ddlItemCode.DataTextField = "ItemCode";
        ddlItemCode.DataValueField = "ItemCode";
        ddlItemCode.DataBind();

        ds = bl.ListModelsForCategoryID(CategoryID, "");
        ddlMdl.Items.Clear();
        ddlMdl.DataSource = ds;
        ddlMdl.Items.Insert(0, new ListItem("All", "0"));
        ddlMdl.DataTextField = "Model";
        ddlMdl.DataValueField = "Model";
        ddlMdl.DataBind();

        ds = bl.ListBrandsForCategoryID(CategoryID, "");
        ddlBrand.Items.Clear();
        ddlBrand.DataSource = ds;
        ddlBrand.Items.Insert(0, new ListItem("All", "0"));
        ddlBrand.DataTextField = "ProductDesc";
        ddlBrand.DataValueField = "ProductDesc";
        ddlBrand.DataBind();

        ds = bl.ListProdNameForCategoryID(CategoryID, "");
        ddlPrdctNme.Items.Clear();
        ddlPrdctNme.DataSource = ds;
        ddlPrdctNme.Items.Insert(0, new ListItem("All", "0"));
        ddlPrdctNme.DataTextField = "ProductName";
        ddlPrdctNme.DataValueField = "ProductName";
        ddlPrdctNme.DataBind();

        LoadForProduct(this, null);
    }

    protected void LoadForBrand(object sender, EventArgs e)
    {
        sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();
        BusinessLogic bl = new BusinessLogic(sDataSource);
        string brand = ddlBrand.SelectedValue;
        string CategoryID = ddlCategory.SelectedValue;
        //DataSet catData = bl.GetProductForId(sDataSource, itemCode);
        //cmbProdAdd.SelectedValue = itemCode;
        //cmbModel.SelectedValue = itemCode;
        DataSet ds = new DataSet();
        ds = bl.ListModelsForBrand(brand, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlMdl.Items.Clear();
            ddlMdl.DataSource = ds;
            ddlMdl.DataTextField = "Model";
            ddlMdl.DataValueField = "Model";
            ddlMdl.DataBind();
        }

        ds = bl.ListProdcutsForBrand(brand, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlItemCode.Items.Clear();
            ddlItemCode.DataSource = ds;
            ddlItemCode.DataTextField = "ItemCode";
            ddlItemCode.DataValueField = "ItemCode";
            ddlItemCode.DataBind();
        }

        ds = bl.ListProdcutNameForBrand(brand, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlPrdctNme.Items.Clear();
            ddlPrdctNme.DataSource = ds;
            ddlPrdctNme.DataTextField = "ProductName";
            ddlPrdctNme.DataValueField = "ProductName";
            ddlPrdctNme.DataBind();
        }
        cmbProdAdd_SelectedIndexChanged(this, null);

    }

    protected void LoadForModel(object sender, EventArgs e)
    {
        sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();
        BusinessLogic bl = new BusinessLogic(sDataSource);
        string model = ddlMdl.SelectedValue;
        string CategoryID = ddlCategory.SelectedValue;
        DataSet ds = new DataSet();

        ds = bl.ListProdcutsForModel(model, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlItemCode.Items.Clear();
            ddlItemCode.DataSource = ds;
            ddlItemCode.DataTextField = "ItemCode";
            ddlItemCode.DataValueField = "ItemCode";
            ddlItemCode.DataBind();
        }

        ds = bl.ListBrandsForModel(model, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlBrand.Items.Clear();
            ddlBrand.DataSource = ds;
            ddlBrand.DataTextField = "ProductDesc";
            ddlBrand.DataValueField = "ProductDesc";
            ddlBrand.DataBind();
        }

        ds = bl.ListProductNameForModel(model, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlPrdctNme.Items.Clear();
            ddlPrdctNme.DataSource = ds;
            ddlPrdctNme.DataTextField = "ProductName";
            ddlPrdctNme.DataValueField = "ProductName";
            ddlPrdctNme.DataBind();
        }
        cmbProdAdd_SelectedIndexChanged(this, null);
    }

    protected void LoadForProductName(object sender, EventArgs e)
    {
        sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();
        BusinessLogic bl = new BusinessLogic(sDataSource);
        string prodName = ddlPrdctNme.SelectedValue;
        string CategoryID = ddlCategory.SelectedValue;
        DataSet ds = new DataSet();

        ds = bl.ListProdcutsForProductName(prodName, CategoryID, "");

        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlItemCode.Items.Clear();
            ddlItemCode.DataSource = ds;
            ddlItemCode.DataTextField = "ItemCode";
            ddlItemCode.DataValueField = "ItemCode";
            ddlItemCode.DataBind();
        }

        ds = bl.ListBrandsForProductName(prodName, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlBrand.Items.Clear();
            ddlBrand.DataSource = ds;
            ddlBrand.DataTextField = "ProductDesc";
            ddlBrand.DataValueField = "ProductDesc";
            ddlBrand.DataBind();
        }

        ds = bl.ListModelsForProductName(prodName, CategoryID, "");
        if (ds != null && ds.Tables[0].Rows.Count > 0)
        {
            ddlMdl.Items.Clear();
            ddlMdl.DataSource = ds;
            ddlMdl.DataTextField = "Model";
            ddlMdl.DataValueField = "Model";
            ddlMdl.DataBind();
        }
        cmbProdAdd_SelectedIndexChanged(this, null);
    }

    protected void cmbProdAdd_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            sDataSource = ConfigurationManager.ConnectionStrings[Request.Cookies["Company"].Value].ToString();
            BusinessLogic bl = new BusinessLogic(sDataSource);
            DataSet ds = new DataSet();
            DataSet roleDs = new DataSet();
            string itemCode = string.Empty;
            DataSet checkDs;

            if (ddlItemCode.SelectedItem != null)
            {
                itemCode = ddlItemCode.SelectedItem.Value.Trim();

                DataSet catData = bl.GetProductForId(sDataSource, ddlItemCode.SelectedItem.Value.Trim());

                if (catData != null)
                {
                    if ((catData.Tables[0].Rows[0]["Model"] != null) && (catData.Tables[0].Rows[0]["Model"].ToString() != ""))
                    {
                        if (ddlMdl.Items.FindByValue(catData.Tables[0].Rows[0]["Model"].ToString().Trim()) != null)
                        {
                            ddlMdl.ClearSelection();
                            if (!ddlMdl.Items.FindByValue(catData.Tables[0].Rows[0]["Model"].ToString().Trim()).Selected)
                                ddlMdl.Items.FindByValue(catData.Tables[0].Rows[0]["Model"].ToString().Trim()).Selected = true;

                        }
                    }

                    if ((catData.Tables[0].Rows[0]["ProductDesc"] != null) && (catData.Tables[0].Rows[0]["ProductDesc"].ToString() != ""))
                    {
                        if (ddlBrand.Items.FindByValue(catData.Tables[0].Rows[0]["ProductDesc"].ToString().Trim()) != null)
                        {
                            ddlBrand.ClearSelection();
                            if (!ddlBrand.Items.FindByValue(catData.Tables[0].Rows[0]["ProductDesc"].ToString().Trim()).Selected)
                                ddlBrand.Items.FindByValue(catData.Tables[0].Rows[0]["ProductDesc"].ToString().Trim()).Selected = true;
                        }
                    }

                    if ((catData.Tables[0].Rows[0]["ProductName"] != null) && (catData.Tables[0].Rows[0]["ProductName"].ToString() != ""))
                    {
                        if (ddlPrdctNme.Items.FindByValue(catData.Tables[0].Rows[0]["ProductName"].ToString().Trim()) != null)
                        {
                            ddlPrdctNme.ClearSelection();
                            if (!ddlPrdctNme.Items.FindByValue(catData.Tables[0].Rows[0]["ProductName"].ToString().Trim()).Selected)
                                ddlPrdctNme.Items.FindByValue(catData.Tables[0].Rows[0]["ProductName"].ToString().Trim()).Selected = true;
                        }
                    }
                }
            }
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }

    protected void LoadForProduct(object sender, EventArgs e)
    {
        //string itemCode = cmbProdAdd.SelectedValue;
        //cmbModel.SelectedValue = itemCode;
        //cmbBrand.SelectedValue = itemCode;
        cmbProdAdd_SelectedIndexChanged(sender, e);
    }

    private void ddlFirst()
    {
        ddlfirstlvl.Items.Insert(0, "None");
        ddlfirstlvl.Items.Insert(1, "Brand");
        ddlfirstlvl.Items.Insert(2, "CategoryName");
        ddlfirstlvl.Items.Insert(3, "Model");
        ddlfirstlvl.Items.Insert(4, "ProductName");
        ddlfirstlvl.Items.Insert(5, "ItemCode");

    }


    private void ddlFirstSub()
    {
        DdlFirstSub.Items.Insert(0, "None");
        DdlFirstSub.Items.Insert(1, "Brand");
        DdlFirstSub.Items.Insert(2, "CategoryName");
        DdlFirstSub.Items.Insert(3, "Model");
        DdlFirstSub.Items.Insert(4, "ProductName");
        DdlFirstSub.Items.Insert(5, "ItemCode");

    }

    private void ddlSecondSub()
    {
        DdlSecondSub.Items.Insert(0, "None");
        DdlSecondSub.Items.Insert(1, "Brand");
        DdlSecondSub.Items.Insert(2, "CategoryName");
        DdlSecondSub.Items.Insert(3, "Model");
        DdlSecondSub.Items.Insert(4, "ProductName");
        DdlSecondSub.Items.Insert(5, "ItemCode");

    }

    private void ddlThirdSub()
    {
        DdlThirdSub.Items.Insert(0, "None");
        DdlThirdSub.Items.Insert(1, "Brand");
        DdlThirdSub.Items.Insert(2, "CategoryName");
        DdlThirdSub.Items.Insert(3, "Model");
        DdlThirdSub.Items.Insert(4, "ProductName");
        DdlThirdSub.Items.Insert(5, "ItemCode");

    }

    private void ddlFourSub()
    {
        DdlFourSub.Items.Insert(0, "None");
        DdlFourSub.Items.Insert(1, "Brand");
        DdlFourSub.Items.Insert(2, "CategoryName");
        DdlFourSub.Items.Insert(3, "Model");
        DdlFourSub.Items.Insert(4, "ProductName");
        DdlFourSub.Items.Insert(5, "ItemCode");

    }

    private void ddlFiveSub()
    {
        DdlFiveSub.Items.Insert(0, "None");
        DdlFiveSub.Items.Insert(1, "Brand");
        DdlFiveSub.Items.Insert(2, "CategoryName");
        DdlFiveSub.Items.Insert(3, "Model");
        DdlFiveSub.Items.Insert(4, "ProductName");
        DdlFiveSub.Items.Insert(5, "ItemCode");

    }

    private void ddlSconed()
    {
        ddlsecondlvl.Items.Insert(0, "None");
        ddlsecondlvl.Items.Insert(1, "Brand");
        ddlsecondlvl.Items.Insert(2, "CategoryName");
        ddlsecondlvl.Items.Insert(3, "Model");
        ddlsecondlvl.Items.Insert(4, "ProductName");
        ddlsecondlvl.Items.Insert(5, "ItemCode");

    }
    private void ddlThird()
    {
        ddlthirdlvl.Items.Insert(0, "None");
        ddlthirdlvl.Items.Insert(1, "Brand");
        ddlthirdlvl.Items.Insert(2, "CategoryName");
        ddlthirdlvl.Items.Insert(3, "Model");
        ddlthirdlvl.Items.Insert(4, "ProductName");
        ddlthirdlvl.Items.Insert(5, "ItemCode");
    }
    private void ddlFour()
    {
        ddlfourlvl.Items.Insert(0, "None");
        ddlfourlvl.Items.Insert(1, "Brand");
        ddlfourlvl.Items.Insert(2, "CategoryName");
        ddlfourlvl.Items.Insert(3, "Model");
        ddlfourlvl.Items.Insert(4, "ProductName");
        ddlfourlvl.Items.Insert(5, "ItemCode");
    }
    private void ddlFifth()
    {
        ddlfifthlvl.Items.Insert(0, "None");
        ddlfifthlvl.Items.Insert(1, "Brand");
        ddlfifthlvl.Items.Insert(2, "CategoryName");
        ddlfifthlvl.Items.Insert(3, "Model");
        ddlfifthlvl.Items.Insert(4, "ProductName");
        ddlfifthlvl.Items.Insert(5, "ItemCode");
    }
    private void odlFirst()
    {

        odlfirstlvl.Items.Insert(0, "None");
        odlfirstlvl.Items.Insert(1, "Brand");
        odlfirstlvl.Items.Insert(2, "CategoryName");
        odlfirstlvl.Items.Insert(3, "Model");
        odlfirstlvl.Items.Insert(4, "ProductName");
        odlfirstlvl.Items.Insert(5, "ItemCode");
    }
    private void odlSconed()
    {
        odlsecondlvl.Items.Insert(0, "None");
        odlsecondlvl.Items.Insert(1, "Brand");
        odlsecondlvl.Items.Insert(2, "CategoryName");
        odlsecondlvl.Items.Insert(3, "Model");
        odlsecondlvl.Items.Insert(4, "ProductName");
        odlsecondlvl.Items.Insert(5, "ItemCode");
    }
    private void odlThird()
    {
        odlthirdlvl.Items.Insert(0, "None");
        odlthirdlvl.Items.Insert(1, "Brand");
        odlthirdlvl.Items.Insert(2, "CategoryName");
        odlthirdlvl.Items.Insert(3, "Model");
        odlthirdlvl.Items.Insert(4, "ProductName");
        odlthirdlvl.Items.Insert(5, "ItemCode");
    }
    private void odlFour()
    {
        odlfourlvl.Items.Insert(0, "None");
        odlfourlvl.Items.Insert(1, "Brand");
        odlfourlvl.Items.Insert(2, "CategoryName");
        odlfourlvl.Items.Insert(3, "Model");
        odlfourlvl.Items.Insert(4, "ProductName");
        odlfourlvl.Items.Insert(5, "ItemCode");
    }
    private void odlFifth()
    {
        odlfifthlvl.Items.Insert(0, "None");
        odlfifthlvl.Items.Insert(1, "Brand");
        odlfifthlvl.Items.Insert(2, "CategoryName");
        odlfifthlvl.Items.Insert(3, "Model");
        odlfifthlvl.Items.Insert(4, "ProductName");
        odlfifthlvl.Items.Insert(5, "ItemCode");
    }
    private void fillfBrand()
    {
        DataSet ds = new DataSet();
        ds = objBL.getDistinctBrand();
        ddlBrand.DataSource = ds;
        ddlBrand.DataTextField = "Brand";
        ddlBrand.DataValueField = "Brand";
        ddlBrand.DataBind();
        ddlBrand.Items.Insert(0, "All");
    }
    private void fillretrive()
    {
        DataSet ds = new DataSet();
        ds = objBL.getsavename();
        ddlretrive.DataSource = ds;
        ddlretrive.DataTextField = "savname";

        ddlretrive.DataBind();
        ddlretrive.Items.Insert(0, "None");

    }

    private void fillCategorys()
    {
        DataSet ds = new DataSet();
        ds = objBL.getDistinctCategorys();
        ddlCategory.DataSource = ds;
        ddlCategory.DataTextField = "CategoryName";
        ddlCategory.DataValueField = "CategoryID";
        ddlCategory.DataBind();
        ddlCategory.Items.Insert(0, "All");
    }
    private void fillModel()
    {
        DataSet ds = new DataSet();
        ds = objBL.getDistinctModel();
        ddlMdl.DataSource = ds;
        ddlMdl.DataTextField = "Model";
        ddlMdl.DataValueField = "Model";
        ddlMdl.DataBind();
        ddlMdl.Items.Insert(0, "All");

    }
    private void fillProduct()
    {
        DataSet ds = new DataSet();
        ds = objBL.getDistinctPrdctNme();
        ddlPrdctNme.DataSource = ds;
        ddlPrdctNme.DataTextField = "ProductName";
        ddlPrdctNme.DataValueField = "ProductName";
        ddlPrdctNme.DataBind();
        ddlPrdctNme.Items.Insert(0, "All");
    }
    private void fillitemcode()
    {
        DataSet ds = new DataSet();
        ds = objBL.getDistinctItemCode();
        ddlItemCode.DataSource = ds;
        ddlItemCode.DataTextField = "ItemCode";
        ddlItemCode.DataValueField = "ItemCode";
        ddlItemCode.DataBind();
        ddlItemCode.Items.Insert(0, "All");
    }
    protected string getfield()
    {
        string field1 = "";
        //string field2="";
        string field = "";
        if (chkboxCategory.Checked)
        {
           
            if (field1 == "")
            {

                field1 = "";
            }
            else
            {

                field1 += " , ";
            }

            field1 += "CategoryName";
        }
        if (chkboxBrand.Checked)
        {
          
            if (field1 == "")
            {

                field1 = "";
            }
            else
            {

                field1 += " , ";
            }
            field1 += "Brand";
        }
        if (chkboxProduct.Checked)
        {
            
            if (field1 == "")
            {

                field1 = "";
            }
            else
            {

                field1 += " , ";
            }
            field1 += "ProductName";

        }
        if (chkboxModel.Checked)
        {
           
            if (field1 == "")
            {

                field1 = "";
            }
            else
            {

                field1 += " , ";
            }
            field1 += "Model";

        }
        if (chkboxItemCode.Checked)
        {
            if (field1 == "")
            {

                field1 = "";
            }
            else
            {

                field1 += " , ";
            }
            field1 += "ItemCode";

        }
        if (field1 != "")
        {
            field1 += ",";
        }
        field1 = field1.Replace("Brand", "ProductDesc");
        return field1;
    }
    protected string getfield2()
    {
        string field2 = "";
        getGrpByAndSelCols();
        if (grpBy != "")
        {
            if (chkboxRate.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }
                //field1 += "ItemCode";

                field2 += "Sum(Rate) as Rate";
            }
            if (chkboxVat.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "Sum(VAT) as VAT";
            }
            if (chkboxBuyrate.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "Sum(BuyRate) as BuyRate";
            }

            if (chkboxNlc.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "Sum(NLC) as NLC";
            }
            if (chkboxStock.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "Sum(Quantity) as Stock";
            }
            if (field2 != "")
            {
                field2 += ",sum(Stock*Rate) As SalesValue";
            }
            field2 = field2.Replace("Quantity", "Stock");
        }
        else
        {
            if (chkboxRate.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }
                //field1 += "ItemCode";

                field2 += "Rate";
            }
            if (chkboxVat.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "VAT";
            }
            if (chkboxBuyrate.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "BuyRate";
            }

            if (chkboxNlc.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "NLC";
            }
            if (chkboxStock.Checked)
            {
                if (field2 == "")
                {

                    field2 = "";
                }
                else
                {

                    field2 += " , ";
                }

                field2 += "Quantity";
            }

            field2 = field2.Replace("Quantity", "Stock");
            if (field2 != "")
            {
                field2 += ",(Stock*Rate) As SalesValue";
            }
           
        }
        return field2;

    }

    protected string getCond()
    {
        //string cond;

        //where ProductDesc='" + Brand + "' and CategoryID=" + Convert.ToInt32(Categorys) + " and Model='" + Models + "' and ProductName='" + PrdctNme + "'
        if (ddlBrand.SelectedItem.Text != "All")
        {
            objBL.Brands = ddlBrand.SelectedItem.Text;
            cond = " and ProductDesc='" + ddlBrand.SelectedItem.Text + "' ";
        }
        if (ddlCategory.SelectedItem.Text != "All")
        {
            objBL.Categorys = Convert.ToInt32(ddlCategory.SelectedItem.Value);
            cond += " and PM.CategoryID=" + Convert.ToInt32(ddlCategory.SelectedItem.Value) + " ";
        }
        //else if (ddlCategory.SelectedItem.Value != "")
        //{
        //    objBL.Categorys = Convert.ToInt32(ddlCategory.SelectedItem.Value);
        //    cond += " and PM.CategoryID=" + Convert.ToInt32(ddlCategory.SelectedItem.Value) + " ";
        //}
        if (ddlMdl.SelectedItem.Text != "All")
        {
            objBL.Models = ddlMdl.SelectedItem.Text;
            cond += " and Model='" + ddlMdl.SelectedItem.Text + "' ";
        }
        if (ddlPrdctNme.SelectedItem.Text != "All")
        {
            objBL.PrdctNmes = ddlPrdctNme.SelectedItem.Text;
            cond += " and ProductName='" + ddlPrdctNme.SelectedItem.Text + "' ";
        }
        /*if (ddlStock.SelectedItem.Text != "None")
        {
            cond += " and Stock > 0 ";
        }*/
        if (ddlItemCode.SelectedItem.Text != "All")
        {
            objBL.Itemcodes = ddlItemCode.SelectedItem.Text;
            cond += " and ItemCode= '" + ddlItemCode.SelectedItem.Text + "'";
        }
        if (ddlStock.SelectedItem.Text != "All")
        {
            Stocktxtbox.Visible = true;
            try
            {
                if (ddlStock.SelectedItem.Text == "=")
                {
                    objBL.StockValues = Stocktxtbox.Text;
                    cond += " and Stock =" + Stocktxtbox.Text;
                }

                else if (ddlStock.SelectedItem.Text == ">")
                {
                    // buyratetxtbox.show();

                    objBL.StockValues = Stocktxtbox.Text;
                    cond += " and Stock >" + Stocktxtbox.Text;
                    if (Stocktxtbox.Text == "")
                    {
                        Label27.Text = "Please enter a quantity";
                    }
                }
                else if (ddlStock.SelectedItem.Text == "<")
                {
                    //buyratetxtbox.show();
                    objBL.StockValues = Stocktxtbox.Text;
                    cond += " and Stock < " + Stocktxtbox.Text;
                    if (Stocktxtbox.Text == "")
                    {
                        Label27.Text = "Please enter a quantity";
                    }
                }
            }
            catch
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Not Data Found');", true);
            }

            /* if (ddlStock.SelectedItem.Text = "All")
             {
                 cond +=" ";
             }*/


        }
        if (ddlRate.SelectedItem.Text != "All")
        {
            try
            {

                Ratetxtbox.Visible = true;
                if (ddlRate.SelectedItem.Text == "=")
                {
                    objBL.Rated = Ratetxtbox.Text;
                    cond += " and Rate =" + Ratetxtbox.Text;
                    if (Ratetxtbox.Text == "")
                    {
                        Label31.Text = "Please enter a rate";
                    }
                }
                else if (ddlRate.SelectedItem.Text == ">")
                {
                    //Ratetxtbox.text.show();
                    objBL.Rated = Ratetxtbox.Text;
                    cond += " and Rate > " + Ratetxtbox.Text;
                    if (Ratetxtbox.Text == "")
                    {
                        Label31.Text = "Please enter a rate";
                    }
                }
                else if (ddlRate.SelectedItem.Text == "<")
                {
                    //Ratetxtbox.text.show();
                    objBL.Rated = Ratetxtbox.Text;
                    cond += " and Rate <" + Ratetxtbox.Text;
                    if (Ratetxtbox.Text == "")
                    {
                        Label31.Text = "Please enter a rate";
                    }
                }
            }
            catch
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Not Data Found');", true);
            }
        }
        if (ddlNlc.SelectedItem.Text != "All")
        {

            // int valueNLC = 0;
            Nlctxtbox.Visible = true;
            try
            {
                if (ddlNlc.SelectedItem.Text == "=")
                {
                    objBL.Nlcs = Nlctxtbox.Text;
                    cond += " and NLC =" + Nlctxtbox.Text;
                    if (Nlctxtbox.Text == "")
                    {
                        Label29.Text = "Please enter a nlc";
                    }
                }
                else if (ddlNlc.SelectedItem.Text == ">")
                {
                    // NLCtxtbox.text.show();
                    objBL.Nlcs = Nlctxtbox.Text;
                    cond += " and NLC >" + Nlctxtbox.Text;
                    if (Nlctxtbox.Text == "")
                    {
                        Label29.Text = "Please enter a nlc";
                    }
                }
                else if (ddlNlc.SelectedItem.Text == "<")
                {
                    //NLCtxtbox.text.show();
                    objBL.Nlcs = Nlctxtbox.Text;
                    cond += " and NLC <" + Nlctxtbox.Text;
                    if (Nlctxtbox.Text == "")
                    {
                        Label29.Text = "Please enter a nlc";
                    }
                }
            }
            catch
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Not Data Found');", true);
            }
        }

        if (ddlBuyrate.SelectedItem.Text != "All")
        {
            //  int valuebuyrate = 0;
            buyratetxtbox.Visible = true;
            try
            {
                if (ddlBuyrate.SelectedItem.Text == "=")
                {
                    objBL.Buyrates = buyratetxtbox.Text;
                    cond += " and BuyRate =" + buyratetxtbox.Text;
                    if (buyratetxtbox.Text == "")
                    {
                        Label30.Text = "Please enter a buyrate";
                    }
                }
                else if (ddlBuyrate.SelectedItem.Text == ">")
                {
                    //buyratetxtbox.text.show();
                    objBL.Buyrates = buyratetxtbox.Text;
                    cond += " and BuyRate >" + buyratetxtbox.Text;
                    if (buyratetxtbox.Text == "")
                    {
                        Label30.Text = "Please enter a buyrate";
                    }
                }
                else if (ddlBuyrate.SelectedItem.Text == "<")
                {
                    objBL.Buyrates = buyratetxtbox.Text;
                    cond += " and BuyRate <" + buyratetxtbox.Text;
                    if (buyratetxtbox.Text == "")
                    {
                        Label30.Text = "Please enter a buyrate";
                    }
                }
            }
            catch
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Not Data Found');", true);
            }
        }

        if (ddlVat.SelectedItem.Text != "All")
        {
            // int valuevat = 0;
            Vattxtbox.Visible = true;
            try
            {
                Vattxtbox.EnableViewState = true;
                if (ddlVat.SelectedItem.Text == "=")
                {
                    objBL.Vats = Vattxtbox.Text;
                    cond += " and VAT =" + Vattxtbox.Text;
                    if (Vattxtbox.Text == "")
                    {
                        Label28.Text = "Please enter a vat";
                    }
                }
                else if (ddlVat.SelectedItem.Text == ">")
                {
                    //VATtxtbox.text.show();
                    objBL.Vats = Vattxtbox.Text;
                    cond += " and VAT >" + Vattxtbox.Text;
                    if (Vattxtbox.Text == "")
                    {
                        Label28.Text = "Please enter a vat";
                    }

                }
                else if (ddlVat.SelectedItem.Text == "<")
                {
                    //VATtxtbox.text.show();
                    objBL.Vats = Vattxtbox.Text;
                    cond += " and VAT <" + Vattxtbox.Text;
                    if (Vattxtbox.Text == "")
                    {
                        Label28.Text = "Please enter a vat";
                    }
                }
            }
            catch
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Not Data Found');", true);
            }
        }


        //objBL.Stock = Convert.ToInt32(ddlStock.SelectedItem.Text);
        return cond;
    }

   

    protected void getGrpByAndSelCols()
    {
         grpBy = "";
         selCols = "";
        if (ddlfirstlvl.SelectedItem.Text != "None")
        {
            grpBy = " group by " + ddlfirstlvl.SelectedItem.Text + " ";
            selCols = ddlfirstlvl.SelectedItem.Text;
        }
        if (ddlsecondlvl.SelectedItem.Text != "None")
        {
            if (grpBy == "")
            {
                grpBy = " group by ";
                selCols = " ";
            }
            else
            {
                grpBy += " , ";
                selCols += " , ";
            }
            grpBy += " " + ddlsecondlvl.SelectedItem.Text + " ";
            selCols += " " + ddlsecondlvl.SelectedItem.Text + " ";
        }
        if (ddlthirdlvl.SelectedItem.Text != "None")
        {
            if (grpBy == "")
            {
                grpBy = " group by ";
                selCols = " ";
            }
            else
            {
                grpBy += " , ";
                selCols += " , ";
            }
            grpBy += " " + ddlthirdlvl.SelectedItem.Text + " ";
            selCols += " " + ddlthirdlvl.SelectedItem.Text + " ";
        }
        if (ddlfourlvl.SelectedItem.Text != "None")
        {
            if (grpBy == "")
            {
                grpBy = " group by ";
                selCols = " ";
            }
            else
            {
                grpBy += " , ";
                selCols += " , ";
            }
            grpBy += " " + ddlfourlvl.SelectedItem.Text + " ";
            selCols += " " + ddlfourlvl.SelectedItem.Text + " ";
        }
        if (ddlfifthlvl.SelectedItem.Text != "None")
        {
            if (grpBy == "")
            {
                grpBy = " group by ";
                selCols = " ";
            }
            else
            {
                grpBy += " , ";
                selCols += " , ";
            }
            grpBy += " " + ddlfifthlvl.SelectedItem.Text + " ";
            selCols += " " + ddlfifthlvl.SelectedItem.Text + " ";
        }

        if ((grpBy == "") && (selCols == ""))
        {
            //field1 = getfield();
            //field2 = getfield2();
            //grpBy += " group by " + field1;
            field1 = getfield();
            selCols = " " + field1;
        }
        else
        {
            selCols += ",";
        }


        selCols = selCols.Replace("Brand", "ProductDesc");
        selCols = selCols.Replace("CategoryID", "CategoryName");
        grpBy = grpBy.Replace("Brand", "ProductDesc");
        grpBy = grpBy.Replace("CategoryID", "CategoryName");
        //return grpBy;
        //return selCols;
    }

    protected string odrby()
    {

        string ordrby = "";
        if (odlfirstlvl.SelectedItem.Text != "None")
        {

            ordrby += " order by " + odlfirstlvl.SelectedItem.Text + " ";
        }
        if (odlsecondlvl.SelectedItem.Text != "None")
        {
            if (ordrby == "")
            {
                ordrby += " order by";
            }
            else
            {
                ordrby += " , ";
            }
            ordrby += " " + odlsecondlvl.SelectedItem.Text + " ";
        }
        if (odlthirdlvl.SelectedItem.Text != "None")
        {
            if (ordrby == "")
            {
                ordrby += " order by";
            }
            else
            {
                ordrby += " , ";
            }
            ordrby += " " + odlthirdlvl.SelectedItem.Text + " ";
        }
        if (odlfourlvl.SelectedItem.Text != "None")
        {
            if (ordrby == "")
            {
                ordrby += " order by";
            }
            else
            {
                ordrby += " , ";
            }
            ordrby += " " + odlfourlvl.SelectedItem.Text + " ";
        }
        if (odlfifthlvl.SelectedItem.Text != "None")
        {
            if (ordrby == "")
            {
                ordrby += " order by";
            }
            else
            {
                ordrby += " , ";

            }
            ordrby += " " + odlfifthlvl.SelectedItem.Text + " ";
        }
        /*if (ordrby == "")
        {
            field1 = getfield();
            ordrby = field1;
        }*/
        ordrby = ordrby.Replace("Brand", "ProductDesc");
        ordrby = ordrby.Replace("CategoryID", "CategoryName");
        return ordrby;
    }

    protected string Subodrby()
    {

        string Subordrby = "";
        if (DdlFirstSub.SelectedItem.Text != "None")
        {

            Subordrby += " order by " + DdlFirstSub.SelectedItem.Text + " ";
        }
        if (DdlSecondSub.SelectedItem.Text != "None")
        {
            if (Subordrby == "")
            {
                Subordrby += " order by";
            }
            else
            {
                Subordrby += " , ";
            }
            Subordrby += " " + DdlSecondSub.SelectedItem.Text + " ";
        }
        if (DdlThirdSub.SelectedItem.Text != "None")
        {
            if (Subordrby == "")
            {
                Subordrby += " order by";
            }
            else
            {
                Subordrby += " , ";
            }
            Subordrby += " " + DdlThirdSub.SelectedItem.Text + " ";
        }
        if (DdlFourSub.SelectedItem.Text != "None")
        {
            if (Subordrby == "")
            {
                Subordrby += " order by";
            }
            else
            {
                Subordrby += " , ";
            }
            Subordrby += " " + DdlFourSub.SelectedItem.Text + " ";
        }
        if (DdlFiveSub.SelectedItem.Text != "None")
        {
            if (Subordrby == "")
            {
                Subordrby += " order by";
            }
            else
            {
                Subordrby += " , ";

            }
            Subordrby += " " + DdlFiveSub.SelectedItem.Text + " ";
        }
        /*if (ordrby == "")
        {
            field1 = getfield();
            ordrby = field1;
        }*/
        Subordrby = Subordrby.Replace("Brand", "ProductDesc");
        Subordrby = Subordrby.Replace("CategoryID", "CategoryName");
        return Subordrby;
    }


    protected string SubTotby()
    {

        string subTot = "";
        if (DdlFirstSub.SelectedItem.Text != "None")
        {

            subTot = " order by " + odlfirstlvl.SelectedItem.Text + " ";
        }
        if (odlsecondlvl.SelectedItem.Text != "None")
        {
            if (subTot == "")
            {
                subTot += " order by";
            }
            else
            {
                subTot += " , ";
            }
            subTot += " " + odlsecondlvl.SelectedItem.Text + " ";
        }
        if (odlthirdlvl.SelectedItem.Text != "None")
        {
            if (subTot == "")
            {
                subTot += " order by";
            }
            else
            {
                subTot += " , ";
            }
            ordrby += " " + odlthirdlvl.SelectedItem.Text + " ";
        }
        if (odlfourlvl.SelectedItem.Text != "None")
        {
            if (subTot == "")
            {
                subTot += " order by";
            }
            else
            {
                subTot += " , ";
            }
            subTot += " " + odlfourlvl.SelectedItem.Text + " ";
        }
        if (odlfifthlvl.SelectedItem.Text != "None")
        {
            if (subTot == "")
            {
                subTot += " order by";
            }
            else
            {
                subTot += " , ";

            }
            subTot += " " + odlfifthlvl.SelectedItem.Text + " ";
        }
        /*if (ordrby == "")
        {
            field1 = getfield();
            ordrby = field1;
        }*/
        subTot = ordrby.Replace("Brand", "ProductDesc");
        subTot = ordrby.Replace("CategoryID", "CategoryName");
        return subTot;
    }


    private bool isValidLevels()
    {
        lblMsg.EnableViewState = true;
        lblMsg.Visible = true;
        if (ddlfirstlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") &&
                (ddlfirstlvl.SelectedItem.Text == ddlsecondlvl.SelectedItem.Text ||
                ddlfirstlvl.SelectedItem.Text == ddlthirdlvl.SelectedItem.Text ||
                ddlfirstlvl.SelectedItem.Text == ddlfourlvl.SelectedItem.Text ||
                ddlfirstlvl.SelectedItem.Text == ddlfifthlvl.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different levels');", true);
              //  lblMsg.Text = "Two levels can NOT be same. Please select different levels";
              //  lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (ddlsecondlvl.SelectedItem.Text != "None")
        {
            if ((ddlsecondlvl.SelectedItem.Text != "None") &&
                (ddlsecondlvl.SelectedItem.Text == ddlthirdlvl.SelectedItem.Text ||
                ddlsecondlvl.SelectedItem.Text == ddlfourlvl.SelectedItem.Text ||
                ddlsecondlvl.SelectedItem.Text == ddlfifthlvl.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different levels');", true);
                //lblMsg.Text = "Two levels can NOT be same. Please select different levels";
               // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (ddlthirdlvl.SelectedItem.Text != "None")
        {
            if ((ddlthirdlvl.SelectedItem.Text != "None") &&
                (ddlthirdlvl.SelectedItem.Text == ddlfourlvl.SelectedItem.Text ||
                ddlthirdlvl.SelectedItem.Text == ddlfifthlvl.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different levels');", true);
               // lblMsg.Text = "Two levels can NOT be same. Please select different levels";
               // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (ddlfourlvl.SelectedItem.Text != "None")
        {
            if ((ddlfourlvl.SelectedItem.Text != "None") &&
                   (ddlfourlvl.SelectedItem.Text == ddlfifthlvl.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different levels');", true);
              //  lblMsg.Text = "Two levels can NOT be same. Please select different levels";
             //   lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        
        if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked) && (!chkboxBuyrate.Checked) && (!chkboxNlc.Checked) && (!chkboxRate.Checked) && (!chkboxStock.Checked) && (!chkboxVat.Checked) && (!chkboxAll.Checked)&&(ddlfirstlvl.SelectedItem.Text == "None")&&(ddlsecondlvl.SelectedItem.Text == "None")&&(ddlthirdlvl.SelectedItem.Text == "None")&&(ddlfourlvl.SelectedItem.Text == "None")&&(ddlfifthlvl.SelectedItem.Text == "None"))
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select atleast one field');", true);
           // lblMsg.Text = "Atleast one field should be selected in checkboxes";
          //  lblMsg.ForeColor = System.Drawing.Color.Red;
            return false;
        }
        if (odlfirstlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if ((odlfirstlvl.SelectedItem.Text != ddlfirstlvl.SelectedItem.Text) && (odlfirstlvl.SelectedItem.Text != ddlsecondlvl.SelectedItem.Text) && (odlfirstlvl.SelectedItem.Text != ddlthirdlvl.SelectedItem.Text) && (odlfirstlvl.SelectedItem.Text != ddlfourlvl.SelectedItem.Text) && (odlfirstlvl.SelectedItem.Text != ddlfifthlvl.SelectedItem.Text))
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                    //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                    // lblMsg.ForeColor = System.Drawing.Color.Red;
                    return false;
                }
            }
        }
        if (odlsecondlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if ((odlsecondlvl.SelectedItem.Text != ddlfirstlvl.SelectedItem.Text) && (odlsecondlvl.SelectedItem.Text != ddlsecondlvl.SelectedItem.Text) && (odlsecondlvl.SelectedItem.Text != ddlthirdlvl.SelectedItem.Text) && (odlsecondlvl.SelectedItem.Text != ddlfourlvl.SelectedItem.Text) && (odlsecondlvl.SelectedItem.Text != ddlfifthlvl.SelectedItem.Text))
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                    //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                    // lblMsg.ForeColor = System.Drawing.Color.Red;
                    return false;
                }
            }
        }
        if (odlthirdlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if ((odlthirdlvl.SelectedItem.Text != ddlfirstlvl.SelectedItem.Text) && (odlthirdlvl.SelectedItem.Text != ddlsecondlvl.SelectedItem.Text) && (odlthirdlvl.SelectedItem.Text != ddlthirdlvl.SelectedItem.Text) && (odlthirdlvl.SelectedItem.Text != ddlfourlvl.SelectedItem.Text) && (odlthirdlvl.SelectedItem.Text != ddlfifthlvl.SelectedItem.Text))
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                    //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                    // lblMsg.ForeColor = System.Drawing.Color.Red;
                    return false;
                }
            }
        }
        if (odlfourlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if ((odlfourlvl.SelectedItem.Text != ddlfirstlvl.SelectedItem.Text) && (odlfourlvl.SelectedItem.Text != ddlsecondlvl.SelectedItem.Text) && (odlfourlvl.SelectedItem.Text != ddlthirdlvl.SelectedItem.Text) && (odlfourlvl.SelectedItem.Text != ddlfourlvl.SelectedItem.Text) && (odlfourlvl.SelectedItem.Text != ddlfifthlvl.SelectedItem.Text))
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                    //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                    // lblMsg.ForeColor = System.Drawing.Color.Red;
                    return false;
                }
            }
        }
        if (odlfifthlvl.SelectedItem.Text != "None")
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if ((odlfifthlvl.SelectedItem.Text != ddlfirstlvl.SelectedItem.Text) && (odlfifthlvl.SelectedItem.Text != ddlsecondlvl.SelectedItem.Text) && (odlfifthlvl.SelectedItem.Text != ddlthirdlvl.SelectedItem.Text) && (odlfifthlvl.SelectedItem.Text != ddlfourlvl.SelectedItem.Text) && (odlfifthlvl.SelectedItem.Text != ddlfifthlvl.SelectedItem.Text))
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                    //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                    // lblMsg.ForeColor = System.Drawing.Color.Red;
                    return false;
                }
            }
        }
        if (odlfirstlvl.SelectedItem.Text != "None")
        {
            if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (odlsecondlvl.SelectedItem.Text != "None")
        {
            if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked))
            //if ((odlsecondlvl.SelectedItem.Text != chkboxCategory.Text) && (odlsecondlvl.SelectedItem.Text != chkboxBrand.Text) && (odlsecondlvl.SelectedItem.Text != chkboxProduct.Text) && (odlsecondlvl.SelectedItem.Text != chkboxModel.Text) && (odlsecondlvl.SelectedItem.Text != chkboxItemCode.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (odlthirdlvl.SelectedItem.Text != "None")
        {
            if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked))
          //  if ((odlthirdlvl.SelectedItem.Text != chkboxCategory.Text) && (odlthirdlvl.SelectedItem.Text != chkboxBrand.Text) && (odlthirdlvl.SelectedItem.Text != chkboxProduct.Text) && (odlthirdlvl.SelectedItem.Text != chkboxModel.Text) && (odlthirdlvl.SelectedItem.Text != chkboxItemCode.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (odlfourlvl.SelectedItem.Text != "None")
        {
            if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked))
            //if ((odlfourlvl.SelectedItem.Text != chkboxCategory.Text) && (odlfourlvl.SelectedItem.Text != chkboxBrand.Text) && (odlfourlvl.SelectedItem.Text != chkboxProduct.Text) && (odlfourlvl.SelectedItem.Text != chkboxModel.Text) && (odlfourlvl.SelectedItem.Text != chkboxItemCode.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        if (odlfifthlvl.SelectedItem.Text != "None")
        {
            if ((!chkboxBrand.Checked) && (!chkboxCategory.Checked) && (!chkboxModel.Checked) && (!chkboxProduct.Checked) && (!chkboxItemCode.Checked))
            //if ((odlfifthlvl.SelectedItem.Text != chkboxCategory.Text) && (odlfifthlvl.SelectedItem.Text != chkboxBrand.Text) && (odlfifthlvl.SelectedItem.Text != chkboxProduct.Text) && (odlfifthlvl.SelectedItem.Text != chkboxModel.Text) && (odlfifthlvl.SelectedItem.Text != chkboxItemCode.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display orderby ');", true);
                //lblMsg.Text = "Atleast one field should be selected in checkboxes";
                // lblMsg.ForeColor = System.Drawing.Color.Red;
                return false;
            }
        }
        field2=getfield2();

        if (field2 == "")
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select any one on aggregate funtions like:Qty,VAT,NLC,Rate,Buyrate');", true);
            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
            // lblMsg.ForeColor = System.Drawing.Color.Red;
            return false;
        }

        



        if (DdlFirstSub.SelectedItem.Text != "None")
        {
            if ((DdlFirstSub.SelectedItem.Text != "None") &&
                (DdlFirstSub.SelectedItem.Text == DdlSecondSub.SelectedItem.Text ||
                DdlFirstSub.SelectedItem.Text == DdlThirdSub.SelectedItem.Text ||
                DdlFirstSub.SelectedItem.Text == DdlFourSub.SelectedItem.Text ||
                DdlFirstSub.SelectedItem.Text == DdlFiveSub.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different');", true);
                return false;
            }
        }
        if (DdlSecondSub.SelectedItem.Text != "None")
        {
            if ((DdlSecondSub.SelectedItem.Text != "None") &&
                (DdlSecondSub.SelectedItem.Text == DdlThirdSub.SelectedItem.Text ||
                DdlSecondSub.SelectedItem.Text == DdlFourSub.SelectedItem.Text ||
                DdlSecondSub.SelectedItem.Text == DdlFiveSub.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different');", true);
                return false;
            }
        }
        if (DdlThirdSub.SelectedItem.Text != "None")
        {
            if ((DdlThirdSub.SelectedItem.Text != "None") &&
                (DdlThirdSub.SelectedItem.Text == DdlFourSub.SelectedItem.Text ||
                DdlThirdSub.SelectedItem.Text == DdlFiveSub.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different');", true);
                return false;
            }
        }
        if (DdlFourSub.SelectedItem.Text != "None")
        {
            if ((DdlFourSub.SelectedItem.Text != "None") &&
                   (DdlFourSub.SelectedItem.Text == DdlFiveSub.SelectedItem.Text))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Two levels can NOT be same. Please select different');", true);
                return false;
            }
        }





        //if (chkboxAll.Checked == false)
        //{
        //    if (DdlFirstSub.SelectedItem.Text != "None")
        //    {
        //        string CBrand = "";
        //        string CModel = "";
        //        string CProduct = "";
        //        string CItemCode = "";
        //        string CCategory = "";
        //        if (chkboxBrand.Checked == true)
        //        {
        //            CBrand = chkboxBrand.Text;
        //        }
        //        if (chkboxModel.Checked == true)
        //        {
        //            CModel = chkboxModel.Text;
        //        }
        //        if (chkboxProduct.Checked == true)
        //        {
        //            CProduct = chkboxProduct.Text;
        //        }
        //        if (chkboxItemCode.Checked == true)
        //        {
        //            CItemCode = chkboxItemCode.Text;
        //        }
        //        if (chkboxCategory.Checked == true)
        //        {
        //            CCategory = chkboxCategory.Text;
        //        }

        //        if ((DdlFirstSub.SelectedItem.Text == CBrand) || (DdlFirstSub.SelectedItem.Text == CCategory) || (DdlFirstSub.SelectedItem.Text == CModel) || (DdlFirstSub.SelectedItem.Text == CProduct) || (DdlFirstSub.SelectedItem.Text == CItemCode))
        //        {
        //        }
        //        else
        //        {
        //            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //            // lblMsg.ForeColor = System.Drawing.Color.Red;
        //            return false;
        //        }
        //    }
        //    if (DdlSecondSub.SelectedItem.Text != "None")
        //    {
        //        string CBrand = "";
        //        string CModel = "";
        //        string CProduct = "";
        //        string CItemCode = "";
        //        string CCategory = "";
        //        if (chkboxBrand.Checked == true)
        //        {
        //            CBrand = chkboxBrand.Text;
        //        }
        //        if (chkboxModel.Checked == true)
        //        {
        //            CModel = chkboxModel.Text;
        //        }
        //        if (chkboxProduct.Checked == true)
        //        {
        //            CProduct = chkboxProduct.Text;
        //        }
        //        if (chkboxItemCode.Checked == true)
        //        {
        //            CItemCode = chkboxItemCode.Text;
        //        }
        //        if (chkboxCategory.Checked == true)
        //        {
        //            CCategory = chkboxCategory.Text;
        //        }

        //        if ((DdlSecondSub.SelectedItem.Text == CBrand) || (DdlSecondSub.SelectedItem.Text == CCategory) || (DdlSecondSub.SelectedItem.Text == CModel) || (DdlSecondSub.SelectedItem.Text == CProduct) || (DdlSecondSub.SelectedItem.Text == CItemCode))
        //        {
        //        }
        //        else
        //        {
        //            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //            // lblMsg.ForeColor = System.Drawing.Color.Red;
        //            return false;
        //        }
        //    }
        //    if (DdlThirdSub.SelectedItem.Text != "None")
        //    {
        //        string CBrand = "";
        //        string CModel = "";
        //        string CProduct = "";
        //        string CItemCode = "";
        //        string CCategory = "";
        //        if (chkboxBrand.Checked == true)
        //        {
        //            CBrand = chkboxBrand.Text;
        //        }
        //        if (chkboxModel.Checked == true)
        //        {
        //            CModel = chkboxModel.Text;
        //        }
        //        if (chkboxProduct.Checked == true)
        //        {
        //            CProduct = chkboxProduct.Text;
        //        }
        //        if (chkboxItemCode.Checked == true)
        //        {
        //            CItemCode = chkboxItemCode.Text;
        //        }
        //        if (chkboxCategory.Checked == true)
        //        {
        //            CCategory = chkboxCategory.Text;
        //        }

        //        if ((DdlThirdSub.SelectedItem.Text == CBrand) || (DdlThirdSub.SelectedItem.Text == CCategory) || (DdlThirdSub.SelectedItem.Text == CModel) || (DdlThirdSub.SelectedItem.Text == CProduct) || (DdlThirdSub.SelectedItem.Text == CItemCode))
        //        {
        //        }
        //        else
        //        {
        //            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //            // lblMsg.ForeColor = System.Drawing.Color.Red;
        //            return false;
        //        }
        //    }
        //    if (DdlFourSub.SelectedItem.Text != "None")
        //    {
        //        string CBrand = "";
        //        string CModel = "";
        //        string CProduct = "";
        //        string CItemCode = "";
        //        string CCategory = "";
        //        if (chkboxBrand.Checked == true)
        //        {
        //            CBrand = chkboxBrand.Text;
        //        }
        //        if (chkboxModel.Checked == true)
        //        {
        //            CModel = chkboxModel.Text;
        //        }
        //        if (chkboxProduct.Checked == true)
        //        {
        //            CProduct = chkboxProduct.Text;
        //        }
        //        if (chkboxItemCode.Checked == true)
        //        {
        //            CItemCode = chkboxItemCode.Text;
        //        }
        //        if (chkboxCategory.Checked == true)
        //        {
        //            CCategory = chkboxCategory.Text;
        //        }

        //        if ((DdlFourSub.SelectedItem.Text == CBrand) || (DdlFourSub.SelectedItem.Text == CCategory) || (DdlFourSub.SelectedItem.Text == CModel) || (DdlFourSub.SelectedItem.Text == CProduct) || (DdlFourSub.SelectedItem.Text == CItemCode))
        //        {
        //        }
        //        else
        //        {
        //            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //            // lblMsg.ForeColor = System.Drawing.Color.Red;
        //            return false;
        //        }
        //    }
        //    if (DdlFiveSub.SelectedItem.Text != "None")
        //    {
        //        string CBrand = "";
        //        string CModel = "";
        //        string CProduct = "";
        //        string CItemCode = "";
        //        string CCategory = "";
        //        if (chkboxBrand.Checked == true)
        //        {
        //            CBrand = chkboxBrand.Text;
        //        }
        //        if (chkboxModel.Checked == true)
        //        {
        //            CModel = chkboxModel.Text;
        //        }
        //        if (chkboxProduct.Checked == true)
        //        {
        //            CProduct = chkboxProduct.Text;
        //        }
        //        if (chkboxItemCode.Checked == true)
        //        {
        //            CItemCode = chkboxItemCode.Text;
        //        }
        //        if (chkboxCategory.Checked == true)
        //        {
        //            CCategory = chkboxCategory.Text;
        //        }

        //        if ((DdlFiveSub.SelectedItem.Text == CBrand) || (DdlFiveSub.SelectedItem.Text == CCategory) || (DdlFiveSub.SelectedItem.Text == CModel) || (DdlFiveSub.SelectedItem.Text == CProduct) || (DdlFiveSub.SelectedItem.Text == CItemCode))
        //        {
        //        }
        //        else
        //        {
        //            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //            //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //            // lblMsg.ForeColor = System.Drawing.Color.Red;
        //            return false;
        //        }
        //    }






        //    //if (chkboxBrand.Checked==true)
        //    //{
        //    //    string CBrand = "";
        //    //    string CModel = "";
        //    //    string CProduct = "";
        //    //    string CItemCode = "";
        //    //    string CCategory = "";

        //    //    if (DdlFirstSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CBrand = DdlFirstSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlSecondSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CModel = DdlSecondSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlThirdSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CProduct = DdlThirdSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlFourSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CItemCode = DdlFourSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlFiveSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CCategory = DdlFiveSub.SelectedItem.Text;
        //    //    }

        //    //    if ((chkboxBrand.Text == CBrand) || (chkboxCategory.Text == CCategory) || (chkboxModel.Text == CModel) || (chkboxProduct.Text == CProduct) || (chkboxItemCode.Text == CItemCode))
        //    //    {
        //    //    }
        //    //    else
        //    //    {
        //    //        ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //    //        //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //    //        // lblMsg.ForeColor = System.Drawing.Color.Red;
        //    //        return false;
        //    //    }
        //    //}


        //    //if (chkboxModel.Checked == true)
        //    //{
        //    //    string CBrand = "";
        //    //    string CModel = "";
        //    //    string CProduct = "";
        //    //    string CItemCode = "";
        //    //    string CCategory = "";

        //    //    if (DdlFirstSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CBrand = DdlFirstSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlSecondSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CModel = DdlSecondSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlThirdSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CProduct = DdlThirdSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlFourSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CItemCode = DdlFourSub.SelectedItem.Text;
        //    //    }
        //    //    if (DdlFiveSub.SelectedItem.Text != "None")
        //    //    {
        //    //        CCategory = DdlFiveSub.SelectedItem.Text;
        //    //    }

        //    //    if ((chkboxBrand.Text == CBrand) || (chkboxCategory.Text == CCategory) || (chkboxModel.Text == CModel) || (chkboxProduct.Text == CProduct) || (chkboxItemCode.Text == CItemCode))
        //    //    {
        //    //    }
        //    //    else
        //    //    {
        //    //        ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select particular field to display SubTotal ');", true);
        //    //        //lblMsg.Text = "Atleast one field should be selected in checkboxes";
        //    //        // lblMsg.ForeColor = System.Drawing.Color.Red;
        //    //        return false;
        //    //    }
        //    //}




        //}



        return true;
    }

     protected void btnxls_Click(object sender, EventArgs e)
   {

        try
        {
            if (!isValidLevels())
            {
                return;
            }

            string field1 = "";
            string field2 = "";
            getGrpByAndSelCols();
            field1 = getfield();
            field2 = getfield2();
            string cond = "";
            cond = getCond();
            //string grpBy = "";
            //string selCols = "";

            //selCols = getGrpByAndSelCols();
            ordrby = "";
            ordrby = odrby();

            //string subTot = "";
            //subTot = SubTotby();

            DateTime refDate = DateTime.Parse(txtStartDate.Text);
            if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
            {
                Subordrby = "";
                Subordrby = Subodrby();
                if (!isValidLevelsFF())
                {
                    return;
                }
                BindDataSubTot(sDataSource, refDate, selCols, field2, cond, grpBy, Subordrby);
            }
            else
            {
                bindData(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
            }

        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
            return;
        }
    
        
      
    }

     public void bindData(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
     {
         //if (ddlfourlvl.SelectedItem.Text != "None")
      
         bool dispLastTotal = false;
         DataSet ds = new DataSet();
         ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
         //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
         DataTable dt = new DataTable();
         if (ds.Tables[0].Rows.Count > 0)
         {
             if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
             {
                 if (ddlfirstlvl.SelectedItem.Text != "None")
                 {
                     dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                 }
                 if (ddlsecondlvl.SelectedItem.Text != "None")
                 {
                     dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                 }
                 if (ddlthirdlvl.SelectedItem.Text != "None")
                 {
                     dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                 }
                 if (ddlfourlvl.SelectedItem.Text != "None")
                 {
                     dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                 }
                 if (ddlfifthlvl.SelectedItem.Text != "None")
                 {
                     dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                 }
                 if (chkboxStock.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Quantity"));
                 }
                 if (chkboxVat.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("VAT"));
                 }
                 if (chkboxNlc.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("NLC"));
                 }
                 if (chkboxRate.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Rate"));
                 }
                 if (chkboxBuyrate.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("BuyRate"));
                 }
             }
             else if ((chkboxCategory.Checked == true) || (chkboxBrand.Checked == true) || (chkboxProduct.Checked == true) || (chkboxModel.Checked == true) || (chkboxItemCode.Checked == true) || (chkboxStock.Checked == true) || (chkboxNlc.Checked == true) || (chkboxRate.Checked == true) || (chkboxVat.Checked == true) || (chkboxBuyrate.Checked == true))
             {
                 if (chkboxCategory.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("CategoryName"));
                 }
                 if (chkboxBrand.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Brand"));
                 }
                 if (chkboxProduct.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("ProductName"));
                 }
                 if (chkboxModel.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Model"));
                 }
                 if (chkboxItemCode.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("ItemCode"));
                 }

                 if (chkboxStock.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Quantity"));
                 }
                 if (chkboxVat.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("VAT"));
                 }
                 if (chkboxNlc.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("NLC"));
                 }
                 if (chkboxRate.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("Rate"));
                 }
                 if (chkboxBuyrate.Checked == true)
                 {
                     dt.Columns.Add(new DataColumn("BuyRate"));
                 }

             }
             /* if (selLevels.IndexOf("Brand") < 0)
                  dt.Columns.Add(new DataColumn("Brand"));
              if (selLevels.IndexOf("CategoryName") < 0)
                  dt.Columns.Add(new DataColumn("CategoryName"));
              if (selLevels.IndexOf("ItemCode") < 0)
                  dt.Columns.Add(new DataColumn("ItemCode"));
              if (selLevels.IndexOf("Model") < 0)
                  dt.Columns.Add(new DataColumn("Model"));
              if (selLevels.IndexOf("ProductName") < 0)
                  dt.Columns.Add(new DataColumn("ProductName"));*/


             dt.Columns.Add(new DataColumn("SalesValue"));

             //initialize column values for entire row
             string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
             string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";

             

             int i = 1;

             foreach (DataRow dr in ds.Tables[0].Rows)
             {

                 if (i==1)
                 {
                    ///New Empty Row
                    
                     DataRow dr_final9 = dt.NewRow();
                     dt.Rows.Add(dr_final9);
                 }

                 i = i + 1;

                 if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                 {
                     //initialize column values for entire row
                     if (ddlfirstlvl.SelectedItem.Text != "None")
                     {
                         if (ddlfirstlvl.SelectedItem.Text == "Brand")
                         {
                             fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                         }
                         else
                         {
                             fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                         }
                     }
                     if (ddlsecondlvl.SelectedItem.Text != "None")
                     {
                         if (ddlsecondlvl.SelectedItem.Text == "Brand")
                         {
                             sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                         }
                         else
                         {
                             sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                         }
                     }

                     if (ddlthirdlvl.SelectedItem.Text != "None")
                     {
                         if (ddlthirdlvl.SelectedItem.Text == "Brand")
                         {
                             tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                         }
                         else
                         {
                             tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                         }
                     }
                     if (ddlfourlvl.SelectedItem.Text != "None")
                     {
                         if (ddlfourlvl.SelectedItem.Text == "Brand")
                         {
                             frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                         }
                         else
                         {
                             frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                         }
                     }
                     if (ddlfifthlvl.SelectedItem.Text != "None")
                     {
                         if (ddlfifthlvl.SelectedItem.Text == "Brand")
                         {
                             fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                         }
                         else
                         {
                             fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                         }
                     }
                     //dispLastTotal = true;
                     //if (ddlfifthlvl.SelectedItem.Text != "None")
                     //{
                     //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                     //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                     //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                     //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                     //       (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                     //    {
                     //        DataRow dr_final17 = dt.NewRow();
                     //        if (ddlfirstlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlsecondlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlthirdlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfourlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                     //        }

                     //        if (ddlfifthlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                     //        }
                     //        //dr_final7["Brand"] = "";
                     //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                     //        //dr_final7["CategoryName"] = "";
                     //        //dr_final7["Model"] = "";
                     //        //dr_final7["ProductName"] = "";

                     //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                     //        /*  if (selLevels.IndexOf("Brand") < 0)
                     //              dr_final17["Brand"] = "";
                     //          if (selLevels.IndexOf("CategoryName") < 0)
                     //              dr_final17["CategoryName"] = "";
                     //          if (selLevels.IndexOf("ItemCode") < 0)
                     //              dr_final17["ItemCode"] = "";
                     //          if (selLevels.IndexOf("Model") < 0)
                     //              dr_final17["Model"] = "";
                     //          if (selLevels.IndexOf("ProductName") < 0)
                     //              dr_final17["ProductName"] = "";*/

                     //        /* dr_final17["Rate"] = "";
                     //         dr_final17["NLC"] = "";
                     //         dr_final17["BuyRate"] = "";
                     //         dr_final17["VAT"] = "";
                     //         dr_final17["Quantity"] = "";*/

                     //        if (chkboxStock.Checked == true)
                     //        {
                     //            dr_final17["Quantity"] = "";
                     //        }
                     //        if (chkboxVat.Checked == true)
                     //        {
                     //            dr_final17["VAT"] = "";
                     //        }
                     //        if (chkboxNlc.Checked == true)
                     //        {
                     //            dr_final17["NLC"] = "";
                     //        }
                     //        if (chkboxRate.Checked == true)
                     //        {
                     //            dr_final17["Rate"] = "";

                     //        }
                     //        if (chkboxBuyrate.Checked == true)
                     //        {
                     //            dr_final17["BuyRate"] = "";
                     //        }
                     //        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                     //        dt.Rows.Add(dr_final17);
                     //        Ittls = 0;
                     //    }
                     //}


                     //if (ddlfourlvl.SelectedItem.Text != "None")
                     //{
                     //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                     //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                     //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                     //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                     //    {
                     //        DataRow dr_final7 = dt.NewRow();
                     //        if (ddlfirstlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlsecondlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlthirdlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfourlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                     //        }
                     //        //dr_final7["Brand"] = "";
                     //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                     //        //dr_final7["CategoryName"] = "";
                     //        //dr_final7["Model"] = "";
                     //        //dr_final7["ProductName"] = "";

                     //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                     //        /* if (selLevels.IndexOf("Brand") < 0)
                     //             dr_final7["Brand"] = "";
                     //         if (selLevels.IndexOf("CategoryName") < 0)
                     //             dr_final7["CategoryName"] = "";
                     //         if (selLevels.IndexOf("ItemCode") < 0)
                     //             dr_final7["ItemCode"] = "";
                     //         if (selLevels.IndexOf("Model") < 0)
                     //             dr_final7["Model"] = "";
                     //         if (selLevels.IndexOf("ProductName") < 0)
                     //             dr_final7["ProductName"] = "";*/

                     //        /*dr_final7["Rate"] = "";
                     //        dr_final7["NLC"] = "";
                     //        dr_final7["BuyRate"] = "";
                     //        dr_final7["VAT"] = "";
                     //        dr_final7["Quantity"] = */

                     //        if (chkboxStock.Checked == true)
                     //        {
                     //            dr_final7["Quantity"] = "";
                     //        }
                     //        if (chkboxVat.Checked == true)
                     //        {
                     //            dr_final7["VAT"] = "";
                     //        }
                     //        if (chkboxNlc.Checked == true)
                     //        {
                     //            dr_final7["NLC"] = "";
                     //        }
                     //        if (chkboxRate.Checked == true)
                     //        {
                     //            dr_final7["Rate"] = "";

                     //        }
                     //        if (chkboxBuyrate.Checked == true)
                     //        {
                     //            dr_final7["BuyRate"] = "";
                     //        }
                     //        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                     //        dt.Rows.Add(dr_final7);
                     //        Pttls = 0;
                     //    }
                     //}

                     //if (ddlthirdlvl.SelectedItem.Text != "None")
                     //{
                     //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                     //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                     //        (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                     //    {
                     //        DataRow dr_final8 = dt.NewRow();
                     //        if (ddlfirstlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlsecondlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlthirdlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                     //        }
                     //        if (ddlfourlvl.SelectedItem.Text != "None")
                     //        {
                     //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfifthlvl.SelectedItem.Text != "None")
                     //        {
                     //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                     //        }
                     //        /*  if (selLevels.IndexOf("Brand") < 0)
                     //              dr_final8["Brand"] = "";
                     //          if (selLevels.IndexOf("CategoryName") < 0)
                     //              dr_final8["CategoryName"] = "";
                     //          if (selLevels.IndexOf("ItemCode") < 0)
                     //              dr_final8["ItemCode"] = "";
                     //          if (selLevels.IndexOf("Model") < 0)
                     //              dr_final8["Model"] = "";
                     //          if (selLevels.IndexOf("ProductName") < 0)
                     //              dr_final8["ProductName"] = "";*/

                     //        /* dr_final8["Rate"] = "";
                     //         dr_final8["NLC"] = "";
                     //         dr_final8["BuyRate"] = "";
                     //         dr_final8["VAT"] = "";
                     //         dr_final8["Quantity"] = "";*/

                     //        if (chkboxStock.Checked == true)
                     //        {
                     //            dr_final8["Quantity"] = "";
                     //        }
                     //        if (chkboxVat.Checked == true)
                     //        {
                     //            dr_final8["VAT"] = "";
                     //        }
                     //        if (chkboxNlc.Checked == true)
                     //        {
                     //            dr_final8["NLC"] = "";
                     //        }
                     //        if (chkboxRate.Checked == true)
                     //        {
                     //            dr_final8["Rate"] = "";

                     //        }
                     //        if (chkboxBuyrate.Checked == true)
                     //        {
                     //            dr_final8["BuyRate"] = "";
                     //        }
                     //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                     //        dt.Rows.Add(dr_final8);
                     //        //dt.Rows.Add(dr_final8);
                     //        modelTotal = 0;
                     //    }
                     //}

                     //if (ddlsecondlvl.SelectedItem.Text != "None")
                     //{
                     //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                     //        (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                     //    {
                     //        DataRow dr_final8 = dt.NewRow();
                     //        if (ddlfirstlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlsecondlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                     //        }
                     //        if (ddlthirdlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfourlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfifthlvl.SelectedItem.Text != "None")
                     //        {
                     //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                     //        }
                     //        /*if (selLevels.IndexOf("Brand") < 0)
                     //            dr_final8["Brand"] = "";
                     //        if (selLevels.IndexOf("CategoryName") < 0)
                     //            dr_final8["CategoryName"] = "";
                     //        if (selLevels.IndexOf("ItemCode") < 0)
                     //            dr_final8["ItemCode"] = "";
                     //        if (selLevels.IndexOf("Model") < 0)
                     //            dr_final8["Model"] = "";
                     //        if (selLevels.IndexOf("ProductName") < 0)
                     //            dr_final8["ProductName"] = "";*/
                     //        /* dr_final8["Rate"] = "";
                     //         dr_final8["NLC"] = "";
                     //         dr_final8["BuyRate"] = "";
                     //         dr_final8["VAT"] = "";

                     //         dr_final8["Quantity"] = "";*/
                     //        if (chkboxStock.Checked == true)
                     //        {
                     //            dr_final8["Quantity"] = "";
                     //        }
                     //        if (chkboxVat.Checked == true)
                     //        {
                     //            dr_final8["VAT"] = "";
                     //        }
                     //        if (chkboxNlc.Checked == true)
                     //        {
                     //            dr_final8["NLC"] = "";
                     //        }
                     //        if (chkboxRate.Checked == true)
                     //        {
                     //            dr_final8["Rate"] = "";

                     //        }
                     //        if (chkboxBuyrate.Checked == true)
                     //        {
                     //            dr_final8["BuyRate"] = "";
                     //        }

                     //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                     //        dt.Rows.Add(dr_final8);
                     //        catIDTotal = 0;
                     //    }
                     //}

                     //if (ddlfirstlvl.SelectedItem.Text != "None")
                     //{
                     //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                     //    {
                     //        DataRow dr_final8 = dt.NewRow();
                     //        if (ddlfirstlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                     //        }
                     //        if (ddlsecondlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlthirdlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfourlvl.SelectedItem.Text != "None")
                     //        {
                     //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                     //        }
                     //        if (ddlfifthlvl.SelectedItem.Text != "None")
                     //        {
                     //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                     //        }
                     //        /* if (selLevels.IndexOf("Brand") < 0)
                     //             dr_final8["Brand"] = "";
                     //         if (selLevels.IndexOf("CategoryName") < 0)
                     //             dr_final8["CategoryName"] = "";
                     //         if (selLevels.IndexOf("ItemCode") < 0)
                     //             dr_final8["ItemCode"] = "";
                     //         if (selLevels.IndexOf("Model") < 0)
                     //             dr_final8["Model"] = "";
                     //         if (selLevels.IndexOf("ProductName") < 0)
                     //             dr_final8["ProductName"] = "";*/

                     //        /* dr_final8["Rate"] = "";
                     //         dr_final8["NLC"] = "";
                     //         dr_final8["BuyRate"] = "";
                     //         dr_final8["VAT"] = "";
                     //         dr_final8["Quantity"] = "";*/

                     //        if (chkboxStock.Checked == true)
                     //        {
                     //            dr_final8["Quantity"] = "";
                     //        }
                     //        if (chkboxVat.Checked == true)
                     //        {
                     //            dr_final8["VAT"] = "";
                     //        }
                     //        if (chkboxNlc.Checked == true)
                     //        {
                     //            dr_final8["NLC"] = "";
                     //        }
                     //        if (chkboxRate.Checked == true)
                     //        {
                     //            dr_final8["Rate"] = "";

                     //        }
                     //        if (chkboxBuyrate.Checked == true)
                     //        {
                     //            dr_final8["BuyRate"] = "";
                     //        }


                     //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                     //        dt.Rows.Add(dr_final8);
                     //        brandTotal = 0;

                             


                     //    }
                     //}

                     //if (ddlfirstlvl.SelectedItem.Text != "None")
                     //{
                     //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                     //    {
                     //        ///New Empty Row


                     //        DataRow dr_final9 = dt.NewRow();
                             
                     //        dt.Rows.Add(dr_final9);
                     //    }
                     // }





                     //---------Old

                     /////First Level Of Group By 

                     ////////////if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////{
                     ////////////    if ((ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                     ////////////    {
                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                     ////////////            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                     ////////////            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                     ////////////            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                     ////////////        {
                     ////////////        }
                     ////////////        else
                     ////////////        {
                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = "";
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = "";
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = "";
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = "";
                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = "";
                     ////////////            }
                     ////////////            dr_final1["SalesValue"] = "";
                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }
                     ////////////    else
                     ////////////    {
                     ////////////        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                     ////////////        {
                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            /*if (selLevels.IndexOf("Brand") < 0)
                     ////////////                dr_final1["Brand"] = "";
                     ////////////            if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                dr_final1["CategoryName"] = "";
                     ////////////            if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                dr_final1["ItemCode"] = "";
                     ////////////            if (selLevels.IndexOf("Model") < 0)
                     ////////////                dr_final1["Model"] = "";
                     ////////////            if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                dr_final1["ProductName"] = "";*/
                     ////////////            /*dr_final1["Rate"] = "";
                     ////////////            dr_final1["NLC"] = "";
                     ////////////            dr_final1["BuyRate"] = "";
                     ////////////            dr_final1["VAT"] = "";

                     ////////////            dr_final1["Quantity"] = "";*/


                     ////////////            ////Replace

                     ////////////            //if (chkboxStock.Checked == true)
                     ////////////            //{
                     ////////////            //    dr_final1["Quantity"] = "";
                     ////////////            //}
                     ////////////            //if (chkboxVat.Checked == true)
                     ////////////            //{
                     ////////////            //    dr_final1["VAT"] = "";
                     ////////////            //}
                     ////////////            //if (chkboxNlc.Checked == true)
                     ////////////            //{
                     ////////////            //    dr_final1["NLC"] = "";
                     ////////////            //}
                     ////////////            //if (chkboxRate.Checked == true)
                     ////////////            //{
                     ////////////            //    dr_final1["Rate"] = "";

                     ////////////            //}
                     ////////////            //if (chkboxBuyrate.Checked == true)
                     ////////////            //{
                     ////////////            //    dr_final1["BuyRate"] = "";
                     ////////////            //}
                     ////////////            //dr_final1["SalesValue"] = "";


                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = dr["Stock"];
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = dr["VAT"];
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = dr["NLC"];
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = dr["Rate"];

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = dr["BuyRate"];
                     ////////////            }

                     ////////////            dr_final1["SalesValue"] = dr["SalesValue"];

                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }
                     ////////////}



                     /////////////////Second Level of Group By

                     ////////////if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////{

                     ////////////    if ((ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                     ////////////    {
                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                     ////////////            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                     ////////////            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                     ////////////        {
                     ////////////        }
                     ////////////        else
                     ////////////        {
                     ////////////            DataRow dr_final2 = dt.NewRow();
                     ////////////            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                     ////////////            {
                     ////////////                if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////                }
                     ////////////            }
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            /*  if (selLevels.IndexOf("Brand") < 0)
                     ////////////                  dr_final2["Brand"] = "";
                     ////////////              if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                  dr_final2["CategoryName"] = "";
                     ////////////              if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                  dr_final2["ItemCode"] = "";
                     ////////////              if (selLevels.IndexOf("Model") < 0)
                     ////////////                  dr_final2["Model"] = "";
                     ////////////              if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                  dr_final2["ProductName"] = "";*/
                     ////////////            /* dr_final2["Rate"] = "";
                     ////////////             dr_final2["NLC"] = "";
                     ////////////             dr_final2["BuyRate"] = "";
                     ////////////             dr_final2["VAT"] = "";

                     ////////////             dr_final2["Quantity"] = ""*/

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["Quantity"] = "";
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["VAT"] = "";
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["NLC"] = "";
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["Rate"] = "";

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["BuyRate"] = "";
                     ////////////            }

                     ////////////            dr_final2["SalesValue"] = "";

                     ////////////            dt.Rows.Add(dr_final2);
                     ////////////        }
                     ////////////    }
                     ////////////    else
                     ////////////    {

                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                     ////////////        {
                     ////////////            DataRow dr_final2 = dt.NewRow();
                     ////////////            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                     ////////////            {
                     ////////////                if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////                }
                     ////////////            }
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            /*  if (selLevels.IndexOf("Brand") < 0)
                     ////////////                  dr_final2["Brand"] = "";
                     ////////////              if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                  dr_final2["CategoryName"] = "";
                     ////////////              if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                  dr_final2["ItemCode"] = "";
                     ////////////              if (selLevels.IndexOf("Model") < 0)
                     ////////////                  dr_final2["Model"] = "";
                     ////////////              if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                  dr_final2["ProductName"] = "";*/
                     ////////////            /* dr_final2["Rate"] = "";
                     ////////////             dr_final2["NLC"] = "";
                     ////////////             dr_final2["BuyRate"] = "";
                     ////////////             dr_final2["VAT"] = "";

                     ////////////             dr_final2["Quantity"] = ""*/

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["Quantity"] = dr["Stock"];
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["VAT"] = dr["VAT"];
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["NLC"] = dr["NLC"];
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["Rate"] = dr["Rate"];

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final2["BuyRate"] = dr["BuyRate"];
                     ////////////            }

                     ////////////            dr_final2["SalesValue"] = dr["SalesValue"];
                     ////////////            dt.Rows.Add(dr_final2);
                     ////////////        }
                     ////////////    }
                     ////////////}


                     /////////////////// Third Level of GroupBy

                     ////////////if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////{
                     ////////////    if ((ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                     ////////////    {
                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                     ////////////            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                     ////////////            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                     ////////////        {
                     ////////////        }
                     ////////////        else
                     ////////////        {

                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                     ////////////            {
                     ////////////                if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////                }
                     ////////////            }
                     ////////////            //else
                     ////////////            //{
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            /*if (selLevels.IndexOf("Brand") < 0)
                     ////////////                dr_final1["Brand"] = "";
                     ////////////            if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                dr_final1["CategoryName"] = "";
                     ////////////            if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                dr_final1["ItemCode"] = "";
                     ////////////            if (selLevels.IndexOf("Model") < 0)
                     ////////////                dr_final1["Model"] = "";
                     ////////////            if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                dr_final1["ProductName"] = "";*/

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = "";
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = "";
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = "";
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = "";

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = "";
                     ////////////            }

                     ////////////            dr_final1["SalesValue"] = "";




                     ////////////            /*dr_final1["Rate"] = "";
                     ////////////            dr_final1["NLC"] = "";
                     ////////////            dr_final1["BuyRate"] = "";
                     ////////////            dr_final1["VAT"] = "";

                     ////////////            dr_final1["Quantity"] = "";
                     ////////////            dr_final1["Rate"] = "";
                     ////////////            dr_final1["NLC"] = "";
                     ////////////            dr_final1["BuyRate"] = "";
                     ////////////            dr_final1["VAT"] = "";*/


                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }
                     ////////////    else
                     ////////////    {

                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                     ////////////            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                     ////////////        {
                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                     ////////////            {
                     ////////////                if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////                }
                     ////////////            }
                     ////////////            //else
                     ////////////            //{
                     ////////////            if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////            }
                     ////////////            if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////            {
                     ////////////                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////            }
                     ////////////            /*if (selLevels.IndexOf("Brand") < 0)
                     ////////////                dr_final1["Brand"] = "";
                     ////////////            if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                dr_final1["CategoryName"] = "";
                     ////////////            if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                dr_final1["ItemCode"] = "";
                     ////////////            if (selLevels.IndexOf("Model") < 0)
                     ////////////                dr_final1["Model"] = "";
                     ////////////            if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                dr_final1["ProductName"] = "";*/

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = dr["Stock"];
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = dr["VAT"];
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = dr["NLC"];
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = dr["Rate"];

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = dr["BuyRate"];
                     ////////////            }

                     ////////////            dr_final1["SalesValue"] = dr["SalesValue"];




                     ////////////            /*dr_final1["Rate"] = "";
                     ////////////            dr_final1["NLC"] = "";
                     ////////////            dr_final1["BuyRate"] = "";
                     ////////////            dr_final1["VAT"] = "";

                     ////////////            dr_final1["Quantity"] = "";
                     ////////////            dr_final1["Rate"] = "";
                     ////////////            dr_final1["NLC"] = "";
                     ////////////            dr_final1["BuyRate"] = "";
                     ////////////            dr_final1["VAT"] = "";*/


                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }
                     ////////////}


                     /////////////////Fourth Level of Groupby

                     ////////////if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////{
                     ////////////    if ((ddlfifthlvl.SelectedItem.Text != "None"))
                     ////////////    {
                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                     ////////////        {
                     ////////////        }
                     ////////////        else
                     ////////////        {
                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                     ////////////            {
                     ////////////                if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                     ////////////                }
                     ////////////                //else
                     ////////////                //{
                     ////////////                    if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                     ////////////                    }
                     ////////////                    if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                     ////////////                    }
                     ////////////                    if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                     ////////////                    }
                     ////////////                    if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////                    }
                     ////////////                //}
                     ////////////            }

                     ////////////            /*  if (selLevels.IndexOf("Brand") < 0)
                     ////////////                  dr_final1["Brand"] = "";
                     ////////////              if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                  dr_final1["CategoryName"] = "";
                     ////////////              if (selLevels.IndexOf("ItemCode") < 0)

                     ////////////                  dr_final1["ItemCode"] = "";
                     ////////////              if (selLevels.IndexOf("Model") < 0)
                     ////////////                  dr_final1["Model"] = "";
                     ////////////              if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                  dr_final1["ProductName"] = "";*/
                     ////////////            /* dr_final1["Rate"] = "";
                     ////////////             dr_final1["NLC"] = "";
                     ////////////             dr_final1["BuyRate"] = "";
                     ////////////             dr_final1["VAT"] = "";
                     ////////////             dr_final1["Quantity"] = "";*/


                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = "";
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = "";
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = "";
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = "";

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = "";
                     ////////////            }

                     ////////////            dr_final1["SalesValue"] = "";

                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }

                     ////////////    else
                     ////////////    {
                     ////////////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                     ////////////            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                     ////////////            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                     ////////////            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                     ////////////        {
                     ////////////            DataRow dr_final1 = dt.NewRow();
                     ////////////            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                     ////////////            {
                     ////////////                if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                     ////////////                }
                     ////////////                //else
                     ////////////                //{
                     ////////////                    if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                     ////////////                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                     ////////////                    }
                     ////////////                //}
                     ////////////            }

                     ////////////            /*  if (selLevels.IndexOf("Brand") < 0)
                     ////////////                  dr_final1["Brand"] = "";
                     ////////////              if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                  dr_final1["CategoryName"] = "";
                     ////////////              if (selLevels.IndexOf("ItemCode") < 0)

                     ////////////                  dr_final1["ItemCode"] = "";
                     ////////////              if (selLevels.IndexOf("Model") < 0)
                     ////////////                  dr_final1["Model"] = "";
                     ////////////              if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                  dr_final1["ProductName"] = "";*/
                     ////////////            /* dr_final1["Rate"] = "";
                     ////////////             dr_final1["NLC"] = "";
                     ////////////             dr_final1["BuyRate"] = "";
                     ////////////             dr_final1["VAT"] = "";
                     ////////////             dr_final1["Quantity"] = "";*/


                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Quantity"] = dr["Stock"];
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["VAT"] = dr["VAT"];
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["NLC"] = dr["NLC"];
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["Rate"] = dr["Rate"];

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final1["BuyRate"] = dr["BuyRate"];
                     ////////////            }

                     ////////////            dr_final1["SalesValue"] = dr["SalesValue"];



                     ////////////            dt.Rows.Add(dr_final1);
                     ////////////        }
                     ////////////    }
                     ////////////}





                     /////////////////Fifth Level of GroupBy



                     ////////////if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////{

                     ////////////    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                     ////////////        {
                     ////////////            DataRow dr_final111 = dt.NewRow();
                     ////////////            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                     ////////////            {
                     ////////////                if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////                {
                     ////////////                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                     ////////////                }
                     ////////////                //else
                     ////////////                //{
                     ////////////                    if (ddlfirstlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlsecondlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlthirdlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                     ////////////                    }
                     ////////////                    if (ddlfourlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                     ////////////                    }

                     ////////////                    if (ddlfifthlvl.SelectedItem.Text != "None")
                     ////////////                    {
                     ////////////                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                     ////////////                    }

                     ////////////                //}
                     ////////////            }

                     ////////////            /*  if (selLevels.IndexOf("Brand") < 0)
                     ////////////                  dr_final111["Brand"] = "";
                     ////////////              if (selLevels.IndexOf("CategoryName") < 0)
                     ////////////                  dr_final111["CategoryName"] = "";
                     ////////////              if (selLevels.IndexOf("ItemCode") < 0)
                     ////////////                  dr_final111["ItemCode"] = "";
                     ////////////              if (selLevels.IndexOf("Model") < 0)
                     ////////////                  dr_final111["Model"] = "";
                     ////////////              if (selLevels.IndexOf("ProductName") < 0)
                     ////////////                  dr_final111["ProductName"] = "";*/

                     ////////////            /*dr_final111["Rate"] = "";
                     ////////////            dr_final111["NLC"] = "";
                     ////////////            dr_final111["BuyRate"] = "";
                     ////////////            dr_final111["VAT"] = "";
                     ////////////            dr_final111["Quantity"] = "";*/

                     ////////////            if (chkboxStock.Checked == true)
                     ////////////            {
                     ////////////                dr_final111["Quantity"] = dr["Stock"];
                     ////////////            }
                     ////////////            if (chkboxVat.Checked == true)
                     ////////////            {
                     ////////////                dr_final111["VAT"] = dr["VAT"];
                     ////////////            }
                     ////////////            if (chkboxNlc.Checked == true)
                     ////////////            {
                     ////////////                dr_final111["NLC"] = dr["NLC"];
                     ////////////            }
                     ////////////            if (chkboxRate.Checked == true)
                     ////////////            {
                     ////////////                dr_final111["Rate"] = dr["Rate"];

                     ////////////            }
                     ////////////            if (chkboxBuyrate.Checked == true)
                     ////////////            {
                     ////////////                dr_final111["BuyRate"] = dr["BuyRate"];
                     ////////////            }

                     ////////////            dr_final111["SalesValue"] = dr["SalesValue"];
                     ////////////            dt.Rows.Add(dr_final111);
                             
                     ////////////    }
                     ////////////}





                     if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                     {
                         if (ddlfifthlvl.SelectedItem.Text != "None")
                         {
                                DataRow dr_final111 = dt.NewRow();
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final111["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final111["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final111["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final111["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final111["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final111["SalesValue"] = dr["SalesValue"];

                                dt.Rows.Add(dr_final111);
                         }

                         else
                             if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                 if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                 (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                 (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                                 {
                                     DataRow dr_final1 = dt.NewRow();
                                     //if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                                     //{
                                         if (ddlfourlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                         }
                                         if (ddlfirstlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                         }
                                         if (ddlsecondlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                         }
                                         if (ddlthirdlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                         }
                                         if (ddlfourlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                         }
                                         if (ddlfifthlvl.SelectedItem.Text != "None")
                                         {
                                             dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                         }
                                     //}

                                     if (chkboxStock.Checked == true)
                                     {
                                         dr_final1["Quantity"] = dr["Stock"];
                                     }
                                     if (chkboxVat.Checked == true)
                                     {
                                         dr_final1["VAT"] = dr["VAT"];
                                     }
                                     if (chkboxNlc.Checked == true)
                                     {
                                         dr_final1["NLC"] = dr["NLC"];
                                     }
                                     if (chkboxRate.Checked == true)
                                     {
                                         dr_final1["Rate"] = dr["Rate"];

                                     }
                                     if (chkboxBuyrate.Checked == true)
                                     {
                                         dr_final1["BuyRate"] = dr["BuyRate"];
                                     }

                                     dr_final1["SalesValue"] = dr["SalesValue"];



                                     dt.Rows.Add(dr_final1);
                                 }
                         }

                        else
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                 (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                                {
                                    DataRow dr_final1 = dt.NewRow();
                                    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                    {
                                        if (ddlthirdlvl.SelectedItem.Text != "None")
                                        {
                                            dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                        }
                                    }
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    
                                    if (chkboxStock.Checked == true)
                                    {
                                        dr_final1["Quantity"] = dr["Stock"];
                                    }
                                    if (chkboxVat.Checked == true)
                                    {
                                        dr_final1["VAT"] = dr["VAT"];
                                    }
                                    if (chkboxNlc.Checked == true)
                                    {
                                        dr_final1["NLC"] = dr["NLC"];
                                    }
                                    if (chkboxRate.Checked == true)
                                    {
                                        dr_final1["Rate"] = dr["Rate"];

                                    }
                                    if (chkboxBuyrate.Checked == true)
                                    {
                                        dr_final1["BuyRate"] = dr["BuyRate"];
                                    }

                                    dr_final1["SalesValue"] = dr["SalesValue"];

                                    dt.Rows.Add(dr_final1);
                                }
                            }

                        else
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                {
                                    DataRow dr_final2 = dt.NewRow();
                                    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                    (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                    {
                                        if (ddlsecondlvl.SelectedItem.Text != "None")
                                        {
                                            dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                        }
                                    }
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    
                                    if (chkboxStock.Checked == true)
                                    {
                                        dr_final2["Quantity"] = dr["Stock"];
                                    }
                                    if (chkboxVat.Checked == true)
                                    {
                                        dr_final2["VAT"] = dr["VAT"];
                                    }
                                    if (chkboxNlc.Checked == true)
                                    {
                                        dr_final2["NLC"] = dr["NLC"];
                                    }
                                    if (chkboxRate.Checked == true)
                                    {
                                        dr_final2["Rate"] = dr["Rate"];

                                    }
                                    if (chkboxBuyrate.Checked == true)
                                    {
                                        dr_final2["BuyRate"] = dr["BuyRate"];
                                    }

                                    dr_final2["SalesValue"] = dr["SalesValue"];
                                    dt.Rows.Add(dr_final2);
                                }
                            }

                        else
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                {
                                    DataRow dr_final1 = dt.NewRow();
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    if (chkboxStock.Checked == true)
                                    {
                                        dr_final1["Quantity"] = dr["Stock"];
                                    }
                                    if (chkboxVat.Checked == true)
                                    {
                                        dr_final1["VAT"] = dr["VAT"];
                                    }
                                    if (chkboxNlc.Checked == true)
                                    {
                                        dr_final1["NLC"] = dr["NLC"];
                                    }
                                    if (chkboxRate.Checked == true)
                                    {
                                        dr_final1["Rate"] = dr["Rate"];

                                    }
                                    if (chkboxBuyrate.Checked == true)
                                    {
                                        dr_final1["BuyRate"] = dr["BuyRate"];
                                    }

                                    dr_final1["SalesValue"] = dr["SalesValue"];

                                    dt.Rows.Add(dr_final1);
                                }
                            }

                     }


                     fLvlValue = fLvlValueTemp;
                     sLvlValue = sLvlValueTemp;
                     tLvlValue = tLvlValueTemp;
                     frthLvlValue = frthLvlValueTemp;
                     fifLvlValue = fifthLvlValueTemp;

                     DataRow dr_final5 = dt.NewRow();
                     if (ddlfirstlvl.SelectedItem.Text != "None")
                     {

                         if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                         {
                             dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                         }
                         if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                         {
                             dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                         }
                         if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                         {
                             dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                         }
                         if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                         {
                             dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                         }
                         if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                         {
                             dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                         }
                     }

                     if (ddlsecondlvl.SelectedItem.Text != "None")
                     {
                         if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                         {
                             dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                         }
                         if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                         {
                             dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                         }
                         if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                         {
                             dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                         }
                         if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                         {
                             dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                         }
                         if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                         {
                             dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                         }

                     }
                     if (ddlthirdlvl.SelectedItem.Text != "None")
                     {
                         if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                         {
                             dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                         }
                         if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                         {
                             dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                         }
                         if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                         {
                             dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                         }
                         if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                         {
                             dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                         }
                         if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                         {
                             dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                         }


                     }
                     if (ddlfourlvl.SelectedItem.Text != "None")
                     {
                         if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                         {
                             dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                         }
                         if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                         {
                             dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                         }
                         if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                         {
                             dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                         }
                         if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                         {
                             dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                         }
                         if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                         {
                             dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                         }


                     }
                     if (ddlfifthlvl.SelectedItem.Text != "None")
                     {
                         if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                         {
                             dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                         }
                         if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                         {
                             dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                         }
                         if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                         {
                             dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                         }
                         if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                         {
                             dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                         }
                         if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                         {
                             dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                         }
                     }
                     /* dr_final5["Rate"] = dr["Rate"];
                      dr_final5["NLC"] = dr["NLC"];
                      dr_final5["BuyRate"] = dr["BuyRate"];
                      dr_final5["VAT"] = dr["VAT"];
                      dr_final5["Quantity"] = dr["Stock"];*/

                     


                     //////Taken



                     //dt.Rows.Add(dr_final5);
                     Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                     if (chkboxStock.Checked == true)
                     {
                         Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                     }
                     modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                     catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                     Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                     brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                     Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                     dispLastTotal = true;
                 }


                 else
                 {
                     if (chkboxCategory.Checked == true)
                     {
                         fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();

                     }

                     if (chkboxBrand.Checked == true)
                     {
                         sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                     }
                     if (chkboxProduct.Checked == true)
                     {
                         tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                     }
                     if (chkboxModel.Checked == true)
                     {
                         frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                     }
                     if (chkboxItemCode.Checked == true)
                     {
                         fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                     }
                   
                     fLvlValue = fLvlValueTemp;
                     sLvlValue = sLvlValueTemp;
                     tLvlValue = tLvlValueTemp;
                     frthLvlValue = frthLvlValueTemp;
                     fifLvlValue = fifthLvlValueTemp;

                     DataRow dr_final5 = dt.NewRow();
                     if (chkboxCategory.Checked == true)
                     {
                         dr_final5["CategoryName"] = dr["CategoryName"];
                     }

                     if (chkboxBrand.Checked == true)
                     {
                         dr_final5["Brand"] = dr["ProductDesc"];
                     }
                     if (chkboxProduct.Checked == true)
                     {
                         dr_final5["ProductName"] = dr["ProductName"];
                     }
                     if (chkboxModel.Checked == true)
                     {
                         dr_final5["Model"] = dr["Model"];
                     }
                     if (chkboxItemCode.Checked == true)
                     {
                         dr_final5["ItemCode"] = dr["ItemCode"];
                     }
                     if (chkboxStock.Checked == true)
                     {
                         dr_final5["Quantity"] = dr["Stock"];
                     }
                     if (chkboxVat.Checked == true)
                     {
                         dr_final5["VAT"] = dr["VAT"];
                     }
                     if (chkboxNlc.Checked == true)
                     {
                         dr_final5["NLC"] = dr["NLC"];
                     }
                     if (chkboxRate.Checked == true)
                     {
                         dr_final5["Rate"] = dr["Rate"];

                     }
                     if (chkboxBuyrate.Checked == true)
                     {
                         dr_final5["BuyRate"] = dr["BuyRate"];
                     }
                     /* dr_final5["Rate"] = dr["Rate"];
                      dr_final5["NLC"] = dr["NLC"];
                      dr_final5["BuyRate"] = dr["BuyRate"];
                      dr_final5["VAT"] = dr["VAT"];
                      dr_final5["Quantity"] = dr["Stock"];*/


                     dr_final5["SalesValue"] = dr["SalesValue"];
                     dt.Rows.Add(dr_final5);
                     Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                     if (chkboxStock.Checked == true)
                     {
                         Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                     }
                     modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                     catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                     Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                     brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                     Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                     dispLastTotal = true;
                 }

                 /* if (selLevels.IndexOf("Brand") < 0)
                      dr_final5["Brand"] = dr["ProductDesc"];
                  if (selLevels.IndexOf("CategoryName") < 0)
                      dr_final5["CategoryName"] = dr["CategoryName"];
                  if (selLevels.IndexOf("ItemCode") < 0)
                      dr_final5["ItemCode"] = dr["ItemCode"];
                  if (selLevels.IndexOf("Model") < 0)
                      dr_final5["Model"] = dr["Model"];
                  if (selLevels.IndexOf("ProductName") < 0)
                      dr_final5["ProductName"] = dr["ProductName"];*/


             }

             //Display the last Total and Grand Total
             if (dispLastTotal)
             {
                 if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                 {

                     if (ddlfifthlvl.SelectedItem.Text != "None")
                     {
                         //DataRow dr_final17 = dt.NewRow();
                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfourlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                         //}


                         //dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                         ///* if (selLevels.IndexOf("Brand") < 0)
                         //     dr_final17["Brand"] = "";
                         // if (selLevels.IndexOf("CategoryName") < 0)
                         //     dr_final17["CategoryName"] = "";
                         // if (selLevels.IndexOf("ItemCode") < 0)
                         //     dr_final17["ItemCode"] = "";
                         // if (selLevels.IndexOf("Model") < 0)
                         //     dr_final17["Model"] = "";
                         // if (selLevels.IndexOf("ProductName") < 0)
                         //     dr_final17["ProductName"] = "";*/
                         ///*dr_final17["Rate"] = "";
                         //dr_final17["NLC"] = "";
                         //dr_final17["BuyRate"] = "";
                         //dr_final17["VAT"] = "";


                         //dr_final17["Quantity"] = "";*/
                         //if (chkboxStock.Checked == true)
                         //{
                         //    dr_final17["Quantity"] = "";
                         //}
                         //if (chkboxVat.Checked == true)
                         //{
                         //    dr_final17["VAT"] = "";
                         //}
                         //if (chkboxNlc.Checked == true)
                         //{
                         //    dr_final17["NLC"] = "";
                         //}
                         //if (chkboxRate.Checked == true)
                         //{
                         //    dr_final17["Rate"] = "";

                         //}
                         //if (chkboxBuyrate.Checked == true)
                         //{
                         //    dr_final17["BuyRate"] = "";
                         //}

                         //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                         //dt.Rows.Add(dr_final17);

                         //if (ddlfifthlvl.SelectedItem.Text != "None")
                         //{

                         //    ///New Empty Row


                         //    DataRow dr_final9 = dt.NewRow();

                         //    dt.Rows.Add(dr_final9);

                         //}

                         Ittls = 0;
                     }


                     if (ddlfourlvl.SelectedItem.Text != "None")
                     {
                         //DataRow dr_final7 = dt.NewRow();
                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfifthlvl.SelectedItem.Text != "None")
                         //{
                         //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                         //    dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                         //}

                         //dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                         ///*if (selLevels.IndexOf("Brand") < 0)
                         //    dr_final7["Brand"] = "";
                         //if (selLevels.IndexOf("CategoryName") < 0)
                         //    dr_final7["CategoryName"] = "";
                         //if (selLevels.IndexOf("ItemCode") < 0)
                         //    dr_final7["ItemCode"] = "";
                         //if (selLevels.IndexOf("Model") < 0)
                         //    dr_final7["Model"] = "";
                         //if (selLevels.IndexOf("ProductName") < 0)
                         //    dr_final7["ProductName"] = "";*/
                         ///*dr_final7["Rate"] = "";
                         //dr_final7["NLC"] = "";
                         //dr_final7["BuyRate"] = "";
                         //dr_final7["VAT"] = "";

                         //dr_final7["Quantity"] = "";*/

                         //if (chkboxStock.Checked == true)
                         //{
                         //    dr_final7["Quantity"] = "";
                         //}
                         //if (chkboxVat.Checked == true)
                         //{
                         //    dr_final7["VAT"] = "";
                         //}
                         //if (chkboxNlc.Checked == true)
                         //{
                         //    dr_final7["NLC"] = "";
                         //}
                         //if (chkboxRate.Checked == true)
                         //{
                         //    dr_final7["Rate"] = "";

                         //}
                         //if (chkboxBuyrate.Checked == true)
                         //{
                         //    dr_final7["BuyRate"] = "";
                         //}

                         //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                         //dt.Rows.Add(dr_final7);

                         Pttls = 0;

                         //if (ddlfourlvl.SelectedItem.Text != "None")
                         //{

                         //    ///New Empty Row


                         //    DataRow dr_final9 = dt.NewRow();

                         //    dt.Rows.Add(dr_final9);

                         //}

                     }

                     if (ddlthirdlvl.SelectedItem.Text != "None")
                     {
                         //DataRow dr_final8 = dt.NewRow();
                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                         //}
                         //if (ddlfourlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfifthlvl.SelectedItem.Text != "None")
                         //{
                         //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                         //    dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                         //}
                         ///* if (selLevels.IndexOf("Brand") < 0)
                         //     dr_final8["Brand"] = "";
                         // if (selLevels.IndexOf("CategoryName") < 0)
                         //     dr_final8["CategoryName"] = "";
                         // if (selLevels.IndexOf("ItemCode") < 0)
                         //     dr_final8["ItemCode"] = "";
                         // if (selLevels.IndexOf("Model") < 0)
                         //     dr_final8["Model"] = "";
                         // if (selLevels.IndexOf("ProductName") < 0)
                         //     dr_final8["ProductName"] = "";*/
                         ///* dr_final8["Rate"] = "";
                         // dr_final8["NLC"] = "";
                         // dr_final8["BuyRate"] = "";
                         // dr_final8["VAT"] = "";

                         // dr_final8["Quantity"] = "";*/

                         //if (chkboxStock.Checked == true)
                         //{
                         //    dr_final8["Quantity"] = "";
                         //}
                         //if (chkboxVat.Checked == true)
                         //{
                         //    dr_final8["VAT"] = "";
                         //}
                         //if (chkboxNlc.Checked == true)
                         //{
                         //    dr_final8["NLC"] = "";
                         //}
                         //if (chkboxRate.Checked == true)
                         //{
                         //    dr_final8["Rate"] = "";

                         //}
                         //if (chkboxBuyrate.Checked == true)
                         //{
                         //    dr_final8["BuyRate"] = "";
                         //}

                         //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                         //dt.Rows.Add(dr_final8);

                         modelTotal = 0;

                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    ///New Empty Row

                         //    DataRow dr_final9 = dt.NewRow();

                         //    dt.Rows.Add(dr_final9);

                         //}
                     }

                     if (ddlsecondlvl.SelectedItem.Text != "None")
                     {
                         //DataRow dr_final9 = dt.NewRow();
                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                         //}
                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfourlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfifthlvl.SelectedItem.Text != "None")
                         //{
                         //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                         //    dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                         //}
                         ///* if (selLevels.IndexOf("Brand") < 0)
                         //     dr_final9["Brand"] = "";
                         // if (selLevels.IndexOf("CategoryName") < 0)
                         //     dr_final9["CategoryName"] = "";
                         // if (selLevels.IndexOf("ItemCode") < 0)
                         //     dr_final9["ItemCode"] = "";
                         // if (selLevels.IndexOf("Model") < 0)
                         //     dr_final9["Model"] = "";
                         // if (selLevels.IndexOf("ProductName") < 0)
                         //     dr_final9["ProductName"] = "";*/
                         ///*["Rate"] = "";
                         //dr_final9["NLC"] = "";
                         //dr_final9["BuyRate"] = "";
                         //dr_final9["VAT"] = "";

                         //dr_final9["Quantity"] = "";*/

                         //if (chkboxStock.Checked == true)
                         //{
                         //    dr_final9["Quantity"] = "";
                         //}
                         //if (chkboxVat.Checked == true)
                         //{
                         //    dr_final9["VAT"] = "";
                         //}
                         //if (chkboxNlc.Checked == true)
                         //{
                         //    dr_final9["NLC"] = "";
                         //}
                         //if (chkboxRate.Checked == true)
                         //{
                         //    dr_final9["Rate"] = "";

                         //}
                         //if (chkboxBuyrate.Checked == true)
                         //{
                         //    dr_final9["BuyRate"] = "";
                         //}

                         //dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                         //dt.Rows.Add(dr_final9);

                         catIDTotal = 0;

                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{

                         //    ///New Empty Row


                         //    DataRow dr_final9 = dt.NewRow();

                         //    dt.Rows.Add(dr_final9);

                         //}

                     }

                     if (ddlfirstlvl.SelectedItem.Text != "None")
                     {
                         //DataRow dr_final10 = dt.NewRow();
                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                         //}
                         //if (ddlsecondlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlthirdlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfourlvl.SelectedItem.Text != "None")
                         //{
                         //    dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                         //}
                         //if (ddlfifthlvl.SelectedItem.Text != "None")
                         //{
                         //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                         //    dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                         //}

                         ///* if (selLevels.IndexOf("Brand") < 0)
                         //     dr_final10["Brand"] = "";
                         // if (selLevels.IndexOf("CategoryName") < 0)
                         //     dr_final10["CategoryName"] = "";
                         // if (selLevels.IndexOf("ItemCode") < 0)
                         //     dr_final10["ItemCode"] = "";
                         // if (selLevels.IndexOf("Model") < 0)
                         //     dr_final10["Model"] = "";
                         // if (selLevels.IndexOf("ProductName") < 0)
                         //     dr_final10["ProductName"] = "";*/

                         ///* dr_final10["Rate"] = "";
                         // dr_final10["NLC"] = "";
                         // dr_final10["BuyRate"] = "";
                         // dr_final10["VAT"] = "";

                         // dr_final10["Quantity"] = "";*/
                         //if (chkboxStock.Checked == true)
                         //{
                         //    dr_final10["Quantity"] = "";
                         //}
                         //if (chkboxVat.Checked == true)
                         //{
                         //    dr_final10["VAT"] = "";
                         //}
                         //if (chkboxNlc.Checked == true)
                         //{
                         //    dr_final10["NLC"] = "";
                         //}
                         //if (chkboxRate.Checked == true)
                         //{
                         //    dr_final10["Rate"] = "";

                         //}
                         //if (chkboxBuyrate.Checked == true)
                         //{
                         //    dr_final10["BuyRate"] = "";
                         //}

                         //dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                         //dt.Rows.Add(dr_final10);
                         //brandTotal = 0;


                         //if (ddlfirstlvl.SelectedItem.Text != "None")
                         //{
                             
                         //        ///New Empty Row


                         //        DataRow dr_final9 = dt.NewRow();

                         //        dt.Rows.Add(dr_final9);
                             
                         //}

                     }
                     
                         
                     ///New Empty Row

                    DataRow dr_final9 = dt.NewRow();

                    dt.Rows.Add(dr_final9);



                     DataRow dr_final6 = dt.NewRow();

                     if (ddlfirstlvl.SelectedItem.Text != "None")
                     {
                         if (ddlfirstlvl.SelectedItem.Text != "None")
                         {
                             dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                         }
                         if (ddlsecondlvl.SelectedItem.Text != "None")
                         {
                             dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                             dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                         }
                         if (ddlthirdlvl.SelectedItem.Text != "None")
                         {
                             dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                             dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                             dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                         }
                         if (ddlfourlvl.SelectedItem.Text != "None")
                         {
                             dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                             dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                             dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                             dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                         }
                         if (ddlfifthlvl.SelectedItem.Text != "None")
                         {
                             dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                             dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                             dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                             dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                             dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                         }
                     }
                         
                     //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                     //}
                     //if (ddlsecondlvl.SelectedItem.Text != "None")
                     //{
                     //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                     //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                         
                     //}
                     //if (ddlthirdlvl.SelectedItem.Text != "None")
                     //{
                     //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                     //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                     //}
                     //if (ddlfourlvl.SelectedItem.Text != "None")
                     //{
                     //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                     //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                     //}
                     //if (ddlfifthlvl.SelectedItem.Text != "None")
                     //{
                     //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                     //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                     //}

                     /* if (selLevels.IndexOf("Brand") < 0)
                          dr_final6["Brand"] = "";
                      if (selLevels.IndexOf("CategoryName") < 0)
                          dr_final6["CategoryName"] = "";
                      if (selLevels.IndexOf("ItemCode") < 0)
                          dr_final6["ItemCode"] = "Grand Total: ";
                      if (selLevels.IndexOf("Model") < 0)
                          dr_final6["Model"] = "";
                      if (selLevels.IndexOf("ProductName") < 0)
                          dr_final6["ProductName"] = "";*/

                     /*dr_final6["Rate"] = "";
                     dr_final6["NLC"] = "";
                     dr_final6["BuyRate"] = "";
                     dr_final6["VAT"] = "";
                     dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                     if (chkboxStock.Checked == true)
                     {
                         dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                     }
                     if (chkboxVat.Checked == true)
                     {
                         dr_final6["VAT"] = "";
                     }
                     if (chkboxNlc.Checked == true)
                     {
                         dr_final6["NLC"] = "";
                     }
                     if (chkboxRate.Checked == true)
                     {
                         dr_final6["Rate"] = "";

                     }
                     if (chkboxBuyrate.Checked == true)
                     {
                         dr_final6["BuyRate"] = "";
                     }

                     dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                     dt.Rows.Add(dr_final6);
                 }
                 else if ((chkboxCategory.Checked==true) || (chkboxBrand.Checked==true) || (chkboxProduct.Checked==true) || (chkboxModel.Checked==true) || (chkboxItemCode.Checked==true))
                 {
                     //if (chkboxItemCode.Checked == true)
                     //{
                     //    DataRow dr_final17 = dt.NewRow();
                     //    if (chkboxCategory.Checked == true)
                     //    {
                     //        dr_final17["CategoryName"] = "";
                     //    }
                     //    if (chkboxBrand.Checked == true)
                     //    {
                     //        dr_final17["Brand"] = "";
                     //    }
                     //    if (chkboxProduct.Checked == true)
                     //    {
                     //        dr_final17["ProductName"] = "";
                     //    }
                     //    if (chkboxModel.Checked == true)
                     //    {
                     //        dr_final17["Model"] = "";
                     //    }

                     //    /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                     //    dr_final17["Rate"] = "";
                     //    dr_final17["NLC"] = "";
                     //    dr_final17["BuyRate"] = "";
                     //    dr_final17["VAT"] = "";
                        

                     //    dr_final17["Quantity"] = "";*/
                     //    if (chkboxStock.Checked == true)
                     //    {
                     //        dr_final17["Quantity"] = "";
                     //    }
                     //    if (chkboxVat.Checked == true)
                     //    {
                     //        dr_final17["VAT"] = "";
                     //    }
                     //    if (chkboxNlc.Checked == true)
                     //    {
                     //        dr_final17["NLC"] = "";
                     //    }
                     //    if (chkboxRate.Checked == true)
                     //    {
                     //        dr_final17["Rate"] = "";

                     //    }
                     //    if (chkboxBuyrate.Checked == true)
                     //    {
                     //        dr_final17["BuyRate"] = "";
                     //    }
                     //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                     //    dt.Rows.Add(dr_final17);
                     //    Ittls = 0;
                     //}
                     //if (chkboxModel.Checked == true)
                     //{
                     //    DataRow dr_final7 = dt.NewRow();
                     //    if (chkboxCategory.Checked == true)
                     //    {
                     //        dr_final7["CategoryName"] = "";
                     //    }
                     //    if (chkboxBrand.Checked == true)
                     //    {
                     //        dr_final7["Brand"] = "";
                     //    }
                     //    if (chkboxProduct.Checked == true)
                     //    {
                     //        dr_final7["ProductName"] = "";
                     //    }
                     //    if (chkboxItemCode.Checked == true)
                     //    {
                     //        dr_final7["ItemCode"] = "";
                     //    }

                     //    dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                     //    /*if (selLevels.IndexOf("Brand") < 0)
                     //        dr_final7["Brand"] = "";
                     //    if (selLevels.IndexOf("CategoryName") < 0)
                     //        dr_final7["CategoryName"] = "";
                     //    if (selLevels.IndexOf("ItemCode") < 0)
                     //        dr_final7["ItemCode"] = "";
                     //    if (selLevels.IndexOf("Model") < 0)
                     //        dr_final7["Model"] = "";
                     //    if (selLevels.IndexOf("ProductName") < 0)
                     //        dr_final7["ProductName"] = "";*/
                     //    /*dr_final7["Rate"] = "";
                     //    dr_final7["NLC"] = "";
                     //    dr_final7["BuyRate"] = "";
                     //    dr_final7["VAT"] = "";

                     //    dr_final7["Quantity"] = "";*/
                     //    if (chkboxStock.Checked == true)
                     //    {
                     //        dr_final7["Quantity"] = "";
                     //    }
                     //    if (chkboxVat.Checked == true)
                     //    {
                     //        dr_final7["VAT"] = "";
                     //    }
                     //    if (chkboxNlc.Checked == true)
                     //    {
                     //        dr_final7["NLC"] = "";
                     //    }
                     //    if (chkboxRate.Checked == true)
                     //    {
                     //        dr_final7["Rate"] = "";

                     //    }
                     //    if (chkboxBuyrate.Checked == true)
                     //    {
                     //        dr_final7["BuyRate"] = "";
                     //    }

                     //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                     //    dt.Rows.Add(dr_final7);
                     //    Pttls = 0;
                     //}

                     //if (chkboxProduct.Checked == true)
                     //{
                     //    DataRow dr_final8 = dt.NewRow();
                     //    if (chkboxCategory.Checked == true)
                     //    {
                     //        dr_final8["CategoryName"] = "";
                     //    }
                     //    if (chkboxBrand.Checked == true)
                     //    {
                     //        dr_final8["Brand"] = "";
                     //    }
                     //    if (chkboxModel.Checked == true)
                     //    {
                     //        dr_final8["Model"] = "";
                     //    }
                     //    if (chkboxItemCode.Checked == true)
                     //    {
                     //        dr_final8["ItemCode"] = "";
                     //    }
                     //    dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                     //    /* if (selLevels.IndexOf("Brand") < 0)
                     //         dr_final8["Brand"] = "";
                     //     if (selLevels.IndexOf("CategoryName") < 0)
                     //         dr_final8["CategoryName"] = "";
                     //     if (selLevels.IndexOf("ItemCode") < 0)
                     //         dr_final8["ItemCode"] = "";
                     //     if (selLevels.IndexOf("Model") < 0)
                     //         dr_final8["Model"] = "";
                     //     if (selLevels.IndexOf("ProductName") < 0)
                     //         dr_final8["ProductName"] = "";*/
                     //    /* dr_final8["Rate"] = "";
                     //     dr_final8["NLC"] = "";
                     //     dr_final8["BuyRate"] = "";
                     //     dr_final8["VAT"] = "";

                     //     dr_final8["Quantity"] = "";*/

                     //    if (chkboxStock.Checked == true)
                     //    {
                     //        dr_final8["Quantity"] = "";
                     //    }
                     //    if (chkboxVat.Checked == true)
                     //    {
                     //        dr_final8["VAT"] = "";
                     //    }
                     //    if (chkboxNlc.Checked == true)
                     //    {
                     //        dr_final8["NLC"] = "";
                     //    }
                     //    if (chkboxRate.Checked == true)
                     //    {
                     //        dr_final8["Rate"] = "";

                     //    }
                     //    if (chkboxBuyrate.Checked == true)
                     //    {
                     //        dr_final8["BuyRate"] = "";
                     //    }
                     //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                     //    dt.Rows.Add(dr_final8);
                     //    modelTotal = 0;
                     //}

                     //if (chkboxBrand.Checked == true)
                     //{
                     //    DataRow dr_final9 = dt.NewRow();
                     //    if (chkboxCategory.Checked == true)
                     //    {
                     //        dr_final9["CategoryName"] = "";
                     //    }
                     //    if (chkboxProduct.Checked == true)
                     //    {
                     //        dr_final9["ProductName"] = "";
                     //    }
                     //    if (chkboxModel.Checked == true)
                     //    {
                     //        dr_final9["Model"] = "";
                     //    }
                     //    if (chkboxItemCode.Checked == true)
                     //    {
                     //        dr_final9["ItemCode"] = "";
                     //    }
                     //    dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                     //    /* if (selLevels.IndexOf("Brand") < 0)
                     //         dr_final9["Brand"] = "";
                     //     if (selLevels.IndexOf("CategoryName") < 0)
                     //         dr_final9["CategoryName"] = "";
                     //     if (selLevels.IndexOf("ItemCode") < 0)
                     //         dr_final9["ItemCode"] = "";
                     //     if (selLevels.IndexOf("Model") < 0)
                     //         dr_final9["Model"] = "";
                     //     if (selLevels.IndexOf("ProductName") < 0)
                     //         dr_final9["ProductName"] = "";*/
                     //    /*dr_final9["Rate"] = "";
                     //    dr_final9["NLC"] = "";
                     //    dr_final9["BuyRate"] = "";
                     //    dr_final9["VAT"] = "";

                     //    dr_final9["Quantity"] = "";*/

                     //    if (chkboxStock.Checked == true)
                     //    {
                     //        dr_final9["Quantity"] = "";
                     //    }
                     //    if (chkboxVat.Checked == true)
                     //    {
                     //        dr_final9["VAT"] = "";
                     //    }
                     //    if (chkboxNlc.Checked == true)
                     //    {
                     //        dr_final9["NLC"] = "";
                     //    }
                     //    if (chkboxRate.Checked == true)
                     //    {
                     //        dr_final9["Rate"] = "";

                     //    }
                     //    if (chkboxBuyrate.Checked == true)
                     //    {
                     //        dr_final9["BuyRate"] = "";
                     //    }
                     //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                     //    dt.Rows.Add(dr_final9);
                     //    catIDTotal = 0;
                     //}

                     //if (chkboxCategory.Checked == true)
                     //{
                     //    DataRow dr_final10 = dt.NewRow();
                     //    if (chkboxBrand.Checked == true)
                     //    {
                     //        dr_final10["CategoryName"] = "";
                     //    }
                     //    if (chkboxProduct.Checked == true)
                     //    {
                     //        dr_final10["ProductName"] = "";
                     //    }
                     //    if (chkboxModel.Checked == true)
                     //    {
                     //        dr_final10["Model"] = "";
                     //    }
                     //    if (chkboxItemCode.Checked == true)
                     //    {
                     //        dr_final10["ItemCode"] = "";
                     //    }
                     //    dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                     //    /* if (selLevels.IndexOf("Brand") < 0)
                     //         dr_final10["Brand"] = "";
                     //     if (selLevels.IndexOf("CategoryName") < 0)
                     //         dr_final10["CategoryName"] = "";
                     //     if (selLevels.IndexOf("ItemCode") < 0)
                     //         dr_final10["ItemCode"] = "";
                     //     if (selLevels.IndexOf("Model") < 0)
                     //         dr_final10["Model"] = "";
                     //     if (selLevels.IndexOf("ProductName") < 0)
                     //         dr_final10["ProductName"] = "";*/

                     //    /*dr_final10["Rate"] = "";
                     //    dr_final10["NLC"] = "";
                     //    dr_final10["BuyRate"] = "";
                     //    dr_final10["VAT"] = "";

                     //    dr_final10["Quantity"] = "";*/
                     //    if (chkboxStock.Checked == true)
                     //    {
                     //        dr_final10["Quantity"] = "";
                     //    }
                     //    if (chkboxVat.Checked == true)
                     //    {
                     //        dr_final10["VAT"] = "";
                     //    }
                     //    if (chkboxNlc.Checked == true)
                     //    {
                     //        dr_final10["NLC"] = "";
                     //    }
                     //    if (chkboxRate.Checked == true)
                     //    {
                     //        dr_final10["Rate"] = "";

                     //    }
                     //    if (chkboxBuyrate.Checked == true)
                     //    {
                     //        dr_final10["BuyRate"] = "";
                     //    }
                     //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                     //    dt.Rows.Add(dr_final10);
                     //    brandTotal = 0;
                     //}
                     DataRow dr5 = dt.NewRow();
                     dt.Rows.Add(dr5);
                     DataRow dr_final6 = dt.NewRow();
                     if (chkboxCategory.Checked == true)
                     {
                         dr_final6["CategoryName"] = "Grand Total: ";
                     }
                     if (chkboxBrand.Checked == true)
                     {
                         dr_final6["Brand"] = "";
                     }
                     if (chkboxProduct.Checked == true)
                     {
                         dr_final6["ProductName"] = "";
                     }
                     if (chkboxModel.Checked == true)
                     {
                         dr_final6["Model"] = "";
                     }
                     if (chkboxItemCode.Checked == true)
                     {
                         dr_final6["ItemCode"] = "";
                     }

                     /* if (selLevels.IndexOf("Brand") < 0)
                          dr_final6["Brand"] = "";
                      if (selLevels.IndexOf("CategoryName") < 0)
                          dr_final6["CategoryName"] = "";
                      if (selLevels.IndexOf("ItemCode") < 0)
                          dr_final6["ItemCode"] = "Grand Total: ";
                      if (selLevels.IndexOf("Model") < 0)
                          dr_final6["Model"] = "";
                      if (selLevels.IndexOf("ProductName") < 0)
                          dr_final6["ProductName"] = "";*/

                     /*dr_final6["Rate"] = "";
                     dr_final6["NLC"] = "";
                     dr_final6["BuyRate"] = "";
                     dr_final6["VAT"] = "";
                     dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                     if (chkboxStock.Checked == true)
                     {
                         dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                     }
                     if (chkboxVat.Checked == true)
                     {
                         dr_final6["VAT"] = "";
                     }
                     if (chkboxNlc.Checked == true)
                     {
                         dr_final6["NLC"] = "";
                     }
                     if (chkboxRate.Checked == true)
                     {
                         dr_final6["Rate"] = "";

                     }
                     if (chkboxBuyrate.Checked == true)
                     {
                         dr_final6["BuyRate"] = "";
                     }
                     dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                     dt.Rows.Add(dr_final6);
                 }

                 
                 
             }

             ExportToExcel(dt);
         }
         else
         {
             ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
         }
     }

     public void ExportToExcel(DataTable dt)
     {

         if (dt.Rows.Count > 0)
         {
             string filename = "Stock.xls";
             System.IO.StringWriter tw = new System.IO.StringWriter();
             System.Web.UI.HtmlTextWriter hw = new System.Web.UI.HtmlTextWriter(tw);
             DataGrid dgGrid = new DataGrid();
             dgGrid.DataSource = dt;
             dgGrid.DataBind();
             dgGrid.HeaderStyle.ForeColor = System.Drawing.Color.Black;
             dgGrid.HeaderStyle.BackColor = System.Drawing.Color.LightSkyBlue;
             dgGrid.HeaderStyle.BorderColor = System.Drawing.Color.RoyalBlue;
             dgGrid.HeaderStyle.Font.Bold = true;
             //Get the HTML for the control.
             dgGrid.RenderControl(hw);
             //Write the HTML back to the browser.
             Response.ContentType = "application/vnd.ms-excel";
             Response.AppendHeader("Content-Disposition", "attachment; filename=" + filename + "");
             this.EnableViewState = false;
             Response.Write(tw.ToString());
             Response.End();
         }
     }
    public override void VerifyRenderingInServerForm(Control control)
    {

    }

   
    decimal Total;


    protected void retrivebtn_Click(object sender, EventArgs e)
    {
        try
        {
            string cond = "";
            int i = 0;
            int j = 0;
            objBL.savenames = ddlretrive.SelectedItem.Text;
            string savedname = ddlretrive.SelectedItem.Text;
            DataSet ds1 = new DataSet();
            ds1 = objBL.getsaveddata(savedname);
            //DataGrid dsg = new Datagrid();
            GridView1.DataSource = ds1;
            //ddlBrand.DataTextField = "Brand";
            //ddlBrand.DataValueField = "Brand";
            GridView1.DataBind();
            GridView1.Visible = false;
            // GridView1.EnableViewState = true;
            DataTable dts = new DataTable();

            //if(DataRow dr[savedname] == "kanna")
            // {
            /*  if (ds1.Tables[0].Columns[1].ToString() == savedname)
               {
                   for (i = 1; i < ds1.Tables[2].Columns.Count; i++)
                   {


                       if (ds1.Tables[0].Columns[i].ToString() == "chkCategory")
                       {
                           chkboxCategory.Checked = true;
                           i++;
                       }

                       if (ds1.Tables[0].Columns[i].ToString() == "chkBrand")
                       {
                           chkboxBrand.Checked = true;
                           i++;
                       }
                       if (ds1.Tables[0].Columns[i].ToString() == "chkModel")
                       {
                           chkboxModel.Checked = true;
                           i++;
                       }
                       if (ds1.Tables[0].Columns[i].ToString() == "chkProduct")
                       {
                           chkboxProduct.Checked = true;
                           i++;
                       }

                   }

               }*/
            DataRow row;
            foreach (DataTable thisTable in ds1.Tables)
            {
                // For each row, print the values of each column.
                foreach (DataRow myRow in thisTable.Rows)
                {
                    //foreach(DataColumn myCol in thisTable.Columns)
                    //{
                    if (ds1.Tables[0].Rows[i][j].ToString() == savedname)
                    {
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkCategory")
                        {
                            chkboxCategory.Checked = true;

                        }

                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkBrand")
                        {
                            chkboxBrand.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkProduct")
                        {
                            chkboxProduct.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkModel")
                        {
                            chkboxModel.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkItemcode")
                        {
                            chkboxItemCode.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkstock")
                        {
                            chkboxStock.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkNlc")
                        {
                            chkboxNlc.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkVat")
                        {
                            chkboxVat.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkBuyRate")
                        {
                            chkboxBuyrate.Checked = true;

                        }
                        j++;
                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkRate")
                        {
                            chkboxRate.Checked = true;

                        }
                        j++;

                        if (ds1.Tables[0].Rows[i][j].ToString() == "chkAll")
                        {
                            chkboxAll.Checked = true;

                        }
                        j++;
                        string sdBrand = ds1.Tables[0].Rows[i][12].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdBrand)
                        {
                            ddlBrand.SelectedItem.Text = sdBrand;
                            if (sdBrand != "All")
                            {
                                cond += " and ProductDesc='" + ddlBrand.SelectedItem.Text + "' ";
                            }
                            j++;
                        }
                        string sdCat = ds1.Tables[0].Rows[i][13].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdCat)
                        {
                            ddlCategory.SelectedItem.Value = sdCat;
                            if (sdCat != "0")
                            {
                                cond += " and PM.CategoryID=" + Convert.ToInt32(ddlCategory.SelectedItem.Value) + " ";
                            }
                            j++;
                        }
                        string sdProd = ds1.Tables[0].Rows[i][14].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdProd)
                        {
                            ddlPrdctNme.SelectedItem.Text = sdProd;
                            if (sdProd != "All")
                            {
                                cond += " and ProductName='" + ddlPrdctNme.SelectedItem.Text + "' ";
                            }
                            j++;
                        }
                        string sdMod = ds1.Tables[0].Rows[i][15].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdMod)
                        {
                            ddlMdl.SelectedItem.Text = sdMod;
                            if (sdMod != "All")
                            {
                                cond += " and Model='" + ddlMdl.SelectedItem.Text + "' ";
                            }
                            j++;
                        }
                        string sditem = ds1.Tables[0].Rows[i][16].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sditem)
                        {
                            ddlItemCode.SelectedItem.Text = sditem;
                            if (sditem != "All")
                            {
                                cond += " and ItemCode= '" + ddlItemCode.SelectedItem.Text + "'";
                            }
                            j++;
                        }
                        string sdstoc = ds1.Tables[0].Rows[i][17].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdstoc)
                        {
                            ddlStock.SelectedItem.Text = sdstoc;
                            if (sdstoc != "All")
                            {
                                string txtstock1 = ds1.Tables[0].Rows[i][32].ToString();
                                //  if (ds1.Tables[0].Rows[i][j].ToString() == txtstock1)
                                {
                                    Stocktxtbox.Visible = true;
                                    Stocktxtbox.Text = txtstock1;

                                }
                                if (sdstoc == "=")
                                {
                                    objBL.StockValues = txtstock1;
                                    cond += " and Stock =" + txtstock1;
                                    if (txtstock1 == "")
                                    {
                                        Label27.Text = "Please enter a quantity";
                                    }
                                }

                                else if (sdstoc == ">")
                                {
                                    // buyratetxtbox.show();

                                    objBL.StockValues = txtstock1;
                                    cond += " and Stock >" + txtstock1;
                                    if (txtstock1 == "")
                                    {
                                        Label27.Text = "Please enter a quantity";
                                    }
                                }
                                else if (sdstoc == "<")
                                {
                                    //buyratetxtbox.show();
                                    objBL.StockValues = txtstock1;
                                    cond += " and Stock < " + txtstock1;
                                    if (txtstock1 == "")
                                    {
                                        Label27.Text = "Please enter a quantity";
                                    }

                                }

                            }
                            j++;
                        }
                        string sdVat = ds1.Tables[0].Rows[i][18].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdVat)
                        {
                            ddlVat.SelectedItem.Text = sdVat;
                            if (sdVat != "All")
                            {
                                Vattxtbox.EnableViewState = true;
                                string txtvat1 = ds1.Tables[0].Rows[i][33].ToString();
                                // if (ds1.Tables[0].Rows[i][j].ToString() == txtvat1)
                                {
                                    Vattxtbox.Visible = true;
                                    Vattxtbox.Text = txtvat1;
                                    j++;
                                }
                                if (sdVat == "=")
                                {
                                    objBL.Vats = txtvat1;
                                    cond += " and VAT =" + txtvat1;
                                    if (txtvat1 == "")
                                    {
                                        Label28.Text = "Please enter a vat";
                                    }
                                }
                                else if (sdVat == ">")
                                {
                                    //VATtxtbox.text.show();
                                    objBL.Vats = txtvat1;
                                    cond += " and VAT >" + txtvat1;
                                    if (txtvat1 == "")
                                    {
                                        Label28.Text = "Please enter a vat";
                                    }

                                }
                                else if (sdVat == "<")
                                {
                                    //VATtxtbox.text.show();
                                    objBL.Vats = txtvat1;
                                    cond += " and VAT <" + txtvat1;
                                    if (txtvat1 == "")
                                    {
                                        Label28.Text = "Please enter a vat";
                                    }
                                }
                            }
                            j++;
                        }
                        string sdNlc = ds1.Tables[0].Rows[i][19].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdNlc)
                        {
                            ddlNlc.SelectedItem.Text = sdNlc;
                            if (sdNlc != "All")
                            {
                                string txtnlc1 = ds1.Tables[0].Rows[i][36].ToString();
                                //if (ds1.Tables[0].Rows[i][j].ToString() == txtnlc1)
                                {
                                    Nlctxtbox.Visible = true;
                                    Nlctxtbox.Text = txtnlc1;

                                }
                                if (sdNlc == "=")
                                {
                                    objBL.Nlcs = txtnlc1;
                                    cond += " and NLC =" + txtnlc1;
                                    if (txtnlc1 == "")
                                    {
                                        Label29.Text = "Please enter a nlc";
                                    }
                                }
                                else if (sdNlc == ">")
                                {
                                    // NLCtxtbox.text.show();
                                    objBL.Nlcs = txtnlc1;
                                    cond += " and NLC >" + txtnlc1;
                                    if (txtnlc1 == "")
                                    {
                                        Label29.Text = "Please enter a nlc";
                                    }
                                }
                                else if (sdNlc == "<")
                                {
                                    //NLCtxtbox.text.show();
                                    objBL.Nlcs = txtnlc1;
                                    cond += " and NLC <" + txtnlc1;
                                    if (txtnlc1 == "")
                                    {
                                        Label29.Text = "Please enter a nlc";
                                    }
                                }
                            }
                            j++;
                        }
                        string sdBuyrate = ds1.Tables[0].Rows[i][20].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdBuyrate)
                        {
                            ddlBuyrate.SelectedItem.Text = sdBuyrate;
                            if (sdBuyrate != "All")
                            {
                                string txtbuyrate1 = ds1.Tables[0].Rows[i][34].ToString();
                                //if (ds1.Tables[0].Rows[i][j].ToString() == txtbuyrate1)
                                {
                                    buyratetxtbox.Visible = true;
                                    buyratetxtbox.Text = txtbuyrate1;

                                }
                                if (sdBuyrate == "=")
                                {
                                    objBL.Buyrates = txtbuyrate1;
                                    cond += " and BuyRate =" + txtbuyrate1;
                                    if (txtbuyrate1 == "")
                                    {
                                        Label30.Text = "Please enter a buyrate";
                                    }
                                }
                                else if (sdBuyrate == ">")
                                {
                                    //buyratetxtbox.text.show();
                                    objBL.Buyrates = txtbuyrate1;
                                    cond += " and BuyRate >" + txtbuyrate1;
                                    if (txtbuyrate1 == "")
                                    {
                                        Label30.Text = "Please enter a buyrate";
                                    }
                                }
                                else if (sdBuyrate == "<")
                                {
                                    objBL.Buyrates = txtbuyrate1;
                                    cond += " and BuyRate <" + txtbuyrate1;
                                    if (txtbuyrate1 == "")
                                    {
                                        Label30.Text = "Please enter a buyrate";
                                    }
                                }
                            }

                            j++;
                        }
                        string sdrate = ds1.Tables[0].Rows[i][21].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdrate)
                        {
                            ddlRate.SelectedItem.Text = sdrate;
                            if (sdrate != "All")
                            {
                                string txtrate1 = ds1.Tables[0].Rows[i][35].ToString();
                                // if (ds1.Tables[0].Rows[i][j].ToString() == txtrate1)
                                {
                                    Ratetxtbox.Visible = true;
                                    Ratetxtbox.Text = txtrate1;

                                }
                                if (sdrate == "=")
                                {
                                    objBL.Rated = txtrate1;
                                    cond += " and Rate =" + txtrate1;
                                    if (txtrate1 == "")
                                    {
                                        Label31.Text = "Please enter a rate";
                                    }
                                }
                                else if (sdrate == ">")
                                {
                                    //Ratetxtbox.text.show();
                                    objBL.Rated = txtrate1;
                                    cond += " and Rate > " + txtrate1;
                                    if (txtrate1 == "")
                                    {
                                        Label31.Text = "Please enter a rate";
                                    }
                                }
                                else if (sdrate == "<")
                                {
                                    //Ratetxtbox.text.show();
                                    objBL.Rated = txtrate1;
                                    cond += " and Rate <" + txtrate1;
                                    if (txtrate1 == "")
                                    {
                                        Label31.Text = "Please enter a rate";
                                    }
                                }
                            }
                            j++;
                        }
                        string sdfirstlvl = ds1.Tables[0].Rows[i][22].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdfirstlvl)
                        {
                            ddlfirstlvl.SelectedItem.Text = sdfirstlvl;
                            j++;
                        }
                        string sdsecondlvl = ds1.Tables[0].Rows[i][23].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdsecondlvl)
                        {
                            ddlsecondlvl.SelectedItem.Text = sdsecondlvl;
                            j++;
                        }
                        string sdthirdlvl = ds1.Tables[0].Rows[i][24].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdthirdlvl)
                        {
                            ddlthirdlvl.SelectedItem.Text = sdthirdlvl;
                            j++;
                        }
                        string sdfourlvl = ds1.Tables[0].Rows[i][25].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdfourlvl)
                        {
                            ddlfourlvl.SelectedItem.Text = sdfourlvl;
                            j++;
                        }
                        string sdfifthlvl = ds1.Tables[0].Rows[i][26].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sdfifthlvl)
                        {
                            ddlfifthlvl.SelectedItem.Text = sdfifthlvl;
                            j++;
                        }
                        string sodfirstlvl = ds1.Tables[0].Rows[i][27].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sodfirstlvl)
                        {
                            odlfirstlvl.SelectedItem.Text = sodfirstlvl;
                            j++;
                        }
                        string sodsecondlvl = ds1.Tables[0].Rows[i][28].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sodsecondlvl)
                        {
                            odlsecondlvl.SelectedItem.Text = sodsecondlvl;
                            j++;
                        }
                        string sodthirdlvl = ds1.Tables[0].Rows[i][29].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sodthirdlvl)
                        {
                            odlthirdlvl.SelectedItem.Text = sodthirdlvl;
                            j++;
                        }
                        string sodfourlvl = ds1.Tables[0].Rows[i][30].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sodfourlvl)
                        {
                            odlfourlvl.SelectedItem.Text = sodfourlvl;
                            j++;
                        }
                        string sodfifthlvl = ds1.Tables[0].Rows[i][31].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == sodfifthlvl)
                        {
                            odlfifthlvl.SelectedItem.Text = sodfifthlvl;
                            j++;

                        }


                        if (sdstoc != "All")
                        {
                        }
                        else
                        {
                            string txtstock1 = ds1.Tables[0].Rows[i][32].ToString();
                            j++;
                        }

                        if (sdVat != "All")
                        {
                        }
                        else
                        {
                            Vattxtbox.EnableViewState = true;
                            string txtvat1 = ds1.Tables[0].Rows[i][33].ToString();
                            j++;
                        }


                        if (sdBuyrate != "All")
                        {
                        }
                        else
                        {
                            string txtbuyrate1 = ds1.Tables[0].Rows[i][34].ToString();
                            j++;
                        }


                        if (sdrate != "All")
                        {
                        }
                        else
                        {
                            string txtrate1 = ds1.Tables[0].Rows[i][35].ToString();
                            j++;
                        }

                        if (sdNlc != "All")
                        {
                        }
                        else
                        {
                            string txtnlc1 = ds1.Tables[0].Rows[i][36].ToString();
                            j++;
                        }


                        string dat1 = ds1.Tables[0].Rows[i][37].ToString();
                        //if (ds1.Tables[0].Rows[i][j].ToString() == dat1)
                        {
                            //Stocktxtbox.Visible = true;
                            txtStartDate.Text = dat1;
                            j++;
                        }



                        string subfirstlvl = ds1.Tables[0].Rows[i][38].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == subfirstlvl)
                        {
                            DdlFirstSub.SelectedItem.Text = subfirstlvl;
                            j++;
                        }
                        string subsecondlvl = ds1.Tables[0].Rows[i][39].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == subsecondlvl)
                        {
                            DdlSecondSub.SelectedItem.Text = subsecondlvl;
                            j++;
                        }
                        string subthirdlvl = ds1.Tables[0].Rows[i][40].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == subthirdlvl)
                        {
                            DdlThirdSub.SelectedItem.Text = subthirdlvl;
                            j++;
                        }
                        string subfourlvl = ds1.Tables[0].Rows[i][41].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == subfourlvl)
                        {
                            DdlFourSub.SelectedItem.Text = subfourlvl;
                            j++;
                        }
                        string subfifthlvl = ds1.Tables[0].Rows[i][42].ToString();
                        if (ds1.Tables[0].Rows[i][j].ToString() == subfifthlvl)
                        {
                            DdlFiveSub.SelectedItem.Text = subfifthlvl;
                            j++;
                        }

                    }

                    //}

                }
                // lblMsg.Text = "Retrived";
                // lblMsg.EnableViewState = true;
                // lblMsg.Visible = true;

            }
            if (!isValidLevels())
            {
                return;
            }
            string field1;
            string field2;
            field1 = getfield();
            field2 = getfield2();
            //  string cond;
            // cond = getCond();
            getGrpByAndSelCols();
            // selCols = getGrpByAndSelCols();
            ordrby = "";
            ordrby = odrby();

            DateTime refDate = DateTime.Parse(txtStartDate.Text);

            if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
            {
                Subordrby = "";
                Subordrby = Subodrby();
                if (!isValidLevelsF())
                {
                    return;
                }
                BindDataSubTot(sDataSource, refDate, selCols, field2, cond, grpBy, Subordrby);
            }
            else
            {
                bindData(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
            }
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }


    protected void savebtn_Click(object sender, EventArgs e)
    {
        if (Savetxtbox.Text == "")
        {
            RequiredFieldValidator5.Enabled = true;
        }
        else
        {
            try
            {

                int i = 0;
                int j = 0;
                objBL.savenames = Savetxtbox.Text;
                string savename = Savetxtbox.Text;

                string chkCat = "";
                string chkBran = "";
                string chkProd = "";
                string chkMod = "";
                string chkitem = "";
                string chkstoc = "";
                string chksNlc = "";
                string chksVat = "";
                string chksBuyrate = "";
                string chksrate = "";
                string chksAll = "";
                string sdBrand = "";
                string sdCat = "";

                string sdProd = "";
                string sdMod = "";
                string sditem = "";
                string sdstoc = "";
                string sdVat = "";
                string sdBuyrate = "";
                string sdNlc = "";
                string sdrate = "";
                string sdfirstlvl = "";
                string sdsecondlvl = "";
                string sdthirdlvl = "";
                string sdfourlvl = "";
                string sdfifthlvl = "";
                string sodfirstlvl = "";
                string sodsecondlvl = "";
                string sodthirdlvl = "";
                string sodfourlvl = "";
                string sodfifthlvl = "";
                string txtstock = "";
                string txtvat = "";
                string txtbuyrate = "";
                string txtrate = "";
                string txtnlc = "";
                string dat = "";

                string subfirstlvl = "";
                string subsecondlvl = "";
                string subthirdlvl = "";
                string subfourlvl = "";
                string subfifthlvl = "";

                if (chkboxCategory.Checked == true)
                {
                    objBL.chkCats = "chkCategory";
                    chkCat = "chkCategory";
                }
                else
                {
                    objBL.chkCats = "null";
                    chkCat = "null";
                }

                if (chkboxProduct.Checked == true)
                {
                    objBL.chkProds = "chkProduct";
                    chkProd = "chkProduct";
                }
                else
                {
                    objBL.chkProds = "null";
                    chkProd = "null";
                }
                if (chkboxBrand.Checked == true)
                {
                    objBL.chkBrans = "chkBrand";
                    chkBran = "chkBrand";
                }
                else
                {
                    objBL.chkBrans = "null";
                    chkBran = "null";
                }
                if (chkboxModel.Checked == true)
                {
                    objBL.chkMods = "chkModel";
                    chkMod = "chkModel";
                }
                else
                {
                    objBL.chkMods = "null";
                    chkMod = "null";
                }
                if (chkboxItemCode.Checked == true)
                {
                    objBL.chkitems = "chkItemcode";
                    chkitem = "chkItemcode";
                }
                else
                {
                    objBL.chkitems = "null";
                    chkitem = "null";
                }
                if (chkboxStock.Checked == true)
                {
                    objBL.chkstocs = "chkstock";
                    chkstoc = "chkstock";
                }
                else
                {
                    objBL.chkstocs = "null";
                    chkstoc = "null";
                }
                if (chkboxNlc.Checked == true)
                {
                    objBL.chksNlcs = "chkNlc";
                    chksNlc = "chkNlc";
                }
                else
                {
                    objBL.chksNlcs = "null";
                    chksNlc = "null";
                }
                if (chkboxVat.Checked == true)
                {
                    objBL.chksVats = "chkVat";
                    chksVat = "chkVat";
                }
                else
                {
                    objBL.chksVats = "null";
                    chksVat = "null";
                }
                if (chkboxRate.Checked == true)
                {
                    objBL.chksrates = "chkRate";
                    chksrate = "chkRate";
                }
                else
                {
                    objBL.chksrates = "null";
                    chksrate = "null";
                }
                if (chkboxBuyrate.Checked == true)
                {
                    objBL.chksBuyrates = "chkBuyRate";
                    chksBuyrate = "chkBuyRate";
                }
                else
                {
                    objBL.chksBuyrates = "null";
                    chksBuyrate = "null";
                }
                if (chkboxAll.Checked == true)
                {
                    objBL.chksAlls = "chkAll";
                    chksAll = "chkAll";
                }
                else
                {
                    objBL.chksAlls = "null";
                    chksAll = "null";
                }
                if (ddlBrand.SelectedItem.Text != "All")
                {
                    objBL.sdBrands = ddlBrand.SelectedItem.Text;
                    sdBrand = ddlBrand.SelectedItem.Text;
                }
                else
                {
                    objBL.sdBrands = "All";
                    sdBrand = "All";
                }

                if (ddlCategory.SelectedItem.Text != "All")
                {
                    objBL.sdCats = ddlCategory.SelectedItem.Value;
                    sdCat = ddlCategory.SelectedItem.Value;
                }
                else
                {
                    objBL.sdCats = "0";
                    sdCat = "0";
                }
                if (ddlPrdctNme.SelectedItem.Text != "All")
                {
                    objBL.sdProds = ddlPrdctNme.SelectedItem.Text;
                    sdProd = ddlPrdctNme.SelectedItem.Text;
                }
                else
                {
                    objBL.sdProds = "All";
                    sdProd = "All";
                }
                if (ddlMdl.SelectedItem.Text != "All")
                {
                    objBL.sdMods = ddlMdl.SelectedItem.Text;
                    sdMod = ddlMdl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdMods = "All";
                    sdMod = "All";
                }
                if (ddlItemCode.SelectedItem.Text != "All")
                {
                    objBL.sditems = ddlItemCode.SelectedItem.Text;
                    sditem = ddlItemCode.SelectedItem.Text;
                }
                else
                {
                    objBL.sditems = "All";
                    sditem = "All";
                }
                if (ddlStock.SelectedItem.Text != "All")
                {
                    objBL.sdstocs = ddlStock.SelectedItem.Text;
                    sdstoc = ddlStock.SelectedItem.Text;
                    objBL.txtsts = Stocktxtbox.Text;
                    txtstock = Stocktxtbox.Text;
                }
                else
                {
                    objBL.sdstocs = "All";
                    sdstoc = "All";
                }
                if (ddlVat.SelectedItem.Text != "All")
                {
                    objBL.sdVats = ddlVat.SelectedItem.Text;
                    sdVat = ddlVat.SelectedItem.Text;
                    objBL.txtvas = Vattxtbox.Text;
                    txtvat = Vattxtbox.Text;
                }
                else
                {
                    objBL.sdVats = "All";
                    sdVat = "All";
                }
                if (ddlNlc.SelectedItem.Text != "All")
                {
                    objBL.sdNlcs = ddlNlc.SelectedItem.Text;
                    sdNlc = ddlNlc.SelectedItem.Text;
                    objBL.txtnls = Nlctxtbox.Text;
                    txtnlc = Nlctxtbox.Text;
                }
                else
                {
                    objBL.sdNlcs = "All";
                    sdNlc = "All";
                }

                if (ddlBuyrate.SelectedItem.Text != "All")
                {
                    objBL.sdBuyrates = ddlBuyrate.SelectedItem.Text;
                    sdBuyrate = ddlBuyrate.SelectedItem.Text;
                    objBL.txtbus = buyratetxtbox.Text;
                    txtbuyrate = buyratetxtbox.Text;
                }
                else
                {
                    objBL.sdBuyrates = "All";
                    sdBuyrate = "All";
                }
                if (ddlRate.SelectedItem.Text != "All")
                {
                    objBL.sdrates = ddlRate.SelectedItem.Text;
                    sdrate = ddlRate.SelectedItem.Text;
                    objBL.txtras = Ratetxtbox.Text;
                    txtrate = Ratetxtbox.Text;
                }
                else
                {
                    objBL.sdrates = "All";
                    sdrate = "All";
                }

                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    objBL.sdfirstlvls = ddlfirstlvl.SelectedItem.Text;
                    sdfirstlvl = ddlfirstlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdfirstlvls = "None";
                    sdfirstlvl = "None";
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    objBL.sdsecondlvls = ddlsecondlvl.SelectedItem.Text;
                    sdsecondlvl = ddlsecondlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdsecondlvls = "None";
                    sdsecondlvl = "None";
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    objBL.sdthirdlvls = ddlthirdlvl.SelectedItem.Text;
                    sdthirdlvl = ddlthirdlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdthirdlvls = "None";
                    sdthirdlvl = "None";
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    objBL.sdfourlvls = ddlfourlvl.SelectedItem.Text;
                    sdfourlvl = ddlfourlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdfourlvls = "None";
                    sdfourlvl = "None";
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    objBL.sdfifthlvls = ddlfifthlvl.SelectedItem.Text;
                    sdfifthlvl = ddlfifthlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sdfifthlvls = "None";
                    sdfifthlvl = "None";
                }
                if (odlfirstlvl.SelectedItem.Text != "None")
                {
                    objBL.sodfirstlvls = odlfirstlvl.SelectedItem.Text;
                    sodfirstlvl = odlfirstlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sodfirstlvls = "None";
                    sodfirstlvl = "None";
                }
                if (odlsecondlvl.SelectedItem.Text != "None")
                {
                    objBL.sodsecondlvls = odlsecondlvl.SelectedItem.Text;
                    sodsecondlvl = odlsecondlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sodsecondlvls = "None";
                    sodsecondlvl = "None";
                }
                if (odlthirdlvl.SelectedItem.Text != "None")
                {
                    objBL.sodthirdlvls = odlthirdlvl.SelectedItem.Text;
                    sodthirdlvl = odlthirdlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sodthirdlvls = "None";
                    sodthirdlvl = "None";
                }
                if (odlfourlvl.SelectedItem.Text != "None")
                {
                    objBL.sodfourlvls = odlfourlvl.SelectedItem.Text;
                    sodfourlvl = odlfourlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sodfourlvls = "None";
                    sodfourlvl = "None";
                }
                if (odlfifthlvl.SelectedItem.Text != "None")
                {
                    objBL.sodfifthlvls = odlfifthlvl.SelectedItem.Text;
                    sodfifthlvl = odlfifthlvl.SelectedItem.Text;
                }
                else
                {
                    objBL.sodfifthlvls = "None";
                    sodfifthlvl = "None";
                }
                objBL.dats = txtStartDate.Text;
                dat = txtStartDate.Text;



                if (DdlFirstSub.SelectedItem.Text != "None")
                {
                    objBL.subfirstlvlst = DdlFirstSub.SelectedItem.Text;
                    subfirstlvl = DdlFirstSub.SelectedItem.Text;
                }
                else
                {
                    objBL.subfirstlvlst = "None";
                    subfirstlvl = "None";
                }
                if (DdlSecondSub.SelectedItem.Text != "None")
                {
                    objBL.subsecondlvlst = DdlSecondSub.SelectedItem.Text;
                    subsecondlvl = DdlSecondSub.SelectedItem.Text;
                }
                else
                {
                    objBL.subsecondlvlst = "None";
                    subsecondlvl = "None";
                }
                if (DdlThirdSub.SelectedItem.Text != "None")
                {
                    objBL.subthirdlvlst = DdlThirdSub.SelectedItem.Text;
                    subthirdlvl = DdlThirdSub.SelectedItem.Text;
                }
                else
                {
                    objBL.subthirdlvlst = "None";
                    subthirdlvl = "None";
                }
                if (DdlFourSub.SelectedItem.Text != "None")
                {
                    objBL.subfourlvlst = DdlFourSub.SelectedItem.Text;
                    subfourlvl = DdlFourSub.SelectedItem.Text;
                }
                else
                {
                    objBL.subfourlvls = "None";
                    subfourlvl = "None";
                }
                if (DdlFiveSub.SelectedItem.Text != "None")
                {
                    objBL.subfifthlvlst = DdlFiveSub.SelectedItem.Text;
                    subfifthlvl = DdlFiveSub.SelectedItem.Text;
                }
                else
                {
                    objBL.subfifthlvlst = "None";
                    subfifthlvl = "None";
                }



                DataSet ds1 = new DataSet();
                objBL.insertsaveddata(savename, chkCat, chkBran, chkProd, chkMod, chkitem, chkstoc, chksNlc, chksVat, chksBuyrate, chksrate, chksAll, sdBrand, sdCat, sdProd, sdMod, sditem, sdstoc, sdNlc, sdVat, sdBuyrate, sdrate, sdfirstlvl, sdsecondlvl, sdthirdlvl, sdfourlvl, sdfifthlvl, sodfirstlvl, sodsecondlvl, sodthirdlvl, sodfourlvl, sodfifthlvl,txtstock,txtvat,txtbuyrate,txtrate,txtnlc,dat, subfirstlvl, subsecondlvl, subthirdlvl, subfourlvl, subfifthlvl);
                //DataGrid dsg = new Datagrid();ss


                ScriptManager.RegisterStartupScript(Page, Page.GetType(), Guid.NewGuid().ToString(), "alert('Selections Saved')", true);
                return;
            }
            catch (Exception ex)
            {
                TroyLiteExceptionManager.HandleException(ex);
                return;
            }
        }
    }

    protected void btnclear_Click(object sender, EventArgs e)
    {
        ModalPopupStock.Hide();
        try
        {
            ModalPopupStock.Show();
        chkboxAll.Checked = false;
        chkboxBrand.Checked = false;
        chkboxCategory.Checked = false;
        chkboxModel.Checked = false;
        chkboxProduct.Checked = false;
        chkboxItemCode.Checked = false;
        chkboxBuyrate.Checked = false;
        chkboxNlc.Checked = false;
        chkboxRate.Checked = false;
        chkboxStock.Checked = false;
        chkboxVat.Checked = false;
        /*fillfBrand();
        fillCategorys();
        fillProduct();
        fillModel();
        fillitemcode();
        txtStartDate.Text = DateTime.Now.ToString("dd/MM/yyyy");
        //  fillProduct();
        //fillStock();
        ddlFirst();
        ddlSconed();
        ddlThird();
        ddlFour();
        ddlFifth();
        odlFirst();
        odlSconed();
        odlThird();
        odlFour();
        odlFifth();
        fillretrive();*/

        //ddlCategory.SelectedItem.Text="All";
        //ddlBrand.SelectedItem.Text = "All";
        ddlBuyrate.SelectedItem.Text = "All";
        //ddlPrdctNme.SelectedItem.Text = "All";
        //ddlMdl.SelectedItem.Text = "All";
        //ddlItemCode.SelectedItem.Text = "All";
        ddlStock.SelectedItem.Text = "All";
        ddlVat.SelectedItem.Text = "All";
        ddlNlc.SelectedItem.Text = "All";
      //  ddlretrive.SelectedItem.Text = "All";
        ddlRate.SelectedItem.Text = "All";
        ddlfifthlvl.SelectedItem.Text = "None";
        ddlfirstlvl.SelectedItem.Text = "None";
        ddlsecondlvl.SelectedItem.Text = "None";
        ddlthirdlvl.SelectedItem.Text = "None";
        ddlfourlvl.SelectedItem.Text = "None";
        odlfifthlvl.SelectedItem.Text = "None";
        odlfirstlvl.SelectedItem.Text = "None";
        odlsecondlvl.SelectedItem.Text = "None";
        odlthirdlvl.SelectedItem.Text = "None";
        odlfourlvl.SelectedItem.Text = "None";
        Savetxtbox.Text = "";
        Ratetxtbox.Text = "";
        Stocktxtbox.Text = "";
        Vattxtbox.Text = "";
        Nlctxtbox.Text = "";
        buyratetxtbox.Text = "";
     
        ScriptManager.RegisterStartupScript(Page, Page.GetType(), Guid.NewGuid().ToString(), "alert('Items Cleared')", true);
        return;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
            return;
        }

    }
    protected void ddlStock_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            Stocktxtbox.Visible = true;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }
    protected void ddlVat_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            Vattxtbox.Visible = true;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }
    protected void ddlNlc_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            Nlctxtbox.Visible = true;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }
    protected void ddlBuyrate_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            buyratetxtbox.Visible = true;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }
    protected void ddlRate_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            Ratetxtbox.Visible = true;
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }

    protected void chkboxAll_CheckedChanged(object sender, EventArgs e)
    {
        try
        {
            if (chkboxAll.Checked == true)
            {
                chkboxBrand.Checked = true;
                chkboxCategory.Checked = true;
                chkboxModel.Checked = true;
                chkboxProduct.Checked = true;
                chkboxItemCode.Checked = true;
                chkboxBuyrate.Checked = true;
                chkboxNlc.Checked = true;
                chkboxRate.Checked = true;
                chkboxStock.Checked = true;
                chkboxVat.Checked = true;
            }
            else
            {
                chkboxBrand.Checked = false;
                chkboxCategory.Checked = false;
                chkboxModel.Checked = false;
                chkboxProduct.Checked = false;
                chkboxItemCode.Checked = false;
                chkboxBuyrate.Checked = false;
                chkboxNlc.Checked = false;
                chkboxRate.Checked = false;
                chkboxStock.Checked = false;
                chkboxVat.Checked = false;
            }
        }
        catch (Exception ex)
        {
            TroyLiteExceptionManager.HandleException(ex);
        }
    }
    protected void CustomValidator1_ServerValidate(object source, ServerValidateEventArgs args)
    {
         DateTime tempDateTime;
                String textDateTime = txtStartDate.Text;
                if (DateTime.TryParse(textDateTime, out tempDateTime))
                {
                        args.IsValid = true;
                }
                else
                {
                        args.IsValid = false;
                }
    }
    



    /////Old

    public void binddataOld(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
            {
                if (chkboxCategory.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("CategoryName"));
                }
                if (chkboxBrand.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Brand"));
                }
                if (chkboxProduct.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ProductName"));
                }
                if (chkboxModel.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Model"));
                }
                if (chkboxItemCode.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ItemCode"));
                }

                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }

            }
            /* if (selLevels.IndexOf("Brand") < 0)
                 dt.Columns.Add(new DataColumn("Brand"));
             if (selLevels.IndexOf("CategoryName") < 0)
                 dt.Columns.Add(new DataColumn("CategoryName"));
             if (selLevels.IndexOf("ItemCode") < 0)
                 dt.Columns.Add(new DataColumn("ItemCode"));
             if (selLevels.IndexOf("Model") < 0)
                 dt.Columns.Add(new DataColumn("Model"));
             if (selLevels.IndexOf("ProductName") < 0)
                 dt.Columns.Add(new DataColumn("ProductName"));*/









            dt.Columns.Add(new DataColumn("SalesValue"));

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";
            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final17["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final17["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final17["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final17["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final17["ProductName"] = "";*/

                            /* dr_final17["Rate"] = "";
                             dr_final17["NLC"] = "";
                             dr_final17["BuyRate"] = "";
                             dr_final17["VAT"] = "";
                             dr_final17["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final7["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final7["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final7["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final7["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final7["ProductName"] = "";*/

                            /*dr_final7["Rate"] = "";
                            dr_final7["NLC"] = "";
                            dr_final7["BuyRate"] = "";
                            dr_final7["VAT"] = "";
                            dr_final7["Quantity"] = */

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";

                             dr_final8["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                            }
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            /* dr_final2["Rate"] = "";
                             dr_final2["NLC"] = "";
                             dr_final2["BuyRate"] = "";
                             dr_final2["VAT"] = "";

                             dr_final2["Quantity"] = ""*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /* dr_final1["Rate"] = "";
                             dr_final1["NLC"] = "";
                             dr_final1["BuyRate"] = "";
                             dr_final1["VAT"] = "";
                             dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }



                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxCategory.Checked == true)
                    {
                        fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();

                    }

                    if (chkboxBrand.Checked == true)
                    {
                        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxModel.Checked == true)
                    {
                        frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                    }
                    dispLastTotal = true;
                    if (chkboxItemCode.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["ItemCode"] = "Total:" + fifLvlValue;
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            /*dr_final17["Rate"] = "";
                            dr_final17["NLC"] = "";
                            dr_final17["BuyRate"] = "";
                            dr_final17["VAT"] = "";
                            dr_final17["Quantity"] = "";*/


                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }

                    if (chkboxModel.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total:" + frthLvlValue;
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final7["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final7["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final7["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final7["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final7["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            /*dr_final7["Rate"] = "";
                            dr_final7["NLC"] = "";
                            dr_final7["BuyRate"] = "";
                            dr_final7["VAT"] = "";
                            dr_final7["Quantity"] = "";*/


                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (chkboxProduct.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total " + tLvlValue;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";
                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total " + sLvlValue;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";

                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (chkboxCategory.Checked == true)
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total " + fLvlValue;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";
                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (chkboxCategory.Checked == true)
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final1["CategoryName"] = fLvlValueTemp;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final1["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final1["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final1["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final1["ItemCode"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final2["Brand"] = sLvlValueTemp;
                                }
                            }
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final2["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final2["Brand"] = sLvlValueTemp;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final2["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final2["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final2["ItemCode"] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }
                            /*dr_final2["Rate"] = "";
                            dr_final2["NLC"] = "";
                            dr_final2["BuyRate"] = "";
                            dr_final2["VAT"] = "";

                            dr_final2["Quantity"] = "";*/


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final1["ProductName"] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final1["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final1["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final1["ProductName"] = tLvlValueTemp;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final1["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final1["ItemCode"] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/

                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxModel.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final1["Model"] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (chkboxCategory.Checked == true)
                                    {
                                        dr_final1["CategoryName"] = "";
                                    }
                                    if (chkboxBrand.Checked == true)
                                    {
                                        dr_final1["Brand"] = "";
                                    }
                                    if (chkboxProduct.Checked == true)
                                    {
                                        dr_final1["ProductName"] = "";
                                    }
                                    if (chkboxModel.Checked == true)
                                    {
                                        dr_final1["Model"] = frthLvlValueTemp;
                                    }
                                    if (chkboxItemCode.Checked == true)
                                    {
                                        dr_final1["ItemCode"] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";
                            dr_final1["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
    (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (chkboxCategory.Checked == true)
                                    {
                                        dr_final111["CategoryName"] = "";
                                    }
                                    if (chkboxBrand.Checked == true)
                                    {
                                        dr_final111["Brand"] = "";
                                    }
                                    if (chkboxProduct.Checked == true)
                                    {
                                        dr_final111["ProductName"] = "";
                                    }
                                    if (chkboxModel.Checked == true)
                                    {
                                        dr_final111["Model"] = "";
                                    }
                                    if (chkboxItemCode.Checked == true)
                                    {
                                        dr_final111["ItemCode"] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /* dr_final111["Rate"] = "";
                             dr_final111["NLC"] = "";
                             dr_final111["BuyRate"] = "";
                             dr_final111["VAT"] = "";
                             dr_final111["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }
                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                }

                /* if (selLevels.IndexOf("Brand") < 0)
                     dr_final5["Brand"] = dr["ProductDesc"];
                 if (selLevels.IndexOf("CategoryName") < 0)
                     dr_final5["CategoryName"] = dr["CategoryName"];
                 if (selLevels.IndexOf("ItemCode") < 0)
                     dr_final5["ItemCode"] = dr["ItemCode"];
                 if (selLevels.IndexOf("Model") < 0)
                     dr_final5["Model"] = dr["Model"];
                 if (selLevels.IndexOf("ProductName") < 0)
                     dr_final5["ProductName"] = dr["ProductName"];*/


            }

            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                {
                    if (chkboxItemCode.Checked == true)
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final17["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final17["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final17["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final17["Model"] = "";
                        }

                        /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                        dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";
                        

                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }
                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }
                    if (chkboxModel.Checked == true)
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final7["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final7["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final7["ProductName"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final7["ItemCode"] = "";
                        }

                        dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (chkboxProduct.Checked == true)
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final8["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final8["Brand"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final8["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final8["ItemCode"] = "";
                        }
                        dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }
                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final9["CategoryName"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final9["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final9["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final9["ItemCode"] = "";
                        }
                        dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*dr_final9["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }
                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (chkboxCategory.Checked == true)
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final10["CategoryName"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final10["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final10["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final10["ItemCode"] = "";
                        }
                        dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /*dr_final10["Rate"] = "";
                        dr_final10["NLC"] = "";
                        dr_final10["BuyRate"] = "";
                        dr_final10["VAT"] = "";

                        dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }
                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dr_final6["Brand"] = "";
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final6["ProductName"] = "";
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final6["Model"] = "";
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final6["ItemCode"] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }

                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }






    ///// Group By with SubTotal

    public void bindDataSen(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
            {
                if (chkboxCategory.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("CategoryName"));
                }
                if (chkboxBrand.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Brand"));
                }
                if (chkboxProduct.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ProductName"));
                }
                if (chkboxModel.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Model"));
                }
                if (chkboxItemCode.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ItemCode"));
                }

                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }

            }
            /* if (selLevels.IndexOf("Brand") < 0)
                 dt.Columns.Add(new DataColumn("Brand"));
             if (selLevels.IndexOf("CategoryName") < 0)
                 dt.Columns.Add(new DataColumn("CategoryName"));
             if (selLevels.IndexOf("ItemCode") < 0)
                 dt.Columns.Add(new DataColumn("ItemCode"));
             if (selLevels.IndexOf("Model") < 0)
                 dt.Columns.Add(new DataColumn("Model"));
             if (selLevels.IndexOf("ProductName") < 0)
                 dt.Columns.Add(new DataColumn("ProductName"));*/









            dt.Columns.Add(new DataColumn("SalesValue"));

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";
            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final17["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final17["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final17["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final17["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final17["ProductName"] = "";*/

                            /* dr_final17["Rate"] = "";
                             dr_final17["NLC"] = "";
                             dr_final17["BuyRate"] = "";
                             dr_final17["VAT"] = "";
                             dr_final17["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final7["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final7["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final7["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final7["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final7["ProductName"] = "";*/

                            /*dr_final7["Rate"] = "";
                            dr_final7["NLC"] = "";
                            dr_final7["BuyRate"] = "";
                            dr_final7["VAT"] = "";
                            dr_final7["Quantity"] = */

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";

                             dr_final8["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;




                        }
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);
                        }
                    }


                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/


                            ////Replace

                            //if (chkboxStock.Checked == true)
                            //{
                            //    dr_final1["Quantity"] = "";
                            //}
                            //if (chkboxVat.Checked == true)
                            //{
                            //    dr_final1["VAT"] = "";
                            //}
                            //if (chkboxNlc.Checked == true)
                            //{
                            //    dr_final1["NLC"] = "";
                            //}
                            //if (chkboxRate.Checked == true)
                            //{
                            //    dr_final1["Rate"] = "";

                            //}
                            //if (chkboxBuyrate.Checked == true)
                            //{
                            //    dr_final1["BuyRate"] = "";
                            //}
                            //dr_final1["SalesValue"] = "";


                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = dr["Stock"];
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = dr["VAT"];
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = dr["NLC"];
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = dr["Rate"];

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = dr["BuyRate"];
                            }


                            dr_final1["SalesValue"] = dr["SalesValue"];





                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                            }
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            /* dr_final2["Rate"] = "";
                             dr_final2["NLC"] = "";
                             dr_final2["BuyRate"] = "";
                             dr_final2["VAT"] = "";

                             dr_final2["Quantity"] = ""*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /* dr_final1["Rate"] = "";
                             dr_final1["NLC"] = "";
                             dr_final1["BuyRate"] = "";
                             dr_final1["VAT"] = "";
                             dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }



                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/




                    //////Taken



                    //dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxCategory.Checked == true)
                    {
                        fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();

                    }

                    if (chkboxBrand.Checked == true)
                    {
                        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxModel.Checked == true)
                    {
                        frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                    }
                    dispLastTotal = true;

                    if (chkboxItemCode.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["ItemCode"] = "Total:" + fifLvlValue;
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            /*dr_final17["Rate"] = "";
                            dr_final17["NLC"] = "";
                            dr_final17["BuyRate"] = "";
                            dr_final17["VAT"] = "";
                            dr_final17["Quantity"] = "";*/


                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }

                    if (chkboxModel.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total:" + frthLvlValue;
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final7["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final7["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final7["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final7["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final7["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            /*dr_final7["Rate"] = "";
                            dr_final7["NLC"] = "";
                            dr_final7["BuyRate"] = "";
                            dr_final7["VAT"] = "";
                            dr_final7["Quantity"] = "";*/


                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (chkboxProduct.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total " + tLvlValue;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";
                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total " + sLvlValue;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";

                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (chkboxCategory.Checked == true)
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total " + fLvlValue;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            /*dr_final8["Rate"] = "";
                            dr_final8["NLC"] = "";
                            dr_final8["BuyRate"] = "";
                            dr_final8["VAT"] = "";
                            dr_final8["Quantity"] = "";*/


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (chkboxCategory.Checked == true)
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final1["CategoryName"] = fLvlValueTemp;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final1["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final1["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final1["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final1["ItemCode"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final2["Brand"] = sLvlValueTemp;
                                }
                            }
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final2["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final2["Brand"] = sLvlValueTemp;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final2["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final2["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final2["ItemCode"] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }
                            /*dr_final2["Rate"] = "";
                            dr_final2["NLC"] = "";
                            dr_final2["BuyRate"] = "";
                            dr_final2["VAT"] = "";

                            dr_final2["Quantity"] = "";*/


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final1["ProductName"] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final1["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final1["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final1["ProductName"] = tLvlValueTemp;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final1["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final1["ItemCode"] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/

                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxModel.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final1["Model"] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (chkboxCategory.Checked == true)
                                    {
                                        dr_final1["CategoryName"] = "";
                                    }
                                    if (chkboxBrand.Checked == true)
                                    {
                                        dr_final1["Brand"] = "";
                                    }
                                    if (chkboxProduct.Checked == true)
                                    {
                                        dr_final1["ProductName"] = "";
                                    }
                                    if (chkboxModel.Checked == true)
                                    {
                                        dr_final1["Model"] = frthLvlValueTemp;
                                    }
                                    if (chkboxItemCode.Checked == true)
                                    {
                                        dr_final1["ItemCode"] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";
                            dr_final1["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (chkboxCategory.Checked == true)
                                    {
                                        dr_final111["CategoryName"] = "";
                                    }
                                    if (chkboxBrand.Checked == true)
                                    {
                                        dr_final111["Brand"] = "";
                                    }
                                    if (chkboxProduct.Checked == true)
                                    {
                                        dr_final111["ProductName"] = "";
                                    }
                                    if (chkboxModel.Checked == true)
                                    {
                                        dr_final111["Model"] = "";
                                    }
                                    if (chkboxItemCode.Checked == true)
                                    {
                                        dr_final111["ItemCode"] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /* dr_final111["Rate"] = "";
                             dr_final111["NLC"] = "";
                             dr_final111["BuyRate"] = "";
                             dr_final111["VAT"] = "";
                             dr_final111["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }
                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                }

                /* if (selLevels.IndexOf("Brand") < 0)
                     dr_final5["Brand"] = dr["ProductDesc"];
                 if (selLevels.IndexOf("CategoryName") < 0)
                     dr_final5["CategoryName"] = dr["CategoryName"];
                 if (selLevels.IndexOf("ItemCode") < 0)
                     dr_final5["ItemCode"] = dr["ItemCode"];
                 if (selLevels.IndexOf("Model") < 0)
                     dr_final5["Model"] = dr["Model"];
                 if (selLevels.IndexOf("ProductName") < 0)
                     dr_final5["ProductName"] = dr["ProductName"];*/


            }

            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                {
                    if (chkboxItemCode.Checked == true)
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final17["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final17["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final17["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final17["Model"] = "";
                        }

                        /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                        dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";
                        

                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }
                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }
                    if (chkboxModel.Checked == true)
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final7["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final7["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final7["ProductName"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final7["ItemCode"] = "";
                        }

                        dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (chkboxProduct.Checked == true)
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final8["CategoryName"] = "";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final8["Brand"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final8["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final8["ItemCode"] = "";
                        }
                        dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }
                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final9["CategoryName"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final9["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final9["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final9["ItemCode"] = "";
                        }
                        dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*dr_final9["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }
                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (chkboxCategory.Checked == true)
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final10["CategoryName"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final10["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final10["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final10["ItemCode"] = "";
                        }
                        dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /*dr_final10["Rate"] = "";
                        dr_final10["NLC"] = "";
                        dr_final10["BuyRate"] = "";
                        dr_final10["VAT"] = "";

                        dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }
                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dr_final6["Brand"] = "";
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final6["ProductName"] = "";
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final6["Model"] = "";
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final6["ItemCode"] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }

                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }

    private void chkboxCategory_CheckedChanged(object sender, EventArgs e)
    {

    }


    public void bindDataGroup(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((chkboxCategory.Checked == true) || (chkboxBrand.Checked == true) || (chkboxProduct.Checked == true) || (chkboxModel.Checked == true) || (chkboxItemCode.Checked == true) || (chkboxStock.Checked == true) || (chkboxNlc.Checked == true) || (chkboxRate.Checked == true) || (chkboxVat.Checked == true) || (chkboxBuyrate.Checked == true))
            {
                if (chkboxCategory.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("CategoryName"));
                }
                if (chkboxBrand.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Brand"));
                }
                if (chkboxProduct.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ProductName"));
                }
                if (chkboxModel.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Model"));
                }
                if (chkboxItemCode.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ItemCode"));
                }

                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }

            }
            /* if (selLevels.IndexOf("Brand") < 0)
                 dt.Columns.Add(new DataColumn("Brand"));
             if (selLevels.IndexOf("CategoryName") < 0)
                 dt.Columns.Add(new DataColumn("CategoryName"));
             if (selLevels.IndexOf("ItemCode") < 0)
                 dt.Columns.Add(new DataColumn("ItemCode"));
             if (selLevels.IndexOf("Model") < 0)
                 dt.Columns.Add(new DataColumn("Model"));
             if (selLevels.IndexOf("ProductName") < 0)
                 dt.Columns.Add(new DataColumn("ProductName"));*/


            dt.Columns.Add(new DataColumn("SalesValue"));

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";



            int i = 1;

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if (i == 1)
                {
                    ///New Empty Row

                    DataRow dr_final9 = dt.NewRow();
                    dt.Rows.Add(dr_final9);
                }

                i = i + 1;

                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    //dispLastTotal = true;
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                    //       (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final17 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                    //        }

                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                    //        }
                    //        //dr_final7["Brand"] = "";
                    //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                    //        //dr_final7["CategoryName"] = "";
                    //        //dr_final7["Model"] = "";
                    //        //dr_final7["ProductName"] = "";

                    //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                    //        /*  if (selLevels.IndexOf("Brand") < 0)
                    //              dr_final17["Brand"] = "";
                    //          if (selLevels.IndexOf("CategoryName") < 0)
                    //              dr_final17["CategoryName"] = "";
                    //          if (selLevels.IndexOf("ItemCode") < 0)
                    //              dr_final17["ItemCode"] = "";
                    //          if (selLevels.IndexOf("Model") < 0)
                    //              dr_final17["Model"] = "";
                    //          if (selLevels.IndexOf("ProductName") < 0)
                    //              dr_final17["ProductName"] = "";*/

                    //        /* dr_final17["Rate"] = "";
                    //         dr_final17["NLC"] = "";
                    //         dr_final17["BuyRate"] = "";
                    //         dr_final17["VAT"] = "";
                    //         dr_final17["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final17["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final17["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final17["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final17["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final17["BuyRate"] = "";
                    //        }
                    //        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        dt.Rows.Add(dr_final17);
                    //        Ittls = 0;
                    //    }
                    //}


                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final7 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                    //        }
                    //        //dr_final7["Brand"] = "";
                    //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                    //        //dr_final7["CategoryName"] = "";
                    //        //dr_final7["Model"] = "";
                    //        //dr_final7["ProductName"] = "";

                    //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                    //        /* if (selLevels.IndexOf("Brand") < 0)
                    //             dr_final7["Brand"] = "";
                    //         if (selLevels.IndexOf("CategoryName") < 0)
                    //             dr_final7["CategoryName"] = "";
                    //         if (selLevels.IndexOf("ItemCode") < 0)
                    //             dr_final7["ItemCode"] = "";
                    //         if (selLevels.IndexOf("Model") < 0)
                    //             dr_final7["Model"] = "";
                    //         if (selLevels.IndexOf("ProductName") < 0)
                    //             dr_final7["ProductName"] = "";*/

                    //        /*dr_final7["Rate"] = "";
                    //        dr_final7["NLC"] = "";
                    //        dr_final7["BuyRate"] = "";
                    //        dr_final7["VAT"] = "";
                    //        dr_final7["Quantity"] = */

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final7["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final7["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final7["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final7["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final7["BuyRate"] = "";
                    //        }
                    //        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        dt.Rows.Add(dr_final7);
                    //        Pttls = 0;
                    //    }
                    //}

                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /*  if (selLevels.IndexOf("Brand") < 0)
                    //              dr_final8["Brand"] = "";
                    //          if (selLevels.IndexOf("CategoryName") < 0)
                    //              dr_final8["CategoryName"] = "";
                    //          if (selLevels.IndexOf("ItemCode") < 0)
                    //              dr_final8["ItemCode"] = "";
                    //          if (selLevels.IndexOf("Model") < 0)
                    //              dr_final8["Model"] = "";
                    //          if (selLevels.IndexOf("ProductName") < 0)
                    //              dr_final8["ProductName"] = "";*/

                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";
                    //         dr_final8["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }
                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        //dt.Rows.Add(dr_final8);
                    //        modelTotal = 0;
                    //    }
                    //}

                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /*if (selLevels.IndexOf("Brand") < 0)
                    //            dr_final8["Brand"] = "";
                    //        if (selLevels.IndexOf("CategoryName") < 0)
                    //            dr_final8["CategoryName"] = "";
                    //        if (selLevels.IndexOf("ItemCode") < 0)
                    //            dr_final8["ItemCode"] = "";
                    //        if (selLevels.IndexOf("Model") < 0)
                    //            dr_final8["Model"] = "";
                    //        if (selLevels.IndexOf("ProductName") < 0)
                    //            dr_final8["ProductName"] = "";*/
                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";

                    //         dr_final8["Quantity"] = "";*/
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }

                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        catIDTotal = 0;
                    //    }
                    //}

                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /* if (selLevels.IndexOf("Brand") < 0)
                    //             dr_final8["Brand"] = "";
                    //         if (selLevels.IndexOf("CategoryName") < 0)
                    //             dr_final8["CategoryName"] = "";
                    //         if (selLevels.IndexOf("ItemCode") < 0)
                    //             dr_final8["ItemCode"] = "";
                    //         if (selLevels.IndexOf("Model") < 0)
                    //             dr_final8["Model"] = "";
                    //         if (selLevels.IndexOf("ProductName") < 0)
                    //             dr_final8["ProductName"] = "";*/

                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";
                    //         dr_final8["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }


                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        brandTotal = 0;




                    //    }
                    //}

                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        ///New Empty Row


                    //        DataRow dr_final9 = dt.NewRow();

                    //        dt.Rows.Add(dr_final9);
                    //    }
                    // }



                    /////First Level Of Group By 

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";
                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }
                                dr_final1["SalesValue"] = "";
                                dt.Rows.Add(dr_final1);
                            }
                        }
                        else
                        {
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/
                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";*/


                                ////Replace

                                //if (chkboxStock.Checked == true)
                                //{
                                //    dr_final1["Quantity"] = "";
                                //}
                                //if (chkboxVat.Checked == true)
                                //{
                                //    dr_final1["VAT"] = "";
                                //}
                                //if (chkboxNlc.Checked == true)
                                //{
                                //    dr_final1["NLC"] = "";
                                //}
                                //if (chkboxRate.Checked == true)
                                //{
                                //    dr_final1["Rate"] = "";

                                //}
                                //if (chkboxBuyrate.Checked == true)
                                //{
                                //    dr_final1["BuyRate"] = "";
                                //}
                                //dr_final1["SalesValue"] = "";


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];

                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }



                    /////Second Level of Group By

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {

                        if ((ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final2 = dt.NewRow();
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                {
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                }
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final2["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final2["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)
                                      dr_final2["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final2["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final2["ProductName"] = "";*/
                                /* dr_final2["Rate"] = "";
                                 dr_final2["NLC"] = "";
                                 dr_final2["BuyRate"] = "";
                                 dr_final2["VAT"] = "";

                                 dr_final2["Quantity"] = ""*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final2["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final2["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final2["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final2["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final2["BuyRate"] = "";
                                }

                                dr_final2["SalesValue"] = "";

                                dt.Rows.Add(dr_final2);
                            }
                        }
                        else
                        {

                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                DataRow dr_final2 = dt.NewRow();
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                {
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                }
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final2["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final2["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)
                                      dr_final2["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final2["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final2["ProductName"] = "";*/
                                /* dr_final2["Rate"] = "";
                                 dr_final2["NLC"] = "";
                                 dr_final2["BuyRate"] = "";
                                 dr_final2["VAT"] = "";

                                 dr_final2["Quantity"] = ""*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final2["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final2["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final2["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final2["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final2["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final2["SalesValue"] = dr["SalesValue"];
                                dt.Rows.Add(dr_final2);
                            }
                        }
                    }


                    /////// Third Level of GroupBy

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                            {
                            }
                            else
                            {

                                DataRow dr_final1 = dt.NewRow();
                                if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                {
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                }
                                //else
                                //{
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }

                                dr_final1["SalesValue"] = "";




                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";
                                dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";*/


                                dt.Rows.Add(dr_final1);
                            }
                        }
                        else
                        {

                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                {
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                }
                                //else
                                //{
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];




                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";
                                dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";*/


                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }


                    /////Fourth Level of Groupby

                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                                (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                                {
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    //else
                                    //{
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    //}
                                }

                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final1["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final1["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)

                                      dr_final1["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final1["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final1["ProductName"] = "";*/
                                /* dr_final1["Rate"] = "";
                                 dr_final1["NLC"] = "";
                                 dr_final1["BuyRate"] = "";
                                 dr_final1["VAT"] = "";
                                 dr_final1["Quantity"] = "";*/


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }

                                dr_final1["SalesValue"] = "";

                                dt.Rows.Add(dr_final1);
                            }
                        }

                        else
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                                {
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    //else
                                    //{
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    //}
                                }

                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final1["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final1["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)

                                      dr_final1["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final1["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final1["ProductName"] = "";*/
                                /* dr_final1["Rate"] = "";
                                 dr_final1["NLC"] = "";
                                 dr_final1["BuyRate"] = "";
                                 dr_final1["VAT"] = "";
                                 dr_final1["Quantity"] = "";*/


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];



                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }





                    /////Fifth Level of GroupBy



                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {

                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = dr["Stock"];
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = dr["VAT"];
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = dr["NLC"];
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = dr["Rate"];

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = dr["BuyRate"];
                            }

                            dr_final111["SalesValue"] = dr["SalesValue"];
                            dt.Rows.Add(dr_final111);

                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/




                    //////Taken



                    //dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                    dispLastTotal = true;
                }


                else
                {
                    if (chkboxCategory.Checked == true)
                    {
                        fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();

                    }

                    if (chkboxBrand.Checked == true)
                    {
                        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxModel.Checked == true)
                    {
                        frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                    dispLastTotal = true;
                }

                /* if (selLevels.IndexOf("Brand") < 0)
                     dr_final5["Brand"] = dr["ProductDesc"];
                 if (selLevels.IndexOf("CategoryName") < 0)
                     dr_final5["CategoryName"] = dr["CategoryName"];
                 if (selLevels.IndexOf("ItemCode") < 0)
                     dr_final5["ItemCode"] = dr["ItemCode"];
                 if (selLevels.IndexOf("Model") < 0)
                     dr_final5["Model"] = dr["Model"];
                 if (selLevels.IndexOf("ProductName") < 0)
                     dr_final5["ProductName"] = dr["ProductName"];*/


            }

            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final17 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        //}


                        //dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final17["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final17["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final17["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final17["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final17["ProductName"] = "";*/
                        ///*dr_final17["Rate"] = "";
                        //dr_final17["NLC"] = "";
                        //dr_final17["BuyRate"] = "";
                        //dr_final17["VAT"] = "";


                        //dr_final17["Quantity"] = "";*/
                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final17["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final17["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final17["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final17["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final17["BuyRate"] = "";
                        //}

                        //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        //dt.Rows.Add(dr_final17);

                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final7 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        //}

                        //dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        ///*if (selLevels.IndexOf("Brand") < 0)
                        //    dr_final7["Brand"] = "";
                        //if (selLevels.IndexOf("CategoryName") < 0)
                        //    dr_final7["CategoryName"] = "";
                        //if (selLevels.IndexOf("ItemCode") < 0)
                        //    dr_final7["ItemCode"] = "";
                        //if (selLevels.IndexOf("Model") < 0)
                        //    dr_final7["Model"] = "";
                        //if (selLevels.IndexOf("ProductName") < 0)
                        //    dr_final7["ProductName"] = "";*/
                        ///*dr_final7["Rate"] = "";
                        //dr_final7["NLC"] = "";
                        //dr_final7["BuyRate"] = "";
                        //dr_final7["VAT"] = "";

                        //dr_final7["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final7["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final7["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final7["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final7["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final7["BuyRate"] = "";
                        //}

                        //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        //dt.Rows.Add(dr_final7);

                        Pttls = 0;
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final8 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        //}
                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final8["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final8["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final8["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final8["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final8["ProductName"] = "";*/
                        ///* dr_final8["Rate"] = "";
                        // dr_final8["NLC"] = "";
                        // dr_final8["BuyRate"] = "";
                        // dr_final8["VAT"] = "";

                        // dr_final8["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final8["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final8["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final8["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final8["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final8["BuyRate"] = "";
                        //}

                        //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        //dt.Rows.Add(dr_final8);

                        modelTotal = 0;

                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            ///New Empty Row

                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final9 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        //}
                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final9["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final9["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final9["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final9["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final9["ProductName"] = "";*/
                        ///*["Rate"] = "";
                        //dr_final9["NLC"] = "";
                        //dr_final9["BuyRate"] = "";
                        //dr_final9["VAT"] = "";

                        //dr_final9["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final9["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final9["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final9["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final9["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final9["BuyRate"] = "";
                        //}

                        //dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        //dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final10 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        //}

                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final10["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final10["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final10["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final10["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final10["ProductName"] = "";*/

                        ///* dr_final10["Rate"] = "";
                        // dr_final10["NLC"] = "";
                        // dr_final10["BuyRate"] = "";
                        // dr_final10["VAT"] = "";

                        // dr_final10["Quantity"] = "";*/
                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final10["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final10["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final10["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final10["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final10["BuyRate"] = "";
                        //}

                        //dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        //dt.Rows.Add(dr_final10);
                        //brandTotal = 0;


                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    DataRow dr_final6 = dt.NewRow();

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                    }

                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";

                    //}
                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                    //}

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
                else if ((chkboxCategory.Checked == true) || (chkboxBrand.Checked == true) || (chkboxProduct.Checked == true) || (chkboxModel.Checked == true) || (chkboxItemCode.Checked == true))
                {
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    DataRow dr_final17 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final17["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final17["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final17["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final17["Model"] = "";
                    //    }

                    //    /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                    //    dr_final17["Rate"] = "";
                    //    dr_final17["NLC"] = "";
                    //    dr_final17["BuyRate"] = "";
                    //    dr_final17["VAT"] = "";


                    //    dr_final17["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final17["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final17["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final17["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final17["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final17["BuyRate"] = "";
                    //    }
                    //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //    dt.Rows.Add(dr_final17);
                    //    Ittls = 0;
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    DataRow dr_final7 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final7["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final7["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final7["ProductName"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final7["ItemCode"] = "";
                    //    }

                    //    dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                    //    /*if (selLevels.IndexOf("Brand") < 0)
                    //        dr_final7["Brand"] = "";
                    //    if (selLevels.IndexOf("CategoryName") < 0)
                    //        dr_final7["CategoryName"] = "";
                    //    if (selLevels.IndexOf("ItemCode") < 0)
                    //        dr_final7["ItemCode"] = "";
                    //    if (selLevels.IndexOf("Model") < 0)
                    //        dr_final7["Model"] = "";
                    //    if (selLevels.IndexOf("ProductName") < 0)
                    //        dr_final7["ProductName"] = "";*/
                    //    /*dr_final7["Rate"] = "";
                    //    dr_final7["NLC"] = "";
                    //    dr_final7["BuyRate"] = "";
                    //    dr_final7["VAT"] = "";

                    //    dr_final7["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final7["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final7["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final7["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final7["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final7["BuyRate"] = "";
                    //    }

                    //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //    dt.Rows.Add(dr_final7);
                    //    Pttls = 0;
                    //}

                    //if (chkboxProduct.Checked == true)
                    //{
                    //    DataRow dr_final8 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final8["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final8["Brand"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final8["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final8["ItemCode"] = "";
                    //    }
                    //    dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final8["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final8["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final8["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final8["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final8["ProductName"] = "";*/
                    //    /* dr_final8["Rate"] = "";
                    //     dr_final8["NLC"] = "";
                    //     dr_final8["BuyRate"] = "";
                    //     dr_final8["VAT"] = "";

                    //     dr_final8["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final8["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final8["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final8["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final8["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final8["BuyRate"] = "";
                    //    }
                    //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //    dt.Rows.Add(dr_final8);
                    //    modelTotal = 0;
                    //}

                    //if (chkboxBrand.Checked == true)
                    //{
                    //    DataRow dr_final9 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final9["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final9["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final9["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final9["ItemCode"] = "";
                    //    }
                    //    dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final9["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final9["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final9["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final9["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final9["ProductName"] = "";*/
                    //    /*dr_final9["Rate"] = "";
                    //    dr_final9["NLC"] = "";
                    //    dr_final9["BuyRate"] = "";
                    //    dr_final9["VAT"] = "";

                    //    dr_final9["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final9["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final9["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final9["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final9["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final9["BuyRate"] = "";
                    //    }
                    //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //    dt.Rows.Add(dr_final9);
                    //    catIDTotal = 0;
                    //}

                    //if (chkboxCategory.Checked == true)
                    //{
                    //    DataRow dr_final10 = dt.NewRow();
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final10["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final10["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final10["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final10["ItemCode"] = "";
                    //    }
                    //    dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final10["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final10["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final10["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final10["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final10["ProductName"] = "";*/

                    //    /*dr_final10["Rate"] = "";
                    //    dr_final10["NLC"] = "";
                    //    dr_final10["BuyRate"] = "";
                    //    dr_final10["VAT"] = "";

                    //    dr_final10["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final10["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final10["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final10["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final10["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final10["BuyRate"] = "";
                    //    }
                    //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //    dt.Rows.Add(dr_final10);
                    //    brandTotal = 0;
                    //}
                    DataRow dr5 = dt.NewRow();
                    dt.Rows.Add(dr5);
                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dr_final6["Brand"] = "";
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final6["ProductName"] = "";
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final6["Model"] = "";
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final6["ItemCode"] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }



            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }


    public void bindData6(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((chkboxCategory.Checked == true) || (chkboxBrand.Checked == true) || (chkboxProduct.Checked == true) || (chkboxModel.Checked == true) || (chkboxItemCode.Checked == true) || (chkboxStock.Checked == true) || (chkboxNlc.Checked == true) || (chkboxRate.Checked == true) || (chkboxVat.Checked == true) || (chkboxBuyrate.Checked == true))
            {
                if (chkboxCategory.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("CategoryName"));
                }
                if (chkboxBrand.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Brand"));
                }
                if (chkboxProduct.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ProductName"));
                }
                if (chkboxModel.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Model"));
                }
                if (chkboxItemCode.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ItemCode"));
                }

                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }

            }
            /* if (selLevels.IndexOf("Brand") < 0)
                 dt.Columns.Add(new DataColumn("Brand"));
             if (selLevels.IndexOf("CategoryName") < 0)
                 dt.Columns.Add(new DataColumn("CategoryName"));
             if (selLevels.IndexOf("ItemCode") < 0)
                 dt.Columns.Add(new DataColumn("ItemCode"));
             if (selLevels.IndexOf("Model") < 0)
                 dt.Columns.Add(new DataColumn("Model"));
             if (selLevels.IndexOf("ProductName") < 0)
                 dt.Columns.Add(new DataColumn("ProductName"));*/


            dt.Columns.Add(new DataColumn("SalesValue"));

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";



            int i = 1;

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if (i == 1)
                {
                    ///New Empty Row

                    DataRow dr_final9 = dt.NewRow();
                    dt.Rows.Add(dr_final9);
                }

                i = i + 1;

                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    //dispLastTotal = true;
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                    //       (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final17 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                    //        }

                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                    //        }
                    //        //dr_final7["Brand"] = "";
                    //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                    //        //dr_final7["CategoryName"] = "";
                    //        //dr_final7["Model"] = "";
                    //        //dr_final7["ProductName"] = "";

                    //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                    //        /*  if (selLevels.IndexOf("Brand") < 0)
                    //              dr_final17["Brand"] = "";
                    //          if (selLevels.IndexOf("CategoryName") < 0)
                    //              dr_final17["CategoryName"] = "";
                    //          if (selLevels.IndexOf("ItemCode") < 0)
                    //              dr_final17["ItemCode"] = "";
                    //          if (selLevels.IndexOf("Model") < 0)
                    //              dr_final17["Model"] = "";
                    //          if (selLevels.IndexOf("ProductName") < 0)
                    //              dr_final17["ProductName"] = "";*/

                    //        /* dr_final17["Rate"] = "";
                    //         dr_final17["NLC"] = "";
                    //         dr_final17["BuyRate"] = "";
                    //         dr_final17["VAT"] = "";
                    //         dr_final17["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final17["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final17["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final17["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final17["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final17["BuyRate"] = "";
                    //        }
                    //        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        dt.Rows.Add(dr_final17);
                    //        Ittls = 0;
                    //    }
                    //}


                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final7 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                    //        }
                    //        //dr_final7["Brand"] = "";
                    //        ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                    //        //dr_final7["CategoryName"] = "";
                    //        //dr_final7["Model"] = "";
                    //        //dr_final7["ProductName"] = "";

                    //        //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                    //        /* if (selLevels.IndexOf("Brand") < 0)
                    //             dr_final7["Brand"] = "";
                    //         if (selLevels.IndexOf("CategoryName") < 0)
                    //             dr_final7["CategoryName"] = "";
                    //         if (selLevels.IndexOf("ItemCode") < 0)
                    //             dr_final7["ItemCode"] = "";
                    //         if (selLevels.IndexOf("Model") < 0)
                    //             dr_final7["Model"] = "";
                    //         if (selLevels.IndexOf("ProductName") < 0)
                    //             dr_final7["ProductName"] = "";*/

                    //        /*dr_final7["Rate"] = "";
                    //        dr_final7["NLC"] = "";
                    //        dr_final7["BuyRate"] = "";
                    //        dr_final7["VAT"] = "";
                    //        dr_final7["Quantity"] = */

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final7["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final7["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final7["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final7["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final7["BuyRate"] = "";
                    //        }
                    //        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        dt.Rows.Add(dr_final7);
                    //        Pttls = 0;
                    //    }
                    //}

                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /*  if (selLevels.IndexOf("Brand") < 0)
                    //              dr_final8["Brand"] = "";
                    //          if (selLevels.IndexOf("CategoryName") < 0)
                    //              dr_final8["CategoryName"] = "";
                    //          if (selLevels.IndexOf("ItemCode") < 0)
                    //              dr_final8["ItemCode"] = "";
                    //          if (selLevels.IndexOf("Model") < 0)
                    //              dr_final8["Model"] = "";
                    //          if (selLevels.IndexOf("ProductName") < 0)
                    //              dr_final8["ProductName"] = "";*/

                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";
                    //         dr_final8["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }
                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        //dt.Rows.Add(dr_final8);
                    //        modelTotal = 0;
                    //    }
                    //}

                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /*if (selLevels.IndexOf("Brand") < 0)
                    //            dr_final8["Brand"] = "";
                    //        if (selLevels.IndexOf("CategoryName") < 0)
                    //            dr_final8["CategoryName"] = "";
                    //        if (selLevels.IndexOf("ItemCode") < 0)
                    //            dr_final8["ItemCode"] = "";
                    //        if (selLevels.IndexOf("Model") < 0)
                    //            dr_final8["Model"] = "";
                    //        if (selLevels.IndexOf("ProductName") < 0)
                    //            dr_final8["ProductName"] = "";*/
                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";

                    //         dr_final8["Quantity"] = "";*/
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }

                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        catIDTotal = 0;
                    //    }
                    //}

                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        /* if (selLevels.IndexOf("Brand") < 0)
                    //             dr_final8["Brand"] = "";
                    //         if (selLevels.IndexOf("CategoryName") < 0)
                    //             dr_final8["CategoryName"] = "";
                    //         if (selLevels.IndexOf("ItemCode") < 0)
                    //             dr_final8["ItemCode"] = "";
                    //         if (selLevels.IndexOf("Model") < 0)
                    //             dr_final8["Model"] = "";
                    //         if (selLevels.IndexOf("ProductName") < 0)
                    //             dr_final8["ProductName"] = "";*/

                    //        /* dr_final8["Rate"] = "";
                    //         dr_final8["NLC"] = "";
                    //         dr_final8["BuyRate"] = "";
                    //         dr_final8["VAT"] = "";
                    //         dr_final8["Quantity"] = "";*/

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }


                    //        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        dt.Rows.Add(dr_final8);
                    //        brandTotal = 0;




                    //    }
                    //}

                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        ///New Empty Row


                    //        DataRow dr_final9 = dt.NewRow();

                    //        dt.Rows.Add(dr_final9);
                    //    }
                    // }



                    /////First Level Of Group By 

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                                (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";
                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }
                                dr_final1["SalesValue"] = "";
                                dt.Rows.Add(dr_final1);
                            }
                        }
                        else
                        {
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/
                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";*/


                                ////Replace

                                //if (chkboxStock.Checked == true)
                                //{
                                //    dr_final1["Quantity"] = "";
                                //}
                                //if (chkboxVat.Checked == true)
                                //{
                                //    dr_final1["VAT"] = "";
                                //}
                                //if (chkboxNlc.Checked == true)
                                //{
                                //    dr_final1["NLC"] = "";
                                //}
                                //if (chkboxRate.Checked == true)
                                //{
                                //    dr_final1["Rate"] = "";

                                //}
                                //if (chkboxBuyrate.Checked == true)
                                //{
                                //    dr_final1["BuyRate"] = "";
                                //}
                                //dr_final1["SalesValue"] = "";


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];

                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }



                    /////Second Level of Group By

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {

                        if ((ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final2 = dt.NewRow();
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                {
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                }
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final2["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final2["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)
                                      dr_final2["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final2["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final2["ProductName"] = "";*/
                                /* dr_final2["Rate"] = "";
                                 dr_final2["NLC"] = "";
                                 dr_final2["BuyRate"] = "";
                                 dr_final2["VAT"] = "";

                                 dr_final2["Quantity"] = ""*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final2["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final2["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final2["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final2["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final2["BuyRate"] = "";
                                }

                                dr_final2["SalesValue"] = "";

                                dt.Rows.Add(dr_final2);
                            }
                        }
                        else
                        {

                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                DataRow dr_final2 = dt.NewRow();
                                if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                                {
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                }
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final2["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final2["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)
                                      dr_final2["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final2["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final2["ProductName"] = "";*/
                                /* dr_final2["Rate"] = "";
                                 dr_final2["NLC"] = "";
                                 dr_final2["BuyRate"] = "";
                                 dr_final2["VAT"] = "";

                                 dr_final2["Quantity"] = ""*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final2["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final2["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final2["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final2["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final2["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final2["SalesValue"] = dr["SalesValue"];
                                dt.Rows.Add(dr_final2);
                            }
                        }
                    }


                    /////// Third Level of GroupBy

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                            {
                            }
                            else
                            {

                                DataRow dr_final1 = dt.NewRow();
                                if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                {
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                }
                                //else
                                //{
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }

                                dr_final1["SalesValue"] = "";




                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";
                                dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";*/


                                dt.Rows.Add(dr_final1);
                            }
                        }
                        else
                        {

                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                                {
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                }
                                //else
                                //{
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                                }
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                }
                                /*if (selLevels.IndexOf("Brand") < 0)
                                    dr_final1["Brand"] = "";
                                if (selLevels.IndexOf("CategoryName") < 0)
                                    dr_final1["CategoryName"] = "";
                                if (selLevels.IndexOf("ItemCode") < 0)
                                    dr_final1["ItemCode"] = "";
                                if (selLevels.IndexOf("Model") < 0)
                                    dr_final1["Model"] = "";
                                if (selLevels.IndexOf("ProductName") < 0)
                                    dr_final1["ProductName"] = "";*/

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];




                                /*dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";

                                dr_final1["Quantity"] = "";
                                dr_final1["Rate"] = "";
                                dr_final1["NLC"] = "";
                                dr_final1["BuyRate"] = "";
                                dr_final1["VAT"] = "";*/


                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }


                    /////Fourth Level of Groupby

                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((ddlfifthlvl.SelectedItem.Text != "None"))
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                            }
                            else
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                                {
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    //else
                                    //{
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    //}
                                }

                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final1["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final1["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)

                                      dr_final1["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final1["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final1["ProductName"] = "";*/
                                /* dr_final1["Rate"] = "";
                                 dr_final1["NLC"] = "";
                                 dr_final1["BuyRate"] = "";
                                 dr_final1["VAT"] = "";
                                 dr_final1["Quantity"] = "";*/


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = "";
                                }

                                dr_final1["SalesValue"] = "";

                                dt.Rows.Add(dr_final1);
                            }
                        }

                        else
                        {
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                            {
                                DataRow dr_final1 = dt.NewRow();
                                if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                                {
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    //else
                                    //{
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                    //}
                                }

                                /*  if (selLevels.IndexOf("Brand") < 0)
                                      dr_final1["Brand"] = "";
                                  if (selLevels.IndexOf("CategoryName") < 0)
                                      dr_final1["CategoryName"] = "";
                                  if (selLevels.IndexOf("ItemCode") < 0)

                                      dr_final1["ItemCode"] = "";
                                  if (selLevels.IndexOf("Model") < 0)
                                      dr_final1["Model"] = "";
                                  if (selLevels.IndexOf("ProductName") < 0)
                                      dr_final1["ProductName"] = "";*/
                                /* dr_final1["Rate"] = "";
                                 dr_final1["NLC"] = "";
                                 dr_final1["BuyRate"] = "";
                                 dr_final1["VAT"] = "";
                                 dr_final1["Quantity"] = "";*/


                                if (chkboxStock.Checked == true)
                                {
                                    dr_final1["Quantity"] = dr["Stock"];
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final1["VAT"] = dr["VAT"];
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final1["NLC"] = dr["NLC"];
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final1["Rate"] = dr["Rate"];

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final1["BuyRate"] = dr["BuyRate"];
                                }

                                dr_final1["SalesValue"] = dr["SalesValue"];



                                dt.Rows.Add(dr_final1);
                            }
                        }
                    }





                    /////Fifth Level of GroupBy



                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {

                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                //else
                                //{
                                if (ddlfirstlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                                }
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }

                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }

                                //}
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = dr["Stock"];
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = dr["VAT"];
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = dr["NLC"];
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = dr["Rate"];

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = dr["BuyRate"];
                            }

                            dr_final111["SalesValue"] = dr["SalesValue"];
                            dt.Rows.Add(dr_final111);

                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/




                    //////Taken



                    //dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                    dispLastTotal = true;
                }


                else
                {
                    if (chkboxCategory.Checked == true)
                    {
                        fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();

                    }

                    if (chkboxBrand.Checked == true)
                    {
                        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxModel.Checked == true)
                    {
                        frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                    dispLastTotal = true;
                }

                /* if (selLevels.IndexOf("Brand") < 0)
                     dr_final5["Brand"] = dr["ProductDesc"];
                 if (selLevels.IndexOf("CategoryName") < 0)
                     dr_final5["CategoryName"] = dr["CategoryName"];
                 if (selLevels.IndexOf("ItemCode") < 0)
                     dr_final5["ItemCode"] = dr["ItemCode"];
                 if (selLevels.IndexOf("Model") < 0)
                     dr_final5["Model"] = dr["Model"];
                 if (selLevels.IndexOf("ProductName") < 0)
                     dr_final5["ProductName"] = dr["ProductName"];*/


            }

            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final17 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        //}


                        //dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final17["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final17["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final17["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final17["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final17["ProductName"] = "";*/
                        ///*dr_final17["Rate"] = "";
                        //dr_final17["NLC"] = "";
                        //dr_final17["BuyRate"] = "";
                        //dr_final17["VAT"] = "";


                        //dr_final17["Quantity"] = "";*/
                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final17["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final17["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final17["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final17["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final17["BuyRate"] = "";
                        //}

                        //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        //dt.Rows.Add(dr_final17);

                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final7 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        //}

                        //dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        ///*if (selLevels.IndexOf("Brand") < 0)
                        //    dr_final7["Brand"] = "";
                        //if (selLevels.IndexOf("CategoryName") < 0)
                        //    dr_final7["CategoryName"] = "";
                        //if (selLevels.IndexOf("ItemCode") < 0)
                        //    dr_final7["ItemCode"] = "";
                        //if (selLevels.IndexOf("Model") < 0)
                        //    dr_final7["Model"] = "";
                        //if (selLevels.IndexOf("ProductName") < 0)
                        //    dr_final7["ProductName"] = "";*/
                        ///*dr_final7["Rate"] = "";
                        //dr_final7["NLC"] = "";
                        //dr_final7["BuyRate"] = "";
                        //dr_final7["VAT"] = "";

                        //dr_final7["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final7["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final7["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final7["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final7["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final7["BuyRate"] = "";
                        //}

                        //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        //dt.Rows.Add(dr_final7);

                        Pttls = 0;
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final8 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        //}
                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final8["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final8["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final8["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final8["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final8["ProductName"] = "";*/
                        ///* dr_final8["Rate"] = "";
                        // dr_final8["NLC"] = "";
                        // dr_final8["BuyRate"] = "";
                        // dr_final8["VAT"] = "";

                        // dr_final8["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final8["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final8["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final8["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final8["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final8["BuyRate"] = "";
                        //}

                        //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        //dt.Rows.Add(dr_final8);

                        modelTotal = 0;

                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            ///New Empty Row

                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final9 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        //}
                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final9["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final9["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final9["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final9["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final9["ProductName"] = "";*/
                        ///*["Rate"] = "";
                        //dr_final9["NLC"] = "";
                        //dr_final9["BuyRate"] = "";
                        //dr_final9["VAT"] = "";

                        //dr_final9["Quantity"] = "";*/

                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final9["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final9["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final9["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final9["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final9["BuyRate"] = "";
                        //}

                        //dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        //dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        //DataRow dr_final10 = dt.NewRow();
                        //if (ddlfirstlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        //}
                        //if (ddlsecondlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlthirdlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfourlvl.SelectedItem.Text != "None")
                        //{
                        //    dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        //}
                        //if (ddlfifthlvl.SelectedItem.Text != "None")
                        //{
                        //    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                        //    dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        //}

                        ///* if (selLevels.IndexOf("Brand") < 0)
                        //     dr_final10["Brand"] = "";
                        // if (selLevels.IndexOf("CategoryName") < 0)
                        //     dr_final10["CategoryName"] = "";
                        // if (selLevels.IndexOf("ItemCode") < 0)
                        //     dr_final10["ItemCode"] = "";
                        // if (selLevels.IndexOf("Model") < 0)
                        //     dr_final10["Model"] = "";
                        // if (selLevels.IndexOf("ProductName") < 0)
                        //     dr_final10["ProductName"] = "";*/

                        ///* dr_final10["Rate"] = "";
                        // dr_final10["NLC"] = "";
                        // dr_final10["BuyRate"] = "";
                        // dr_final10["VAT"] = "";

                        // dr_final10["Quantity"] = "";*/
                        //if (chkboxStock.Checked == true)
                        //{
                        //    dr_final10["Quantity"] = "";
                        //}
                        //if (chkboxVat.Checked == true)
                        //{
                        //    dr_final10["VAT"] = "";
                        //}
                        //if (chkboxNlc.Checked == true)
                        //{
                        //    dr_final10["NLC"] = "";
                        //}
                        //if (chkboxRate.Checked == true)
                        //{
                        //    dr_final10["Rate"] = "";

                        //}
                        //if (chkboxBuyrate.Checked == true)
                        //{
                        //    dr_final10["BuyRate"] = "";
                        //}

                        //dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        //dt.Rows.Add(dr_final10);
                        //brandTotal = 0;


                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {

                            ///New Empty Row


                            DataRow dr_final9 = dt.NewRow();

                            dt.Rows.Add(dr_final9);

                        }

                    }

                    DataRow dr_final6 = dt.NewRow();

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                            dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                            dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                            dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                        }
                    }

                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";

                    //}
                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "Grand Total: ";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    //}
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    dr_final6[ddlfirstlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    //    dr_final6[ddlfifthlvl.SelectedItem.Text] = "Grand Total: ";
                    //}

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
                else if ((chkboxCategory.Checked == true) || (chkboxBrand.Checked == true) || (chkboxProduct.Checked == true) || (chkboxModel.Checked == true) || (chkboxItemCode.Checked == true))
                {
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    DataRow dr_final17 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final17["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final17["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final17["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final17["Model"] = "";
                    //    }

                    //    /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                    //    dr_final17["Rate"] = "";
                    //    dr_final17["NLC"] = "";
                    //    dr_final17["BuyRate"] = "";
                    //    dr_final17["VAT"] = "";


                    //    dr_final17["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final17["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final17["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final17["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final17["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final17["BuyRate"] = "";
                    //    }
                    //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //    dt.Rows.Add(dr_final17);
                    //    Ittls = 0;
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    DataRow dr_final7 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final7["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final7["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final7["ProductName"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final7["ItemCode"] = "";
                    //    }

                    //    dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                    //    /*if (selLevels.IndexOf("Brand") < 0)
                    //        dr_final7["Brand"] = "";
                    //    if (selLevels.IndexOf("CategoryName") < 0)
                    //        dr_final7["CategoryName"] = "";
                    //    if (selLevels.IndexOf("ItemCode") < 0)
                    //        dr_final7["ItemCode"] = "";
                    //    if (selLevels.IndexOf("Model") < 0)
                    //        dr_final7["Model"] = "";
                    //    if (selLevels.IndexOf("ProductName") < 0)
                    //        dr_final7["ProductName"] = "";*/
                    //    /*dr_final7["Rate"] = "";
                    //    dr_final7["NLC"] = "";
                    //    dr_final7["BuyRate"] = "";
                    //    dr_final7["VAT"] = "";

                    //    dr_final7["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final7["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final7["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final7["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final7["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final7["BuyRate"] = "";
                    //    }

                    //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //    dt.Rows.Add(dr_final7);
                    //    Pttls = 0;
                    //}

                    //if (chkboxProduct.Checked == true)
                    //{
                    //    DataRow dr_final8 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final8["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final8["Brand"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final8["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final8["ItemCode"] = "";
                    //    }
                    //    dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final8["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final8["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final8["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final8["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final8["ProductName"] = "";*/
                    //    /* dr_final8["Rate"] = "";
                    //     dr_final8["NLC"] = "";
                    //     dr_final8["BuyRate"] = "";
                    //     dr_final8["VAT"] = "";

                    //     dr_final8["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final8["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final8["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final8["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final8["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final8["BuyRate"] = "";
                    //    }
                    //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //    dt.Rows.Add(dr_final8);
                    //    modelTotal = 0;
                    //}

                    //if (chkboxBrand.Checked == true)
                    //{
                    //    DataRow dr_final9 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final9["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final9["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final9["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final9["ItemCode"] = "";
                    //    }
                    //    dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final9["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final9["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final9["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final9["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final9["ProductName"] = "";*/
                    //    /*dr_final9["Rate"] = "";
                    //    dr_final9["NLC"] = "";
                    //    dr_final9["BuyRate"] = "";
                    //    dr_final9["VAT"] = "";

                    //    dr_final9["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final9["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final9["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final9["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final9["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final9["BuyRate"] = "";
                    //    }
                    //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //    dt.Rows.Add(dr_final9);
                    //    catIDTotal = 0;
                    //}

                    //if (chkboxCategory.Checked == true)
                    //{
                    //    DataRow dr_final10 = dt.NewRow();
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final10["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final10["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final10["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final10["ItemCode"] = "";
                    //    }
                    //    dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final10["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final10["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final10["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final10["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final10["ProductName"] = "";*/

                    //    /*dr_final10["Rate"] = "";
                    //    dr_final10["NLC"] = "";
                    //    dr_final10["BuyRate"] = "";
                    //    dr_final10["VAT"] = "";

                    //    dr_final10["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final10["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final10["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final10["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final10["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final10["BuyRate"] = "";
                    //    }
                    //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //    dt.Rows.Add(dr_final10);
                    //    brandTotal = 0;
                    //}
                    DataRow dr5 = dt.NewRow();
                    dt.Rows.Add(dr5);
                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dr_final6["Brand"] = "";
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final6["ProductName"] = "";
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final6["Model"] = "";
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final6["ItemCode"] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }



            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }


    public void BindDataSubTot(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy,string Subordrby)
    {
        string FLvlSub = "", SLvlSub = "", TLvlSub = "", FourLvlSub = "", FiveLvlSUb = "";
        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdateSub(sDataSource, refDate, selCols, field2, cond, grpBy, Subordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if (((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None")) && ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None")))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            FLvlSub = DdlFirstSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FLvlSub));
                            SLvlSub = DdlSecondSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(SLvlSub));
                            TLvlSub = DdlThirdSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(TLvlSub));
                            FourLvlSub = DdlFourSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FourLvlSub));
                            FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FiveLvlSUb));
                        }
                        else if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            FLvlSub = DdlFirstSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FLvlSub));
                            SLvlSub = DdlSecondSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(SLvlSub));
                            TLvlSub = DdlThirdSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(TLvlSub));
                            FourLvlSub = DdlFourSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FourLvlSub));

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                FiveLvlSUb = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                FiveLvlSUb = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                FiveLvlSUb = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                FiveLvlSUb = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                FiveLvlSUb = "ItemCode";
                            }
                        }
                        else if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            FLvlSub = DdlFirstSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FLvlSub));
                            SLvlSub = DdlSecondSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(SLvlSub));
                            TLvlSub = DdlThirdSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(TLvlSub));

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                FourLvlSub = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                FourLvlSub = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                FourLvlSub = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                FourLvlSub = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                FourLvlSub = "ItemCode";
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                FiveLvlSUb = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                FiveLvlSUb = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                FiveLvlSUb = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                FiveLvlSUb = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                FiveLvlSUb = "ItemCode";
                            }

                        }
                        else if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            FLvlSub = DdlFirstSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FLvlSub));
                            SLvlSub = DdlSecondSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(SLvlSub));
                            

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                TLvlSub = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                TLvlSub = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                TLvlSub = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                TLvlSub = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                TLvlSub = "ItemCode";
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                FourLvlSub = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                FourLvlSub = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                FourLvlSub = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                FourLvlSub = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                FourLvlSub = "ItemCode";
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                FiveLvlSUb = "CategoryName";
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dt.Columns.Add(new DataColumn("Model"));
                                FiveLvlSUb = "Model";
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                FiveLvlSUb = "Brand";
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dt.Columns.Add(new DataColumn("ProductName"));
                                FiveLvlSUb = "ProductName";
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dt.Columns.Add(new DataColumn("ItemCode"));
                                FiveLvlSUb = "ItemCode";
                            }

                        }
                        else if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            FLvlSub = DdlFirstSub.SelectedItem.Text;
                            dt.Columns.Add(new DataColumn(FLvlSub));
                            if (FLvlSub == "CategoryName")
                            {
                                dt.Columns.Add(new DataColumn("Brand"));
                                dt.Columns.Add(new DataColumn("ProductName"));
                                dt.Columns.Add(new DataColumn("Model"));
                                dt.Columns.Add(new DataColumn("ItemCode"));
                            }
                            else if (FLvlSub == "Model")
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                dt.Columns.Add(new DataColumn("Brand"));
                                dt.Columns.Add(new DataColumn("ProductName"));
                                dt.Columns.Add(new DataColumn("ItemCode"));
                            }
                            else if (FLvlSub == "Brand")
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                dt.Columns.Add(new DataColumn("Model"));
                                dt.Columns.Add(new DataColumn("ProductName"));
                                dt.Columns.Add(new DataColumn("ItemCode"));
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                dt.Columns.Add(new DataColumn("Brand"));
                                dt.Columns.Add(new DataColumn("Model"));
                                dt.Columns.Add(new DataColumn("ItemCode"));
                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dt.Columns.Add(new DataColumn("CategoryName"));
                                dt.Columns.Add(new DataColumn("Brand"));
                                dt.Columns.Add(new DataColumn("Model"));
                                dt.Columns.Add(new DataColumn("ProductName"));
                            }

                        }

                        //if (chkboxCategory.Checked == true)
                        //{
                        //    dt.Columns.Add(new DataColumn("CategoryName"));
                        //}
                        //if (chkboxBrand.Checked == true)
                        //{
                        //    dt.Columns.Add(new DataColumn("Brand"));
                        //}
                        //if (chkboxProduct.Checked == true)
                        //{
                        //    dt.Columns.Add(new DataColumn("ProductName"));
                        //}
                        //if (chkboxModel.Checked == true)
                        //{
                        //    dt.Columns.Add(new DataColumn("Model"));
                        //}
                        //if (chkboxItemCode.Checked == true)
                        //{
                        //    dt.Columns.Add(new DataColumn("ItemCode"));
                        //}
                        
                        
                        

                        if (chkboxStock.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Quantity"));
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("VAT"));
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("NLC"));
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Rate"));
                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("BuyRate"));
                        }
                    }
                    else
                    {
                        if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                FLvlSub = DdlFirstSub.SelectedItem.Text;
                                dt.Columns.Add(new DataColumn(FLvlSub));
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                SLvlSub = DdlSecondSub.SelectedItem.Text;
                                dt.Columns.Add(new DataColumn(SLvlSub));
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                TLvlSub = DdlThirdSub.SelectedItem.Text;
                                dt.Columns.Add(new DataColumn(TLvlSub));
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                FourLvlSub = DdlFourSub.SelectedItem.Text;
                                dt.Columns.Add(new DataColumn(FourLvlSub));
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                                dt.Columns.Add(new DataColumn(FiveLvlSUb));
                            }
                            
                            //if (chkboxCategory.Checked == true)
                            //{
                            //    dt.Columns.Add(new DataColumn("CategoryName"));
                            //}
                            //if (chkboxBrand.Checked == true)
                            //{
                            //    dt.Columns.Add(new DataColumn("Brand"));
                            //}
                            //if (chkboxProduct.Checked == true)
                            //{
                            //    dt.Columns.Add(new DataColumn("ProductName"));
                            //}
                            //if (chkboxModel.Checked == true)
                            //{
                            //    dt.Columns.Add(new DataColumn("Model"));
                            //}
                            //if (chkboxItemCode.Checked == true)
                            //{
                            //    dt.Columns.Add(new DataColumn("ItemCode"));
                            //}

                            if (chkboxStock.Checked == true)
                            {
                                dt.Columns.Add(new DataColumn("Quantity"));
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dt.Columns.Add(new DataColumn("VAT"));
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dt.Columns.Add(new DataColumn("NLC"));
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dt.Columns.Add(new DataColumn("Rate"));
                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dt.Columns.Add(new DataColumn("BuyRate"));
                            }
                        }
                    }
                }
           
            dt.Columns.Add(new DataColumn("SalesValue"));

            DataRow dr_final88 = dt.NewRow();
            dt.Rows.Add(dr_final88);

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                //{
                //    if (DdlFirstSub.SelectedItem.Text != "None")
                //    {
                //        FLvlSub = DdlFirstSub.SelectedItem.Text;
                //    }
                //    if (DdlSecondSub.SelectedItem.Text != "None")
                //    {
                //        SLvlSub = DdlSecondSub.SelectedItem.Text;
                //    }
                //    if (DdlThirdSub.SelectedItem.Text != "None")
                //    {
                //        TLvlSub = DdlThirdSub.SelectedItem.Text;
                //    }
                //    if (DdlFourSub.SelectedItem.Text != "None")
                //    {
                //        FourLvlSub = DdlFourSub.SelectedItem.Text;
                //    }
                //    if (DdlFiveSub.SelectedItem.Text != "None")
                //    {
                //        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                //    }
                //}


                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    dispLastTotal = true;
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total : " + fifLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total :" + frthLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total : " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total : " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }


                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final2 = dt.NewRow();
                    //        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            if (ddlsecondlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                    //            }
                    //        }
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final2["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final2["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final2["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final2["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final2["BuyRate"] = "";
                    //        }


                    //        dr_final2["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final2);
                    //    }
                    //}
                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            if (ddlthirdlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                    //            }
                    //        }
                    //        //else
                    //        //{
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }
                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //        {
                    //            if (ddlfourlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (ddlfirstlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlsecondlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlthirdlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlfourlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                    //                }
                    //                if (ddlfifthlvl.SelectedItem.Text != "None")
                    //                {
                    //                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //                }
                    //            }
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }
                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final111 = dt.NewRow();
                    //        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //        {
                    //            if (ddlfifthlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (ddlfirstlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlsecondlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlthirdlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlfourlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                    //                }

                    //                if (ddlfifthlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                    //                }

                    //            }
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final111["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final111["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final111["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final111["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final111["BuyRate"] = "";
                    //        }
                    //        dr_final111["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final111);
                    //    }
                    //}

                    if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                    {
                        DataRow dr_final111 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final111["Quantity"] = dr["Stock"];
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final111["VAT"] = dr["VAT"];
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final111["NLC"] = dr["NLC"];
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final111["Rate"] = dr["Rate"];

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final111["BuyRate"] = dr["BuyRate"];
                        }
                        dr_final111["SalesValue"] = dr["SalesValue"];
                        dt.Rows.Add(dr_final111);
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    //dt.Rows.Add(dr_final5);

                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxAll.Checked == true)
                    {
                        //if (DdlFirstSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFirstSub.SelectedItem.Text == "Brand")
                        //    {
                        //        fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlSecondSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlSecondSub.SelectedItem.Text == "Brand")
                        //    {
                        //        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}

                        //if (DdlThirdSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlThirdSub.SelectedItem.Text == "Brand")
                        //    {
                        //        tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlFourSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFourSub.SelectedItem.Text == "Brand")
                        //    {
                        //        frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlFiveSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFiveSub.SelectedItem.Text == "Brand")
                        //    {
                        //        fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}



                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFiveSub.SelectedItem.Text == "Brand")
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        else if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }
                        }
                        else if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                frthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                frthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                        }
                        else if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName"))
                            {
                                tLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model"))
                            {
                                tLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand"))
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName"))
                            {
                                tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode"))
                            {
                                tLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                frthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                frthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                        }
                        else if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }

                            if (FLvlSub == "CategoryName")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }
                            else if (FLvlSub == "Model")
                            {
                                sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();

                            }
                            else if (FLvlSub == "Brand")
                            {
                                sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                tLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                                
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();

                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();

                            }

                        }




                        //if (chkboxCategory.Checked == true)
                        //{
                        //    fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxBrand.Checked == true)
                        //{
                        //    sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxProduct.Checked == true)
                        //{
                        //    tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxModel.Checked == true)
                        //{
                        //    frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxItemCode.Checked == true)
                        //{
                        //    fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        //}
                    }
                    else
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }

                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if (DdlFiveSub.SelectedItem.Text == "Brand")
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }

                        //if (chkboxCategory.Checked == true)
                        //{
                        //    fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxBrand.Checked == true)
                        //{
                        //    sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxProduct.Checked == true)
                        //{
                        //    tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxModel.Checked == true)
                        //{
                        //    frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        //}
                        //if (chkboxItemCode.Checked == true)
                        //{
                        //    fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        //}
                    }


                    dispLastTotal = true;

                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                 (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                 (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                                 (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                            {
                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);

                                DataRow dr_final17 = dt.NewRow();

                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final17["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final17["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final17["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final17["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final17["BuyRate"] = "";
                                }

                                //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                                if (FiveLvlSUb == "CategoryName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FiveLvlSUb == "Brand")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FiveLvlSUb == "ProductName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FiveLvlSUb == "Model")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FiveLvlSUb == "ItemCode")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final17);

                                //DataRow dr_final8888 = dt.NewRow();
                                //dt.Rows.Add(dr_final8888);
                            }
                        }

                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                            {

                                DataRow dr_final86 = dt.NewRow();
                                dt.Rows.Add(dr_final86);

                                DataRow dr_final7 = dt.NewRow();

                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final7["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final7["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final7["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final7["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final7["BuyRate"] = "";
                                }

                                //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                                if (FourLvlSub == "CategoryName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FourLvlSub == "Brand")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FourLvlSub == "ProductName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FourLvlSub == "Model")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FourLvlSub == "ItemCode")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final7);

                                if (DdlFiveSub.SelectedItem.Text == "None")
                                {
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                }
                                else
                                {
                                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                    (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                    (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                                    {
                                    }
                                    else
                                    {
                                        DataRow dr_final888 = dt.NewRow();
                                        dt.Rows.Add(dr_final888);
                                    }
                                }

                             }
                        }


                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                            {
                                
                                if ((DdlFourSub.SelectedItem.Text == "None") && (DdlFiveSub.SelectedItem.Text == "None"))
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }
                                else if (DdlFiveSub.SelectedItem.Text == "None")
                                {
                                }
                                else
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }

                                DataRow dr_final8 = dt.NewRow();

                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                                if (TLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (TLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (TLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (TLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (TLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);

                                if ((DdlFourSub.SelectedItem.Text == "None") || (DdlFiveSub.SelectedItem.Text == "None"))
                                {
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                }
                                else
                                {
                                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                   (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                                    {
                                    }
                                    else
                                    {
                                        DataRow dr_final889 = dt.NewRow();
                                        dt.Rows.Add(dr_final889);
                                    }
                                }
                            }
                        }

                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                   (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (DdlThirdSub.SelectedItem.Text == "None")
                                {
                                    DataRow dr_final889 = dt.NewRow();
                                    dt.Rows.Add(dr_final889);
                                }
                                else if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }
                                else
                                {
                                }
                                


                                DataRow dr_final8 = dt.NewRow();
                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                                if (SLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (SLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (SLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (SLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (SLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);


                                if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                                {
                                    
                                }
                                
                                else
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }

                            }
                        }

                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                            {
                                DataRow dr_final889 = dt.NewRow();
                                dt.Rows.Add(dr_final889);

                                DataRow dr_final8 = dt.NewRow();
                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                } if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";
                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                if (FLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);

                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);
                            }
                        }
                    }

                    else
                    {
                        //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        //{
                        //    if ((chkboxItemCode.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
                        //    {
                        //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        //             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                        //             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                        //             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                        //             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        //        {
                        //            DataRow dr_final17 = dt.NewRow();
                        //            if (chkboxCategory.Checked == true)
                        //            {
                        //                dr_final17["CategoryName"] = "";
                        //            }
                        //            if (chkboxBrand.Checked == true)
                        //            {
                        //                dr_final17["Brand"] = "";
                        //            }
                        //            if (chkboxProduct.Checked == true)
                        //            {
                        //                dr_final17["ProductName"] = "";
                        //            }
                        //            if (chkboxModel.Checked == true)
                        //            {
                        //                dr_final17["Model"] = "";
                        //            }
                        //            if (chkboxItemCode.Checked == true)
                        //            {
                        //                dr_final17["ItemCode"] = "Total :" + fifLvlValue;
                        //            }
                        //            if (chkboxStock.Checked == true)
                        //            {
                        //                dr_final17["Quantity"] = "";
                        //            }
                        //            if (chkboxVat.Checked == true)
                        //            {
                        //                dr_final17["VAT"] = "";
                        //            }
                        //            if (chkboxNlc.Checked == true)
                        //            {
                        //                dr_final17["NLC"] = "";
                        //            }
                        //            if (chkboxRate.Checked == true)
                        //            {
                        //                dr_final17["Rate"] = "";

                        //            }
                        //            if (chkboxBuyrate.Checked == true)
                        //            {
                        //                dr_final17["BuyRate"] = "";
                        //            }

                        //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        //            dt.Rows.Add(dr_final17);
                        //            Ittls = 0;
                        //        }
                        //    }
                        //}
                        //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        //{
                        //    if ((chkboxModel.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
                        //    {
                        //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        //            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                        //            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                        //            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        //        {
                        //            DataRow dr_final7 = dt.NewRow();
                        //            if (chkboxCategory.Checked == true)
                        //            {
                        //                dr_final7["CategoryName"] = "";
                        //            }
                        //            if (chkboxBrand.Checked == true)
                        //            {
                        //                dr_final7["Brand"] = "";
                        //            }
                        //            if (chkboxProduct.Checked == true)
                        //            {
                        //                dr_final7["ProductName"] = "";
                        //            }
                        //            if (chkboxModel.Checked == true)
                        //            {
                        //                dr_final7["Model"] = "Total :" + frthLvlValue;
                        //            }
                        //            if (chkboxItemCode.Checked == true)
                        //            {
                        //                dr_final7["ItemCode"] = "";
                        //            }

                        //            if (chkboxStock.Checked == true)
                        //            {
                        //                dr_final7["Quantity"] = "";
                        //            }
                        //            if (chkboxVat.Checked == true)
                        //            {
                        //                dr_final7["VAT"] = "";
                        //            }
                        //            if (chkboxNlc.Checked == true)
                        //            {
                        //                dr_final7["NLC"] = "";
                        //            }
                        //            if (chkboxRate.Checked == true)
                        //            {
                        //                dr_final7["Rate"] = "";

                        //            }
                        //            if (chkboxBuyrate.Checked == true)
                        //            {
                        //                dr_final7["BuyRate"] = "";
                        //            }

                        //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        //            dt.Rows.Add(dr_final7);
                        //            Pttls = 0;
                        //        }
                        //    }
                        //}
                        //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        //{
                        //    if ((chkboxProduct.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
                        //    {
                        //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        //            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                        //            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        //        {
                        //            DataRow dr_final8 = dt.NewRow();
                        //            if (chkboxCategory.Checked == true)
                        //            {
                        //                dr_final8["CategoryName"] = "";
                        //            }
                        //            if (chkboxBrand.Checked == true)
                        //            {
                        //                dr_final8["Brand"] = "";
                        //            }
                        //            if (chkboxProduct.Checked == true)
                        //            {
                        //                dr_final8["ProductName"] = "Total : " + tLvlValue;
                        //            }
                        //            if (chkboxModel.Checked == true)
                        //            {
                        //                dr_final8["Model"] = "";
                        //            }
                        //            if (chkboxItemCode.Checked == true)
                        //            {
                        //                dr_final8["ItemCode"] = "";
                        //            }

                        //            if (chkboxStock.Checked == true)
                        //            {
                        //                dr_final8["Quantity"] = "";
                        //            }
                        //            if (chkboxVat.Checked == true)
                        //            {
                        //                dr_final8["VAT"] = "";
                        //            }
                        //            if (chkboxNlc.Checked == true)
                        //            {
                        //                dr_final8["NLC"] = "";
                        //            }
                        //            if (chkboxRate.Checked == true)
                        //            {
                        //                dr_final8["Rate"] = "";

                        //            }
                        //            if (chkboxBuyrate.Checked == true)
                        //            {
                        //                dr_final8["BuyRate"] = "";
                        //            }

                        //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        //            dt.Rows.Add(dr_final8);
                        //            //dt.Rows.Add(dr_final8);
                        //            modelTotal = 0;
                        //        }
                        //    }
                        //}
                        //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        //{
                        //    if ((chkboxBrand.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
                        //    {
                        //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        //            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        //        {
                        //            DataRow dr_final8 = dt.NewRow();
                        //            if (chkboxCategory.Checked == true)
                        //            {
                        //                dr_final8["CategoryName"] = "";
                        //            }
                        //            if (chkboxBrand.Checked == true)
                        //            {
                        //                dr_final8["Brand"] = "Total : " + sLvlValue;
                        //            }
                        //            if (chkboxProduct.Checked == true)
                        //            {
                        //                dr_final8["ProductName"] = "";
                        //            }
                        //            if (chkboxModel.Checked == true)
                        //            {
                        //                dr_final8["Model"] = "";
                        //            }
                        //            if (chkboxItemCode.Checked == true)
                        //            {
                        //                dr_final8["ItemCode"] = "";
                        //            }

                        //            if (chkboxStock.Checked == true)
                        //            {
                        //                dr_final8["Quantity"] = "";
                        //            }
                        //            if (chkboxVat.Checked == true)
                        //            {
                        //                dr_final8["VAT"] = "";
                        //            }
                        //            if (chkboxNlc.Checked == true)
                        //            {
                        //                dr_final8["NLC"] = "";
                        //            }
                        //            if (chkboxRate.Checked == true)
                        //            {
                        //                dr_final8["Rate"] = "";

                        //            }
                        //            if (chkboxBuyrate.Checked == true)
                        //            {
                        //                dr_final8["BuyRate"] = "";
                        //            }

                        //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        //            dt.Rows.Add(dr_final8);
                        //            brandTotal = 0;
                        //        }
                        //    }
                        //}
                        //if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        //{
                        //    if ((chkboxCategory.Checked == true) && (DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
                        //    {
                        //        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        //        {
                        //            DataRow dr_final8 = dt.NewRow();
                        //            if (chkboxCategory.Checked == true)
                        //            {
                        //                dr_final8["CategoryName"] = "Total : " + fLvlValue;
                        //            }
                        //            if (chkboxBrand.Checked == true)
                        //            {
                        //                dr_final8["Brand"] = "";
                        //            }
                        //            if (chkboxProduct.Checked == true)
                        //            {
                        //                dr_final8["ProductName"] = "";
                        //            }
                        //            if (chkboxModel.Checked == true)
                        //            {
                        //                dr_final8["Model"] = "";
                        //            }
                        //            if (chkboxItemCode.Checked == true)
                        //            {
                        //                dr_final8["ItemCode"] = "";
                        //            }

                        //            if (chkboxStock.Checked == true)
                        //            {
                        //                dr_final8["Quantity"] = "";
                        //            }
                        //            if (chkboxVat.Checked == true)
                        //            {
                        //                dr_final8["VAT"] = "";
                        //            }
                        //            if (chkboxNlc.Checked == true)
                        //            {
                        //                dr_final8["NLC"] = "";
                        //            }
                        //            if (chkboxRate.Checked == true)
                        //            {
                        //                dr_final8["Rate"] = "";

                        //            }
                        //            if (chkboxBuyrate.Checked == true)
                        //            {
                        //                dr_final8["BuyRate"] = "";
                        //            }

                        //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        //            dt.Rows.Add(dr_final8);
                        //            catIDTotal = 0;
                        //        }
                        //    }
                        //}

                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                 (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                 (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                                 (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                            {
                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);

                                DataRow dr_final17 = dt.NewRow();


                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final17["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final17["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final17["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final17["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final17["BuyRate"] = "";
                                }

                                //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                                if (FiveLvlSUb == "CategoryName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FiveLvlSUb == "Brand")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FiveLvlSUb == "ProductName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FiveLvlSUb == "Model")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FiveLvlSUb == "ItemCode")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final17);

                                //DataRow dr_final888 = dt.NewRow();
                                //dt.Rows.Add(dr_final888);
                            }
                        }

                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                            {
                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);

                                DataRow dr_final7 = dt.NewRow();

                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final7["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final7["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final7["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final7["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final7["BuyRate"] = "";
                                }

                                //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                                if (FourLvlSub == "CategoryName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FourLvlSub == "Brand")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FourLvlSub == "ProductName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FourLvlSub == "Model")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FourLvlSub == "ItemCode")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final7);

                                if (DdlFiveSub.SelectedItem.Text == "None")
                                {
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                }
                                else
                                {
                                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                    (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                    (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                                    {
                                    }
                                    else
                                    {
                                        DataRow dr_final8885 = dt.NewRow();
                                        dt.Rows.Add(dr_final8885);
                                    }
                                }
                            }
                        }


                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                            {
                                if ((DdlFourSub.SelectedItem.Text == "None") && (DdlFiveSub.SelectedItem.Text == "None"))
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }
                                else if (DdlFiveSub.SelectedItem.Text == "None")
                                {
                                }
                                else
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }

                                DataRow dr_final8 = dt.NewRow();

                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                                if (TLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (TLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (TLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (TLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (TLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);

                                if ((DdlFourSub.SelectedItem.Text == "None") || (DdlFiveSub.SelectedItem.Text == "None"))
                                {
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                }
                                else
                                {
                                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                   (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                                    {
                                    }
                                    else
                                    {
                                        DataRow dr_final889 = dt.NewRow();
                                        dt.Rows.Add(dr_final889);
                                    }
                                }
                            }
                        }

                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                   (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (DdlThirdSub.SelectedItem.Text == "None")
                                {
                                    DataRow dr_final889 = dt.NewRow();
                                    dt.Rows.Add(dr_final889);
                                }
                                else if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }
                                else
                                {
                                }

                                DataRow dr_final8 = dt.NewRow();
                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                                if (SLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (SLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (SLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (SLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (SLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);

                                if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                                {

                                }
                                else
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }
                            }
                        }

                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                            {
                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);

                                DataRow dr_final8 = dt.NewRow();
                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                } if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";
                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                if (FLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                    catIDTotal = 0;
                                }
                                else if (FLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                    brandTotal = 0;
                                }
                                else if (FLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                    modelTotal = 0;
                                }
                                else if (FLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                    Pttls = 0;
                                }
                                else if (FLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                    Ittls = 0;
                                }
                                dt.Rows.Add(dr_final8);

                                DataRow dr_final8884 = dt.NewRow();
                                dt.Rows.Add(dr_final8884);
                            }
                        }
                    }

                    //if (chkboxCategory.Checked == true)
                    //{
                    //    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = fLvlValueTemp;
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxBrand.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final2 = dt.NewRow();
                    //        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            if (chkboxBrand.Checked == true)
                    //            {
                    //                dr_final2["Brand"] = sLvlValueTemp;
                    //            }
                    //        }
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final2["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final2["Brand"] = sLvlValueTemp;
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final2["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final2["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final2["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final2["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final2["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final2["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final2["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final2["BuyRate"] = "";
                    //        }

                    //        dr_final2["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final2);
                    //    }
                    //}
                    //if (chkboxProduct.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            if (chkboxProduct.Checked == true)
                    //            {
                    //                dr_final1["ProductName"] = tLvlValueTemp;
                    //            }
                    //        }

                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = tLvlValueTemp;
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //        {
                    //            if (chkboxModel.Checked == true)
                    //            {
                    //                dr_final1["Model"] = frthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final1["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final1["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final1["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final1["Model"] = frthLvlValueTemp;
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final1["ItemCode"] = "";
                    //                }
                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }


                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final111 = dt.NewRow();
                    //        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //        {
                    //            if (chkboxItemCode.Checked == true)
                    //            {
                    //                dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final111["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final111["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final111["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final111["Model"] = "";
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //                }

                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final111["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final111["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final111["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final111["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final111["BuyRate"] = "";
                    //        }
                    //        dr_final111["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final111);
                    //    }
                    //}
                    //}


                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    /////////////////
                    if (chkboxAll.Checked == true)
                    {
                        if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        {
                            DataRow dr_final5 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                                //if (DdlFirstSub.SelectedItem.Text != "None")
                                //{
                                    //dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //}
                                //if (DdlSecondSub.SelectedItem.Text != "None")
                                //{
                                    //dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //}
                                //if (DdlThirdSub.SelectedItem.Text != "None")
                                //{
                                    //dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //}
                                //if (DdlFourSub.SelectedItem.Text != "None")
                                //{
                                    //dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                                //}
                                //if (DdlFiveSub.SelectedItem.Text != "None")
                                //{
                                    //dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                                //}





                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                                //frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                                //frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFiveSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                                //fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                                //fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        else if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                                //frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                                //frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                //fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dr_final5["Model"] = dr["Model"];
                                //fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                                //fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }
                        }
                        else if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                                //sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                            }
                            


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                //frthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                dr_final5["Model"] = dr["Model"];
                                //frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                                //frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //frthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                //fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dr_final5["Model"] = dr["Model"];
                                //fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                                //fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                        }
                        else if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                            }
                            else
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                            }
                            else
                            {
                                dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName"))
                            {
                                 dr_final5["CategoryName"] = dr["CategoryName"];
                                //tLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model"))
                            {
                                 dr_final5["Model"] = dr["Model"];
                                //tLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName"))
                            {
                                 dr_final5["ProductName"] = dr["ProductName"];
                                //tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode"))
                            {
                                 dr_final5["ItemCode"] = dr["ItemCode"];
                                //tLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName"))
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                //frthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model"))
                            {
                                dr_final5["Model"] = dr["Model"];
                                //frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName"))
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                                //frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode"))
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //frthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }


                            if ((FLvlSub != "CategoryName") && (SLvlSub != "CategoryName") && (TLvlSub != "CategoryName") && (FourLvlSub != "CategoryName"))
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                //fifthLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Model") && (SLvlSub != "Model") && (TLvlSub != "Model") && (FourLvlSub != "Model"))
                            {
                                dr_final5["Model"] = dr["Model"];
                                //fifthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "Brand") && (SLvlSub != "Brand") && (TLvlSub != "Brand") && (FourLvlSub != "Brand"))
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                //fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ProductName") && (SLvlSub != "ProductName") && (TLvlSub != "ProductName") && (FourLvlSub != "ProductName"))
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                                //fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                            }
                            else if ((FLvlSub != "ItemCode") && (SLvlSub != "ItemCode") && (TLvlSub != "ItemCode") && (FourLvlSub != "ItemCode"))
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }

                        }
                        else if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                                //fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (FLvlSub == "CategoryName")
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                                dr_final5["ProductName"] = dr["ProductName"];
                                dr_final5["Model"] = dr["Model"];
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                //tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                //frthLvlValueTemp = dr[""].ToString().ToUpper().Trim();
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                            }
                            else if (FLvlSub == "Model")
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                dr_final5["Brand"] = dr["ProductDesc"];
                                dr_final5["ProductName"] = dr["ProductName"];
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                //frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();

                            }
                            else if (FLvlSub == "Brand")
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                dr_final5["Model"] = dr["Model"];
                                dr_final5["ProductName"] = dr["ProductName"];
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                //tLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                //frthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();

                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                dr_final5["Brand"] = dr["ProductDesc"];
                                dr_final5["Model"] = dr["Model"];
                                dr_final5["ItemCode"] = dr["ItemCode"];
                                //sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                //frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                //fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();

                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                                dr_final5["Brand"] = dr["ProductDesc"];
                                dr_final5["Model"] = dr["Model"];
                                dr_final5["ProductName"] = dr["ProductName"];
                                //sLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                                //tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                                //frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                                //fifthLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();

                            }
                        }
                            //if (chkboxCategory.Checked == true)
                            //{
                            //    dr_final5["CategoryName"] = dr["CategoryName"];
                            //}

                            //if (chkboxBrand.Checked == true)
                            //{
                            //    dr_final5["Brand"] = dr["ProductDesc"];
                            //}
                            //if (chkboxProduct.Checked == true)
                            //{
                            //    dr_final5["ProductName"] = dr["ProductName"];
                            //}
                            //if (chkboxModel.Checked == true)
                            //{
                            //    dr_final5["Model"] = dr["Model"];
                            //}
                            //if (chkboxItemCode.Checked == true)
                            //{
                            //    dr_final5["ItemCode"] = dr["ItemCode"];
                            //}

                            if (chkboxStock.Checked == true)
                            {
                                dr_final5["Quantity"] = dr["Stock"];
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final5["VAT"] = dr["VAT"];
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final5["NLC"] = dr["NLC"];
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final5["Rate"] = dr["Rate"];

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final5["BuyRate"] = dr["BuyRate"];
                            }
                            dr_final5["SalesValue"] = dr["SalesValue"];

                            dt.Rows.Add(dr_final5);
                        }
                    }
                    else
                    {
                        DataRow dr_final5 = dt.NewRow();

                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                        }
                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                        }

                        //if (chkboxCategory.Checked == true)
                        //{
                        //    dr_final5["CategoryName"] = dr["CategoryName"];
                        //}

                        //if (chkboxBrand.Checked == true)
                        //{
                        //    dr_final5["Brand"] = dr["ProductDesc"];
                        //}
                        //if (chkboxProduct.Checked == true)
                        //{
                        //    dr_final5["ProductName"] = dr["ProductName"];
                        //}
                        //if (chkboxModel.Checked == true)
                        //{
                        //    dr_final5["Model"] = dr["Model"];
                        //}
                        //if (chkboxItemCode.Checked == true)
                        //{
                        //    dr_final5["ItemCode"] = dr["ItemCode"];
                        //}

                        if (chkboxStock.Checked == true)
                        {
                            dr_final5["Quantity"] = dr["Stock"];
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final5["VAT"] = dr["VAT"];
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final5["NLC"] = dr["NLC"];
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final5["Rate"] = dr["Rate"];

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final5["BuyRate"] = dr["BuyRate"];
                        }
                        dr_final5["SalesValue"] = dr["SalesValue"];

                        dt.Rows.Add(dr_final5);
                    }

                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                }
            }


            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if (((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None")) && ((ddlfirstlvl.SelectedItem.Text == "None") && (ddlsecondlvl.SelectedItem.Text == "None") && (ddlthirdlvl.SelectedItem.Text == "None") && (ddlfourlvl.SelectedItem.Text == "None") && (ddlfifthlvl.SelectedItem.Text == "None")))
                {
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final888 = dt.NewRow();
                            dt.Rows.Add(dr_final888);

                            DataRow dr_final17 = dt.NewRow();


                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            if (FiveLvlSUb == "CategoryName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FiveLvlSUb == "Brand")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FiveLvlSUb == "ProductName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FiveLvlSUb == "Model")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FiveLvlSUb == "ItemCode")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }



                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final8881 = dt.NewRow();
                            dt.Rows.Add(dr_final8881);

                            DataRow dr_final7 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            if (FourLvlSub == "CategoryName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FourLvlSub == "Brand")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FourLvlSub == "ProductName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FourLvlSub == "Model")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FourLvlSub == "ItemCode")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final7);

                            
                                DataRow dr_final887 = dt.NewRow();
                                dt.Rows.Add(dr_final887);
                            

                            Pttls = 0;
                        }



                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {

                            

                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            if (TLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (TLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (TLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (TLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (TLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final8);

                            
                                DataRow dr_final887 = dt.NewRow();
                                dt.Rows.Add(dr_final887);
                            

                            modelTotal = 0;
                        }

                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                           

                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (SLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (SLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (SLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (SLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (SLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }

                            dt.Rows.Add(dr_final8);

                           
                                DataRow dr_final888 = dt.NewRow();
                                dt.Rows.Add(dr_final888);
                            
                            brandTotal = 0;
                        }




                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            
                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            } if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (FLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final8);

                            
                            catIDTotal = 0;
                        }

                    }
                    else
                    {

                        if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                        {
                            //if ((chkboxItemCode.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
                            //{
                            //    DataRow dr_final17 = dt.NewRow();
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final17["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final17["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final17["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final17["Model"] = "";
                            //    }
                            //    dr_final17["ItemCode"] = "Total :" + fifthLvlValueTemp;

                            //    if (chkboxStock.Checked == true)
                            //    {
                            //        dr_final17["Quantity"] = "";
                            //    }
                            //    if (chkboxVat.Checked == true)
                            //    {
                            //        dr_final17["VAT"] = "";
                            //    }
                            //    if (chkboxNlc.Checked == true)
                            //    {
                            //        dr_final17["NLC"] = "";
                            //    }
                            //    if (chkboxRate.Checked == true)
                            //    {
                            //        dr_final17["Rate"] = "";

                            //    }
                            //    if (chkboxBuyrate.Checked == true)
                            //    {
                            //        dr_final17["BuyRate"] = "";
                            //    }
                            //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            //    dt.Rows.Add(dr_final17);
                            //    Ittls = 0;
                            //}

                            //if ((chkboxModel.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
                            //{
                            //    DataRow dr_final7 = dt.NewRow();
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final7["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final7["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final7["ProductName"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final7["ItemCode"] = "";
                            //    }

                            //    dr_final7["Model"] = "Total :" + frthLvlValueTemp;

                            //    if (chkboxStock.Checked == true)
                            //    {
                            //        dr_final7["Quantity"] = "";
                            //    }
                            //    if (chkboxVat.Checked == true)
                            //    {
                            //        dr_final7["VAT"] = "";
                            //    }
                            //    if (chkboxNlc.Checked == true)
                            //    {
                            //        dr_final7["NLC"] = "";
                            //    }
                            //    if (chkboxRate.Checked == true)
                            //    {
                            //        dr_final7["Rate"] = "";

                            //    }
                            //    if (chkboxBuyrate.Checked == true)
                            //    {
                            //        dr_final7["BuyRate"] = "";
                            //    }

                            //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            //    dt.Rows.Add(dr_final7);
                            //    Pttls = 0;
                            //}

                            //if ((chkboxProduct.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
                            //{
                            //    DataRow dr_final8 = dt.NewRow();
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    dr_final8["ProductName"] = "Total :" + tLvlValueTemp;

                            //    if (chkboxStock.Checked == true)
                            //    {
                            //        dr_final8["Quantity"] = "";
                            //    }
                            //    if (chkboxVat.Checked == true)
                            //    {
                            //        dr_final8["VAT"] = "";
                            //    }
                            //    if (chkboxNlc.Checked == true)
                            //    {
                            //        dr_final8["NLC"] = "";
                            //    }
                            //    if (chkboxRate.Checked == true)
                            //    {
                            //        dr_final8["Rate"] = "";

                            //    }
                            //    if (chkboxBuyrate.Checked == true)
                            //    {
                            //        dr_final8["BuyRate"] = "";
                            //    }
                            //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            //    dt.Rows.Add(dr_final8);
                            //    modelTotal = 0;
                            //}

                            //if ((chkboxBrand.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
                            //{
                            //    DataRow dr_final9 = dt.NewRow();
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final9["CategoryName"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final9["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final9["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final9["ItemCode"] = "";
                            //    }
                            //    dr_final9["Brand"] = "Total :" + sLvlValueTemp;

                            //    if (chkboxStock.Checked == true)
                            //    {
                            //        dr_final9["Quantity"] = "";
                            //    }
                            //    if (chkboxVat.Checked == true)
                            //    {
                            //        dr_final9["VAT"] = "";
                            //    }
                            //    if (chkboxNlc.Checked == true)
                            //    {
                            //        dr_final9["NLC"] = "";
                            //    }
                            //    if (chkboxRate.Checked == true)
                            //    {
                            //        dr_final9["Rate"] = "";

                            //    }
                            //    if (chkboxBuyrate.Checked == true)
                            //    {
                            //        dr_final9["BuyRate"] = "";
                            //    }
                            //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            //    dt.Rows.Add(dr_final9);
                            //    brandTotal = 0;

                            //}

                            //if ((chkboxCategory.Checked == true) && (DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
                            //{
                            //    DataRow dr_final10 = dt.NewRow();
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final10["CategoryName"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final10["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final10["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final10["ItemCode"] = "";
                            //    }
                            //    dr_final10["CategoryName"] = "Total :" + fLvlValueTemp;

                            //    if (chkboxStock.Checked == true)
                            //    {
                            //        dr_final10["Quantity"] = "";
                            //    }
                            //    if (chkboxVat.Checked == true)
                            //    {
                            //        dr_final10["VAT"] = "";
                            //    }
                            //    if (chkboxNlc.Checked == true)
                            //    {
                            //        dr_final10["NLC"] = "";
                            //    }
                            //    if (chkboxRate.Checked == true)
                            //    {
                            //        dr_final10["Rate"] = "";

                            //    }
                            //    if (chkboxBuyrate.Checked == true)
                            //    {
                            //        dr_final10["BuyRate"] = "";
                            //    }
                            //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            //    dt.Rows.Add(dr_final10);
                            //    catIDTotal = 0;
                            //}
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                DataRow dr_final8882 = dt.NewRow();
                                dt.Rows.Add(dr_final8882);

                                DataRow dr_final17 = dt.NewRow();


                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final17["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final17["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final17["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final17["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final17["BuyRate"] = "";
                                }
                                if (FiveLvlSUb == "CategoryName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                }
                                else if (FiveLvlSUb == "Brand")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                }
                                else if (FiveLvlSUb == "ProductName")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                }
                                else if (FiveLvlSUb == "Model")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                }
                                else if (FiveLvlSUb == "ItemCode")
                                {
                                    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                }
                                dt.Rows.Add(dr_final17);
                                Ittls = 0;
                            }



                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                DataRow dr_final8883 = dt.NewRow();
                                dt.Rows.Add(dr_final8883);

                                DataRow dr_final7 = dt.NewRow();
                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final7["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final7["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final7["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final7["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final7["BuyRate"] = "";
                                }
                                if (FourLvlSub == "CategoryName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                }
                                else if (FourLvlSub == "Brand")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                }
                                else if (FourLvlSub == "ProductName")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                }
                                else if (FourLvlSub == "Model")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                }
                                else if (FourLvlSub == "ItemCode")
                                {
                                    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                }
                                dt.Rows.Add(dr_final7);

                                
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                

                                Pttls = 0;
                            }



                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                

                                DataRow dr_final8 = dt.NewRow();

                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }
                                if (TLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                }
                                else if (TLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                }
                                else if (TLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                }
                                else if (TLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                }
                                else if (TLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                }
                                dt.Rows.Add(dr_final8);

                                
                                    DataRow dr_final887 = dt.NewRow();
                                    dt.Rows.Add(dr_final887);
                                

                                modelTotal = 0;
                            }

                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                

                                DataRow dr_final8 = dt.NewRow();

                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                }
                                if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                if (SLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                }
                                else if (SLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                }
                                else if (SLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                }
                                else if (SLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                }
                                else if (SLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                }

                                dt.Rows.Add(dr_final8);

                                if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                                {

                                }
                                else
                                {
                                    DataRow dr_final888 = dt.NewRow();
                                    dt.Rows.Add(dr_final888);
                                }

                                brandTotal = 0;
                            }




                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                

                                DataRow dr_final8 = dt.NewRow();

                                //if (chkboxAll.Checked == true)
                                //{
                                if (DdlFirstSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                                }
                                if (DdlSecondSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                                }
                                if (DdlThirdSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                                } if (DdlFourSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFourSub.SelectedItem.Text] = "";
                                }
                                if (DdlFiveSub.SelectedItem.Text != "None")
                                {
                                    dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                if (FLvlSub == "CategoryName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                }
                                else if (FLvlSub == "Brand")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                }
                                else if (FLvlSub == "ProductName")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                }
                                else if (FLvlSub == "Model")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                }
                                else if (FLvlSub == "ItemCode")
                                {
                                    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                }
                                dt.Rows.Add(dr_final8);

                                
                                catIDTotal = 0;
                            }
                        }
                    }

                    //}

                    DataRow dr_final8886 = dt.NewRow();
                    dt.Rows.Add(dr_final8886);

                    DataRow dr_final6 = dt.NewRow();
                    //if (chkboxAll.Checked == true)
                    //{
                    //    if (DdlFirstSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFirstSub.SelectedItem.Text] = "Grand Total: ";
                    //    }
                    //    if (DdlSecondSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlSecondSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlThirdSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlThirdSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlFourSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFourSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlFiveSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFiveSub.SelectedItem.Text] = "";
                    //    }
                    //}
                    //else
                    //{
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final6["CategoryName"] = "Grand Total: ";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                           if (chkboxCategory.Checked == false)
                            {
                                dr_final6["Brand"] = "Grand Total: ";
                            }
                            else
                            {
                               dr_final6["Brand"] = "";
                            }
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked==false))
                            {
                                dr_final6["ProductName"] = "Grand Total: ";
                            }
                            else
                            {
                                dr_final6["ProductName"] = "";
                            }
                            
                        }
                        if (chkboxModel.Checked == true)
                        {
                            if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked == false) && (chkboxProduct.Checked==false))
                            {
                                dr_final6["Model"] = "Grand Total: ";
                            }
                            else
                            {
                                dr_final6["Model"] = "";
                            }
                            
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked == false) && (chkboxModel.Checked == false) && (chkboxModel.Checked==false))
                            {
                                dr_final6["ItemCode"] = "Grand Total: ";
                            }
                            else
                            {
                                dr_final6["ItemCode"] = "";
                            }
                            
                        }
                    //}
                        if (chkboxStock.Checked == true)
                        {
                            dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final6["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final6["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final6["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final6["BuyRate"] = "";
                        }
                        dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    
                    dt.Rows.Add(dr_final6);
                    }
                

                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }

    public void BindDataSubTotNew3(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        string FLvlSub = "", SLvlSub = "", TLvlSub = "", FourLvlSub = "", FiveLvlSUb = "";
        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if (((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None")) && ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None")))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
            {
                if (chkboxAll.Checked == true)
                {
                    //if (DdlFiveSub.SelectedItem.Text != "None")
                    //{
                    //    FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FiveLvlSUb));
                    //    FourLvlSub = DdlFourSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FourLvlSub));
                    //    TLvlSub = DdlThirdSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(TLvlSub));
                    //    SLvlSub = DdlSecondSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(SLvlSub));
                    //    FLvlSub = DdlFirstSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FLvlSub));
                    //}
                    //else if (DdlFourSub.SelectedItem.Text != "None")
                    //{
                    //    FourLvlSub = DdlFourSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FourLvlSub));
                    //    TLvlSub = DdlThirdSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(TLvlSub));
                    //    SLvlSub = DdlSecondSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(SLvlSub));
                    //    FLvlSub = DdlFirstSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FLvlSub));
                    //}
                    //else if (DdlThirdSub.SelectedItem.Text != "None")
                    //{
                    //    TLvlSub = DdlThirdSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(TLvlSub));
                    //    SLvlSub = DdlSecondSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(SLvlSub));
                    //    FLvlSub = DdlFirstSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FLvlSub));
                    //}
                    //else if (DdlSecondSub.SelectedItem.Text != "None")
                    //{
                    //    SLvlSub = DdlSecondSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(SLvlSub));
                    //    FLvlSub = DdlFirstSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FLvlSub));
                    //}
                    //else if (DdlFirstSub.SelectedItem.Text != "None")
                    //{
                    //    FLvlSub = DdlFirstSub.SelectedItem.Text;
                    //    dt.Columns.Add(new DataColumn(FLvlSub));

                    //}

                    if (chkboxCategory.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("CategoryName"));
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Brand"));
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("ProductName"));
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Model"));
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("ItemCode"));
                    }




                    if (chkboxStock.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Quantity"));
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("VAT"));
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("NLC"));
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Rate"));
                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("BuyRate"));
                    }
                }
                else
                {
                    if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("CategoryName"));
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Brand"));
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ProductName"));
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Model"));
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ItemCode"));
                        }

                        if (chkboxStock.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Quantity"));
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("VAT"));
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("NLC"));
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Rate"));
                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("BuyRate"));
                        }
                    }
                }
            }

            dt.Columns.Add(new DataColumn("SalesValue"));

            DataRow dr_final88 = dt.NewRow();
            dt.Rows.Add(dr_final88);

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                    }
                }


                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    dispLastTotal = true;
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total : " + fifLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total :" + frthLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total : " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total : " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    //if (ddlfirstlvl.SelectedItem.Text != "None")
                    //{
                    //    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }


                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlsecondlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final2 = dt.NewRow();
                    //        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            if (ddlsecondlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                    //            }
                    //        }
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final2["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final2["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final2["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final2["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final2["BuyRate"] = "";
                    //        }


                    //        dr_final2["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final2);
                    //    }
                    //}
                    //if (ddlthirdlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            if (ddlthirdlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                    //            }
                    //        }
                    //        //else
                    //        //{
                    //        if (ddlfirstlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlsecondlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlthirdlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                    //        }
                    //        if (ddlfourlvl.SelectedItem.Text != "None")
                    //        {
                    //            dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (ddlfifthlvl.SelectedItem.Text != "None")
                    //        {
                    //            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //            dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }
                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlfourlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //        {
                    //            if (ddlfourlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (ddlfirstlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlsecondlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlthirdlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlfourlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                    //                }
                    //                if (ddlfifthlvl.SelectedItem.Text != "None")
                    //                {
                    //                    //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                    //                    dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                    //                }
                    //            }
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }
                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (ddlfifthlvl.SelectedItem.Text != "None")
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final111 = dt.NewRow();
                    //        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //        {
                    //            if (ddlfifthlvl.SelectedItem.Text != "None")
                    //            {
                    //                dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (ddlfirstlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlsecondlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlthirdlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                    //                }
                    //                if (ddlfourlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                    //                }

                    //                if (ddlfifthlvl.SelectedItem.Text != "None")
                    //                {
                    //                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                    //                }

                    //            }
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final111["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final111["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final111["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final111["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final111["BuyRate"] = "";
                    //        }
                    //        dr_final111["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final111);
                    //    }
                    //}

                    if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                    {
                        DataRow dr_final111 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final111["Quantity"] = dr["Stock"];
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final111["VAT"] = dr["VAT"];
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final111["NLC"] = dr["NLC"];
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final111["Rate"] = dr["Rate"];

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final111["BuyRate"] = dr["BuyRate"];
                        }
                        dr_final111["SalesValue"] = dr["SalesValue"];
                        dt.Rows.Add(dr_final111);
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    //dt.Rows.Add(dr_final5);

                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxAll.Checked == true)
                    {
                        //if (DdlFirstSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFirstSub.SelectedItem.Text == "Brand")
                        //    {
                        //        fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlSecondSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlSecondSub.SelectedItem.Text == "Brand")
                        //    {
                        //        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}

                        //if (DdlThirdSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlThirdSub.SelectedItem.Text == "Brand")
                        //    {
                        //        tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlFourSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFourSub.SelectedItem.Text == "Brand")
                        //    {
                        //        frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        //if (DdlFiveSub.SelectedItem.Text != "None")
                        //{
                        //    if (DdlFiveSub.SelectedItem.Text == "Brand")
                        //    {
                        //        fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        //    }
                        //    else
                        //    {
                        //        fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                        //    }
                        //}
                        if (chkboxCategory.Checked == true)
                        {
                            fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxModel.Checked == true)
                        {
                            frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        }
                    }
                    else
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxModel.Checked == true)
                        {
                            frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        }
                    }


                    dispLastTotal = true;

                    //if (chkboxAll.Checked == false)
                    //{
                    //    if (DdlFiveSub.SelectedItem.Text != "None")
                    //    {
                    //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                    //             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                    //        {
                    //            DataRow dr_final17 = dt.NewRow();


                    //            if (DdlFirstSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlSecondSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlThirdSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFourSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFiveSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                    //            }

                    //            if (chkboxStock.Checked == true)
                    //            {
                    //                dr_final17["Quantity"] = "";
                    //            }
                    //            if (chkboxVat.Checked == true)
                    //            {
                    //                dr_final17["VAT"] = "";
                    //            }
                    //            if (chkboxNlc.Checked == true)
                    //            {
                    //                dr_final17["NLC"] = "";
                    //            }
                    //            if (chkboxRate.Checked == true)
                    //            {
                    //                dr_final17["Rate"] = "";

                    //            }
                    //            if (chkboxBuyrate.Checked == true)
                    //            {
                    //                dr_final17["BuyRate"] = "";
                    //            }

                    //            //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                    //            if (FiveLvlSUb == "CategoryName")
                    //            {
                    //                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //                catIDTotal = 0;
                    //            }
                    //            else if (FiveLvlSUb == "Brand")
                    //            {
                    //                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //                brandTotal = 0;
                    //            }
                    //            else if (FiveLvlSUb == "ProductName")
                    //            {
                    //                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //                modelTotal = 0;
                    //            }
                    //            else if (FiveLvlSUb == "Model")
                    //            {
                    //                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //                Pttls = 0;
                    //            }
                    //            else if (FiveLvlSUb == "ItemCode")
                    //            {
                    //                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //                Ittls = 0;
                    //            }
                    //            dt.Rows.Add(dr_final17);
                    //        }
                    //    }

                    //    if (DdlFourSub.SelectedItem.Text != "None")
                    //    {
                    //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                    //            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                    //        {
                    //            DataRow dr_final7 = dt.NewRow();

                    //            if (DdlFirstSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlSecondSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlThirdSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFourSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                    //            }
                    //            if (DdlFiveSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                    //            }

                    //            if (chkboxStock.Checked == true)
                    //            {
                    //                dr_final7["Quantity"] = "";
                    //            }
                    //            if (chkboxVat.Checked == true)
                    //            {
                    //                dr_final7["VAT"] = "";
                    //            }
                    //            if (chkboxNlc.Checked == true)
                    //            {
                    //                dr_final7["NLC"] = "";
                    //            }
                    //            if (chkboxRate.Checked == true)
                    //            {
                    //                dr_final7["Rate"] = "";

                    //            }
                    //            if (chkboxBuyrate.Checked == true)
                    //            {
                    //                dr_final7["BuyRate"] = "";
                    //            }

                    //            //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                    //            if (FourLvlSub == "CategoryName")
                    //            {
                    //                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //                catIDTotal = 0;
                    //            }
                    //            else if (FourLvlSub == "Brand")
                    //            {
                    //                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //                brandTotal = 0;
                    //            }
                    //            else if (FourLvlSub == "ProductName")
                    //            {
                    //                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //                modelTotal = 0;
                    //            }
                    //            else if (FourLvlSub == "Model")
                    //            {
                    //                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //                Pttls = 0;
                    //            }
                    //            else if (FourLvlSub == "ItemCode")
                    //            {
                    //                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //                Ittls = 0;
                    //            }
                    //            dt.Rows.Add(dr_final7);
                    //        }
                    //    }


                    //    if (DdlThirdSub.SelectedItem.Text != "None")
                    //    {
                    //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                    //            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                    //        {
                    //            DataRow dr_final8 = dt.NewRow();

                    //            if (DdlFirstSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlSecondSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlThirdSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                    //            }
                    //            if (DdlFourSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFiveSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //            }

                    //            if (chkboxStock.Checked == true)
                    //            {
                    //                dr_final8["Quantity"] = "";
                    //            }
                    //            if (chkboxVat.Checked == true)
                    //            {
                    //                dr_final8["VAT"] = "";
                    //            }
                    //            if (chkboxNlc.Checked == true)
                    //            {
                    //                dr_final8["NLC"] = "";
                    //            }
                    //            if (chkboxRate.Checked == true)
                    //            {
                    //                dr_final8["Rate"] = "";

                    //            }
                    //            if (chkboxBuyrate.Checked == true)
                    //            {
                    //                dr_final8["BuyRate"] = "";
                    //            }

                    //            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                    //            if (TLvlSub == "CategoryName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //                catIDTotal = 0;
                    //            }
                    //            else if (TLvlSub == "Brand")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //                brandTotal = 0;
                    //            }
                    //            else if (TLvlSub == "ProductName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //                modelTotal = 0;
                    //            }
                    //            else if (TLvlSub == "Model")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //                Pttls = 0;
                    //            }
                    //            else if (TLvlSub == "ItemCode")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //                Ittls = 0;
                    //            }
                    //            dt.Rows.Add(dr_final8);
                    //        }
                    //    }

                    //    if (DdlSecondSub.SelectedItem.Text != "None")
                    //    {
                    //        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                    //               (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            DataRow dr_final8 = dt.NewRow();
                    //            //if (chkboxAll.Checked == true)
                    //            //{
                    //            if (DdlFirstSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlSecondSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                    //            }
                    //            if (DdlThirdSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFourSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFiveSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //            }

                    //            if (chkboxStock.Checked == true)
                    //            {
                    //                dr_final8["Quantity"] = "";
                    //            }
                    //            if (chkboxVat.Checked == true)
                    //            {
                    //                dr_final8["VAT"] = "";
                    //            }
                    //            if (chkboxNlc.Checked == true)
                    //            {
                    //                dr_final8["NLC"] = "";
                    //            }
                    //            if (chkboxRate.Checked == true)
                    //            {
                    //                dr_final8["Rate"] = "";

                    //            }
                    //            if (chkboxBuyrate.Checked == true)
                    //            {
                    //                dr_final8["BuyRate"] = "";
                    //            }

                    //            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                    //            if (SLvlSub == "CategoryName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //                catIDTotal = 0;
                    //            }
                    //            else if (SLvlSub == "Brand")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //                brandTotal = 0;
                    //            }
                    //            else if (SLvlSub == "ProductName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //                modelTotal = 0;
                    //            }
                    //            else if (SLvlSub == "Model")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //                Pttls = 0;
                    //            }
                    //            else if (SLvlSub == "ItemCode")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //                Ittls = 0;
                    //            }
                    //            dt.Rows.Add(dr_final8);
                    //        }
                    //    }

                    //    if (DdlFirstSub.SelectedItem.Text != "None")
                    //    {
                    //        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            DataRow dr_final8 = dt.NewRow();
                    //            //if (chkboxAll.Checked == true)
                    //            //{
                    //            if (DdlFirstSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                    //            }
                    //            if (DdlSecondSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlThirdSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                    //            } if (DdlFourSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //            }
                    //            if (DdlFiveSub.SelectedItem.Text != "None")
                    //            {
                    //                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //            }

                    //            if (chkboxStock.Checked == true)
                    //            {
                    //                dr_final8["Quantity"] = "";
                    //            }
                    //            if (chkboxVat.Checked == true)
                    //            {
                    //                dr_final8["VAT"] = "";
                    //            }
                    //            if (chkboxNlc.Checked == true)
                    //            {
                    //                dr_final8["NLC"] = "";
                    //            }
                    //            if (chkboxRate.Checked == true)
                    //            {
                    //                dr_final8["Rate"] = "";
                    //            }
                    //            if (chkboxBuyrate.Checked == true)
                    //            {
                    //                dr_final8["BuyRate"] = "";
                    //            }

                    //            if (FLvlSub == "CategoryName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //                catIDTotal = 0;
                    //            }
                    //            else if (FLvlSub == "Brand")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //                brandTotal = 0;
                    //            }
                    //            else if (FLvlSub == "ProductName")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //                modelTotal = 0;
                    //            }
                    //            else if (FLvlSub == "Model")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //                Pttls = 0;
                    //            }
                    //            else if (FLvlSub == "ItemCode")
                    //            {
                    //                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //                Ittls = 0;
                    //            }
                    //            dt.Rows.Add(dr_final8);
                    //        }
                    //    }
                    //}

                    //else
                    //{
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        if ((chkboxItemCode.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                 (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                 (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                 (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                                 (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                            {
                                DataRow dr_final17 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final17["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final17["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final17["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final17["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final17["ItemCode"] = "Total :" + fifLvlValue;
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final17["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final17["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final17["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final17["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final17["BuyRate"] = "";
                                }

                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                dt.Rows.Add(dr_final17);
                                Ittls = 0;
                            }
                        }
                    }
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        if ((chkboxModel.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                                (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                            {
                                DataRow dr_final7 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final7["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final7["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final7["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final7["Model"] = "Total :" + frthLvlValue;
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final7["ItemCode"] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final7["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final7["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final7["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final7["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final7["BuyRate"] = "";
                                }

                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                dt.Rows.Add(dr_final7);
                                Pttls = 0;
                            }
                        }
                    }
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        if ((chkboxProduct.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                                (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                            {
                                DataRow dr_final8 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final8["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final8["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final8["ProductName"] = "Total : " + tLvlValue;
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final8["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final8["ItemCode"] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                dt.Rows.Add(dr_final8);
                                //dt.Rows.Add(dr_final8);
                                modelTotal = 0;
                            }
                        }
                    }
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        if ((chkboxBrand.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
                        {
                            if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                                (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                            {
                                DataRow dr_final8 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final8["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final8["Brand"] = "Total : " + sLvlValue;
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final8["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final8["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final8["ItemCode"] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                dt.Rows.Add(dr_final8);
                                brandTotal = 0;
                            }
                        }
                    }
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        if ((chkboxCategory.Checked == true) && (DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
                        {
                            if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                            {
                                DataRow dr_final8 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final8["CategoryName"] = "Total : " + fLvlValue;
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final8["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final8["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final8["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final8["ItemCode"] = "";
                                }

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }

                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                dt.Rows.Add(dr_final8);
                                catIDTotal = 0;
                            }
                        }
                    }
                    //if (chkboxCategory.Checked == true)
                    //{
                    //    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = fLvlValueTemp;
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxBrand.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final2 = dt.NewRow();
                    //        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            if (chkboxBrand.Checked == true)
                    //            {
                    //                dr_final2["Brand"] = sLvlValueTemp;
                    //            }
                    //        }
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final2["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final2["Brand"] = sLvlValueTemp;
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final2["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final2["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final2["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final2["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final2["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final2["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final2["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final2["BuyRate"] = "";
                    //        }

                    //        dr_final2["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final2);
                    //    }
                    //}
                    //if (chkboxProduct.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            if (chkboxProduct.Checked == true)
                    //            {
                    //                dr_final1["ProductName"] = tLvlValueTemp;
                    //            }
                    //        }

                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = tLvlValueTemp;
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //        {
                    //            if (chkboxModel.Checked == true)
                    //            {
                    //                dr_final1["Model"] = frthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final1["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final1["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final1["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final1["Model"] = frthLvlValueTemp;
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final1["ItemCode"] = "";
                    //                }
                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }


                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final111 = dt.NewRow();
                    //        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //        {
                    //            if (chkboxItemCode.Checked == true)
                    //            {
                    //                dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final111["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final111["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final111["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final111["Model"] = "";
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //                }

                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final111["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final111["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final111["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final111["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final111["BuyRate"] = "";
                    //        }
                    //        dr_final111["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final111);
                    //    }
                    //}
                    //}


                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    /////////////////
                    if (chkboxAll.Checked == true)
                    {
                        if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                        {
                            DataRow dr_final5 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                            //if (DdlFirstSub.SelectedItem.Text != "None")
                            //{
                            //    dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                            //}
                            //if (DdlSecondSub.SelectedItem.Text != "None")
                            //{
                            //    dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                            //}
                            //if (DdlThirdSub.SelectedItem.Text != "None")
                            //{
                            //    dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                            //}
                            //if (DdlFourSub.SelectedItem.Text != "None")
                            //{
                            //    dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                            //}
                            //if (DdlFiveSub.SelectedItem.Text != "None")
                            //{
                            //    dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                            //}

                            if (chkboxCategory.Checked == true)
                            {
                                dr_final5["CategoryName"] = dr["CategoryName"];
                            }

                            if (chkboxBrand.Checked == true)
                            {
                                dr_final5["Brand"] = dr["ProductDesc"];
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final5["ProductName"] = dr["ProductName"];
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final5["Model"] = dr["Model"];
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final5["ItemCode"] = dr["ItemCode"];
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final5["Quantity"] = dr["Stock"];
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final5["VAT"] = dr["VAT"];
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final5["NLC"] = dr["NLC"];
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final5["Rate"] = dr["Rate"];

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final5["BuyRate"] = dr["BuyRate"];
                            }
                            dr_final5["SalesValue"] = dr["SalesValue"];

                            dt.Rows.Add(dr_final5);
                        }
                    }
                    else
                    {
                        DataRow dr_final5 = dt.NewRow();
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final5["CategoryName"] = dr["CategoryName"];
                        }

                        if (chkboxBrand.Checked == true)
                        {
                            dr_final5["Brand"] = dr["ProductDesc"];
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final5["ProductName"] = dr["ProductName"];
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final5["Model"] = dr["Model"];
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final5["ItemCode"] = dr["ItemCode"];
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final5["Quantity"] = dr["Stock"];
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final5["VAT"] = dr["VAT"];
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final5["NLC"] = dr["NLC"];
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final5["Rate"] = dr["Rate"];

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final5["BuyRate"] = dr["BuyRate"];
                        }
                        dr_final5["SalesValue"] = dr["SalesValue"];

                        dt.Rows.Add(dr_final5);
                    }

                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
                }
            }


            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if (((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None")) && ((ddlfirstlvl.SelectedItem.Text == "None") && (ddlsecondlvl.SelectedItem.Text == "None") && (ddlthirdlvl.SelectedItem.Text == "None") && (ddlfourlvl.SelectedItem.Text == "None") && (ddlfifthlvl.SelectedItem.Text == "None")))
                {
                    //if (chkboxAll.Checked == false)
                    //{
                    //    if (DdlFiveSub.SelectedItem.Text != "None")
                    //    {
                    //        DataRow dr_final17 = dt.NewRow();


                    //        if (DdlFirstSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlSecondSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlThirdSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFourSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[DdlFourSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFiveSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final17["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final17["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final17["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final17["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final17["BuyRate"] = "";
                    //        }
                    //        if (FiveLvlSUb == "CategoryName")
                    //        {
                    //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        }
                    //        else if (FiveLvlSUb == "Brand")
                    //        {
                    //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        }
                    //        else if (FiveLvlSUb == "ProductName")
                    //        {
                    //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        }
                    //        else if (FiveLvlSUb == "Model")
                    //        {
                    //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        }
                    //        else if (FiveLvlSUb == "ItemCode")
                    //        {
                    //            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        }
                    //        dt.Rows.Add(dr_final17);
                    //        Ittls = 0;
                    //    }



                    //    if (DdlFourSub.SelectedItem.Text != "None")
                    //    {
                    //        DataRow dr_final7 = dt.NewRow();
                    //        //if (chkboxAll.Checked == true)
                    //        //{
                    //        if (DdlFirstSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlSecondSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlThirdSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFourSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                    //        }
                    //        if (DdlFiveSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final7["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final7["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final7["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final7["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final7["BuyRate"] = "";
                    //        }
                    //        if (FourLvlSub == "CategoryName")
                    //        {
                    //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        }
                    //        else if (FourLvlSub == "Brand")
                    //        {
                    //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        }
                    //        else if (FourLvlSub == "ProductName")
                    //        {
                    //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        }
                    //        else if (FourLvlSub == "Model")
                    //        {
                    //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        }
                    //        else if (FourLvlSub == "ItemCode")
                    //        {
                    //            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        }
                    //        dt.Rows.Add(dr_final7);
                    //        Pttls = 0;
                    //    }



                    //    if (DdlThirdSub.SelectedItem.Text != "None")
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();

                    //        //if (chkboxAll.Checked == true)
                    //        //{
                    //        if (DdlFirstSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlSecondSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlThirdSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                    //        }
                    //        if (DdlFourSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFiveSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }
                    //        if (TLvlSub == "CategoryName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        }
                    //        else if (TLvlSub == "Brand")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        }
                    //        else if (TLvlSub == "ProductName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        }
                    //        else if (TLvlSub == "Model")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        }
                    //        else if (TLvlSub == "ItemCode")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        }
                    //        dt.Rows.Add(dr_final8);
                    //        modelTotal = 0;
                    //    }

                    //    if (DdlSecondSub.SelectedItem.Text != "None")
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();

                    //        //if (chkboxAll.Checked == true)
                    //        //{
                    //        if (DdlFirstSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlSecondSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                    //        }
                    //        if (DdlThirdSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFourSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFiveSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }

                    //        if (SLvlSub == "CategoryName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        }
                    //        else if (SLvlSub == "Brand")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        }
                    //        else if (SLvlSub == "ProductName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        }
                    //        else if (SLvlSub == "Model")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        }
                    //        else if (SLvlSub == "ItemCode")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        }

                    //        dt.Rows.Add(dr_final8);
                    //        brandTotal = 0;
                    //    }




                    //    if (DdlFirstSub.SelectedItem.Text != "None")
                    //    {
                    //        DataRow dr_final8 = dt.NewRow();

                    //        //if (chkboxAll.Checked == true)
                    //        //{
                    //        if (DdlFirstSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                    //        }
                    //        if (DdlSecondSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlThirdSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                    //        } if (DdlFourSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFourSub.SelectedItem.Text] = "";
                    //        }
                    //        if (DdlFiveSub.SelectedItem.Text != "None")
                    //        {
                    //            dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final8["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final8["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final8["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final8["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final8["BuyRate"] = "";
                    //        }

                    //        if (FLvlSub == "CategoryName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //        }
                    //        else if (FLvlSub == "Brand")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //        }
                    //        else if (FLvlSub == "ProductName")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //        }
                    //        else if (FLvlSub == "Model")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //        }
                    //        else if (FLvlSub == "ItemCode")
                    //        {
                    //            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //        }
                    //        dt.Rows.Add(dr_final8);
                    //        catIDTotal = 0;
                    //    }

                    //}
                    //else
                    //{

                    if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                    {
                        if ((chkboxItemCode.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            dr_final17["ItemCode"] = "Total :" + fifthLvlValueTemp;

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }

                        if ((chkboxModel.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }

                            dr_final7["Model"] = "Total :" + frthLvlValueTemp;

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }

                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }

                        if ((chkboxProduct.Checked == true) && (DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            dr_final8["ProductName"] = "Total :" + tLvlValueTemp;

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }

                        if ((chkboxBrand.Checked == true) && (DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
                        {
                            DataRow dr_final9 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final9["CategoryName"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final9["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final9["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final9["ItemCode"] = "";
                            }
                            dr_final9["Brand"] = "Total :" + sLvlValueTemp;

                            if (chkboxStock.Checked == true)
                            {
                                dr_final9["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final9["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final9["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final9["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final9["BuyRate"] = "";
                            }
                            dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final9);
                            brandTotal = 0;

                        }

                        if ((chkboxCategory.Checked == true) && (DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
                        {
                            DataRow dr_final10 = dt.NewRow();
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final10["CategoryName"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final10["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final10["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final10["ItemCode"] = "";
                            }
                            dr_final10["CategoryName"] = "Total :" + fLvlValueTemp;

                            if (chkboxStock.Checked == true)
                            {
                                dr_final10["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final10["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final10["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final10["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final10["BuyRate"] = "";
                            }
                            dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final10);
                            catIDTotal = 0;
                        }
                    }
                    //}

                    DataRow dr_final888 = dt.NewRow();
                    dt.Rows.Add(dr_final888);

                    DataRow dr_final6 = dt.NewRow();
                    //if (chkboxAll.Checked == true)
                    //{
                    //    if (DdlFirstSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFirstSub.SelectedItem.Text] = "Grand Total: ";
                    //    }
                    //    if (DdlSecondSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlSecondSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlThirdSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlThirdSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlFourSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFourSub.SelectedItem.Text] = "";
                    //    }
                    //    if (DdlFiveSub.SelectedItem.Text != "None")
                    //    {
                    //        dr_final6[DdlFiveSub.SelectedItem.Text] = "";
                    //    }
                    //}
                    //else
                    //{
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        if (chkboxCategory.Checked == false)
                        {
                            dr_final6["Brand"] = "Grand Total: ";
                        }
                        else
                        {
                            dr_final6["Brand"] = "";
                        }
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked == false))
                        {
                            dr_final6["ProductName"] = "Grand Total: ";
                        }
                        else
                        {
                            dr_final6["ProductName"] = "";
                        }

                    }
                    if (chkboxModel.Checked == true)
                    {
                        if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked == false) && (chkboxProduct.Checked == false))
                        {
                            dr_final6["Model"] = "Grand Total: ";
                        }
                        else
                        {
                            dr_final6["Model"] = "";
                        }

                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        if ((chkboxCategory.Checked == false) && (chkboxBrand.Checked == false) && (chkboxModel.Checked == false) && (chkboxModel.Checked == false))
                        {
                            dr_final6["ItemCode"] = "Grand Total: ";
                        }
                        else
                        {
                            dr_final6["ItemCode"] = "";
                        }

                    }
                    //}
                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);

                    dt.Rows.Add(dr_final6);
                }


                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }

    public void BindDataSubTotNew2(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        string FLvlSub = "", SLvlSub = "", TLvlSub = "", FourLvlSub = "", FiveLvlSUb = "";
        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
            {
                if (chkboxAll.Checked == true)
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FLvlSub));
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(SLvlSub));
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(TLvlSub));
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FourLvlSub));
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FiveLvlSUb));
                    }

                    if (chkboxStock.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Quantity"));
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("VAT"));
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("NLC"));
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Rate"));
                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("BuyRate"));
                    }
                }
                else
                {
                    if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("CategoryName"));
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Brand"));
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ProductName"));
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Model"));
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ItemCode"));
                        }

                        if (chkboxStock.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Quantity"));
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("VAT"));
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("NLC"));
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Rate"));
                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("BuyRate"));
                        }
                    }
                }
            }

            dt.Columns.Add(new DataColumn("SalesValue"));

            DataRow dr_final88 = dt.NewRow();
            dt.Rows.Add(dr_final88);

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                    }
                }


                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                            }
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                }
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }
                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }
                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }

                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if (DdlFiveSub.SelectedItem.Text == "Brand")
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                    }
                    else
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxModel.Checked == true)
                        {
                            frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        }
                    }
                }

                dispLastTotal = true;

                if (chkboxAll.Checked == true)
                {
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();


                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                            }

                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final17["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final17["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final17["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final17["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final17["ItemCode"] = "Total : " + fifLvlValue;
                            //    }
                            //    else
                            //    {
                            //        dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }

                            //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                            if (FiveLvlSUb == "CategoryName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                catIDTotal = 0;
                            }
                            else if (FiveLvlSUb == "Brand")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                brandTotal = 0;
                            }
                            else if (FiveLvlSUb == "ProductName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                modelTotal = 0;
                            }
                            else if (FiveLvlSUb == "Model")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                Pttls = 0;
                            }
                            else if (FiveLvlSUb == "ItemCode")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                Ittls = 0;
                            }
                            dt.Rows.Add(dr_final17);
                        }
                    }

                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();

                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final7["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final7["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final7["ProductName"] = "";
                            //    }

                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final7["ItemCode"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final7["Model"] = "Total : " + frthLvlValue;
                            //    }
                            //    else
                            //    {
                            //        dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }

                            //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                            if (FourLvlSub == "CategoryName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                catIDTotal = 0;
                            }
                            else if (FourLvlSub == "Brand")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                brandTotal = 0;
                            }
                            else if (FourLvlSub == "ProductName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                modelTotal = 0;
                            }
                            else if (FourLvlSub == "Model")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                Pttls = 0;
                            }
                            else if (FourLvlSub == "ItemCode")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                Ittls = 0;
                            }
                            dt.Rows.Add(dr_final7);
                        }
                    }


                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();

                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "";
                            //    }

                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "Total : " + tLvlValue;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                            if (TLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                catIDTotal = 0;
                            }
                            else if (TLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                brandTotal = 0;
                            }
                            else if (TLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                modelTotal = 0;
                            }
                            else if (TLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                Pttls = 0;
                            }
                            else if (TLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                Ittls = 0;
                            }
                            dt.Rows.Add(dr_final8);
                        }
                    }

                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                               (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //    {
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }

                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "Total : " + sLvlValue;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                            if (SLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                catIDTotal = 0;
                            }
                            else if (SLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                brandTotal = 0;
                            }
                            else if (SLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                modelTotal = 0;
                            }
                            else if (SLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                Pttls = 0;
                            }
                            else if (SLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                Ittls = 0;
                            }
                            dt.Rows.Add(dr_final8);
                        }
                    }

                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            } if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{

                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "Total : " + fLvlValue;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";
                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (FLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                catIDTotal = 0;
                            }
                            else if (FLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                brandTotal = 0;
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                modelTotal = 0;
                            }
                            else if (FLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                Pttls = 0;
                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                Ittls = 0;
                            }
                            dt.Rows.Add(dr_final8);
                        }
                    }
                }

                else
                {
                    if (chkboxItemCode.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["ItemCode"] = "Total:" + fifLvlValue;
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }

                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }

                    if (chkboxModel.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total:" + frthLvlValue;
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }

                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (chkboxProduct.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total " + tLvlValue;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total " + sLvlValue;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (chkboxCategory.Checked == true)
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total " + fLvlValue;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    //if (chkboxCategory.Checked == true)
                    //{
                    //    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = fLvlValueTemp;
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxBrand.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //    {
                    //        DataRow dr_final2 = dt.NewRow();
                    //        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //        {
                    //            if (chkboxBrand.Checked == true)
                    //            {
                    //                dr_final2["Brand"] = sLvlValueTemp;
                    //            }
                    //        }
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final2["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final2["Brand"] = sLvlValueTemp;
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final2["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final2["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final2["ItemCode"] = "";
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final2["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final2["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final2["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final2["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final2["BuyRate"] = "";
                    //        }

                    //        dr_final2["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final2);
                    //    }
                    //}
                    //if (chkboxProduct.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //        {
                    //            if (chkboxProduct.Checked == true)
                    //            {
                    //                dr_final1["ProductName"] = tLvlValueTemp;
                    //            }
                    //        }

                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final1["CategoryName"] = "";
                    //        }
                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final1["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final1["ProductName"] = tLvlValueTemp;
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final1["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final1["ItemCode"] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }

                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //    {
                    //        DataRow dr_final1 = dt.NewRow();
                    //        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //        {
                    //            if (chkboxModel.Checked == true)
                    //            {
                    //                dr_final1["Model"] = frthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final1["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final1["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final1["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final1["Model"] = frthLvlValueTemp;
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final1["ItemCode"] = "";
                    //                }
                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final1["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final1["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final1["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final1["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final1["BuyRate"] = "";
                    //        }


                    //        dr_final1["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final1);
                    //    }
                    //}
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //    {
                    //        DataRow dr_final111 = dt.NewRow();
                    //        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //        {
                    //            if (chkboxItemCode.Checked == true)
                    //            {
                    //                dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //            }
                    //            else
                    //            {
                    //                if (chkboxCategory.Checked == true)
                    //                {
                    //                    dr_final111["CategoryName"] = "";
                    //                }
                    //                if (chkboxBrand.Checked == true)
                    //                {
                    //                    dr_final111["Brand"] = "";
                    //                }
                    //                if (chkboxProduct.Checked == true)
                    //                {
                    //                    dr_final111["ProductName"] = "";
                    //                }
                    //                if (chkboxModel.Checked == true)
                    //                {
                    //                    dr_final111["Model"] = "";
                    //                }
                    //                if (chkboxItemCode.Checked == true)
                    //                {
                    //                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //                }

                    //            }
                    //        }

                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final111["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final111["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final111["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final111["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final111["BuyRate"] = "";
                    //        }
                    //        dr_final111["SalesValue"] = "";
                    //        dt.Rows.Add(dr_final111);
                    //    }
                    //}
                }


                fLvlValue = fLvlValueTemp;
                sLvlValue = sLvlValueTemp;
                tLvlValue = tLvlValueTemp;
                frthLvlValue = frthLvlValueTemp;
                fifLvlValue = fifthLvlValueTemp;

                /////////////////
                if (chkboxAll.Checked == true)
                {
                    if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                    {
                        DataRow dr_final5 = dt.NewRow();
                        //if (chkboxAll.Checked == true)
                        //{
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                        }
                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                        }
                        //}
                        //else
                        //{
                        //    if (chkboxCategory.Checked == true)
                        //    {
                        //        dr_final5["CategoryName"] = dr["CategoryName"];
                        //    }

                        //    if (chkboxBrand.Checked == true)
                        //    {
                        //        dr_final5["Brand"] = dr["ProductDesc"];
                        //    }
                        //    if (chkboxProduct.Checked == true)
                        //    {
                        //        dr_final5["ProductName"] = dr["ProductName"];
                        //    }
                        //    if (chkboxModel.Checked == true)
                        //    {
                        //        dr_final5["Model"] = dr["Model"];
                        //    }
                        //    if (chkboxItemCode.Checked == true)
                        //    {
                        //        dr_final5["ItemCode"] = dr["ItemCode"];
                        //    }
                        //}
                        if (chkboxStock.Checked == true)
                        {
                            dr_final5["Quantity"] = dr["Stock"];
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final5["VAT"] = dr["VAT"];
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final5["NLC"] = dr["NLC"];
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final5["Rate"] = dr["Rate"];

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final5["BuyRate"] = dr["BuyRate"];
                        }
                        dr_final5["SalesValue"] = dr["SalesValue"];

                        dt.Rows.Add(dr_final5);
                    }
                }
                else
                {
                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    dr_final5["SalesValue"] = dr["SalesValue"];

                    dt.Rows.Add(dr_final5);
                }

                Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                if (chkboxStock.Checked == true)
                {
                    Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                }
                modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
            }



            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final17 = dt.NewRow();


                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final17["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final17["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final17["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final17["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                            //    }
                            //    else
                            //    {
                            //        dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            if (FiveLvlSUb == "CategoryName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FiveLvlSUb == "Brand")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FiveLvlSUb == "ProductName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FiveLvlSUb == "Model")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FiveLvlSUb == "ItemCode")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }



                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final7 = dt.NewRow();
                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final7["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final7["Brand"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final7["ProductName"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final7["ItemCode"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final7["Model"] = "Total:" + frthLvlValueTemp;
                            //    }
                            //    else
                            //    {
                            //        dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            if (FourLvlSub == "CategoryName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FourLvlSub == "Brand")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FourLvlSub == "ProductName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FourLvlSub == "Model")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FourLvlSub == "ItemCode")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }



                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                            //    }
                            // }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            if (TLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (TLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (TLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (TLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (TLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }

                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["Brand"] = "Total:" + sLvlValueTemp;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (SLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (SLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (SLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (SLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (SLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }

                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }




                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            DataRow dr_final8 = dt.NewRow();

                            //if (chkboxAll.Checked == true)
                            //{
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            } if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                            //}
                            //else
                            //{
                            //    if (chkboxBrand.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "";
                            //    }
                            //    if (chkboxProduct.Checked == true)
                            //    {
                            //        dr_final8["ProductName"] = "";
                            //    }
                            //    if (chkboxModel.Checked == true)
                            //    {
                            //        dr_final8["Model"] = "";
                            //    }
                            //    if (chkboxItemCode.Checked == true)
                            //    {
                            //        dr_final8["ItemCode"] = "";
                            //    }
                            //    if (chkboxCategory.Checked == true)
                            //    {
                            //        dr_final8["CategoryName"] = "Total:" + fLvlValueTemp;
                            //    }
                            //    else
                            //    {
                            //        dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                            //    }
                            //}
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (FLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }

                    }
                    else
                    {

                        if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                        {
                            if (chkboxItemCode.Checked == true)
                            {
                                DataRow dr_final17 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final17["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final17["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final17["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final17["Model"] = "";
                                }
                                if (chkboxStock.Checked == true)
                                {
                                    dr_final17["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final17["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final17["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final17["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final17["BuyRate"] = "";
                                }
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                                dt.Rows.Add(dr_final17);
                                Ittls = 0;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                DataRow dr_final7 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final7["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final7["Brand"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final7["ProductName"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final7["ItemCode"] = "";
                                }

                                dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final7["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final7["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final7["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final7["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final7["BuyRate"] = "";
                                }

                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                                dt.Rows.Add(dr_final7);
                                Pttls = 0;
                            }

                            if (chkboxProduct.Checked == true)
                            {
                                DataRow dr_final8 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final8["CategoryName"] = "";
                                }
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final8["Brand"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final8["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final8["ItemCode"] = "";
                                }
                                dr_final8["ProductName"] = "Total:" + tLvlValueTemp;

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final8["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final8["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final8["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final8["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final8["BuyRate"] = "";
                                }
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                                dt.Rows.Add(dr_final8);
                                modelTotal = 0;
                            }

                            if (chkboxBrand.Checked == true)
                            {
                                DataRow dr_final9 = dt.NewRow();
                                if (chkboxCategory.Checked == true)
                                {
                                    dr_final9["CategoryName"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final9["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final9["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final9["ItemCode"] = "";
                                }
                                dr_final9["Brand"] = "Total:" + sLvlValueTemp;

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final9["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final9["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final9["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final9["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final9["BuyRate"] = "";
                                }
                                dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                                dt.Rows.Add(dr_final9);
                                catIDTotal = 0;
                            }

                            if (chkboxCategory.Checked == true)
                            {
                                DataRow dr_final10 = dt.NewRow();
                                if (chkboxBrand.Checked == true)
                                {
                                    dr_final10["CategoryName"] = "";
                                }
                                if (chkboxProduct.Checked == true)
                                {
                                    dr_final10["ProductName"] = "";
                                }
                                if (chkboxModel.Checked == true)
                                {
                                    dr_final10["Model"] = "";
                                }
                                if (chkboxItemCode.Checked == true)
                                {
                                    dr_final10["ItemCode"] = "";
                                }
                                dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                                if (chkboxStock.Checked == true)
                                {
                                    dr_final10["Quantity"] = "";
                                }
                                if (chkboxVat.Checked == true)
                                {
                                    dr_final10["VAT"] = "";
                                }
                                if (chkboxNlc.Checked == true)
                                {
                                    dr_final10["NLC"] = "";
                                }
                                if (chkboxRate.Checked == true)
                                {
                                    dr_final10["Rate"] = "";

                                }
                                if (chkboxBuyrate.Checked == true)
                                {
                                    dr_final10["BuyRate"] = "";
                                }
                                dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                                dt.Rows.Add(dr_final10);
                                brandTotal = 0;
                            }
                        }
                    }

                    DataRow dr_final888 = dt.NewRow();
                    dt.Rows.Add(dr_final888);

                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFirstSub.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlSecondSub.SelectedItem.Text] = "";
                        }
                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlThirdSub.SelectedItem.Text] = "";
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFourSub.SelectedItem.Text] = "";
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFiveSub.SelectedItem.Text] = "";
                        }
                    }
                    else
                    {
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final6["CategoryName"] = "Grand Total: ";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final6["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final6["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final6["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final6["ItemCode"] = "";
                        }
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);

                    dt.Rows.Add(dr_final6);
                }


                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }

    public void BindDataSubTotNew(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        string FLvlSub = "", SLvlSub = "", TLvlSub = "", FourLvlSub = "", FiveLvlSUb = "";

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
            {
                if (chkboxAll.Checked == true)
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FLvlSub));
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(SLvlSub));
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(TLvlSub));
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FourLvlSub));
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                        dt.Columns.Add(new DataColumn(FiveLvlSUb));
                    }

                    if (chkboxStock.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Quantity"));
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("VAT"));
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("NLC"));
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("Rate"));
                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dt.Columns.Add(new DataColumn("BuyRate"));
                    }
                }
                else
                {
                    if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("CategoryName"));
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Brand"));
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ProductName"));
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Model"));
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("ItemCode"));
                        }

                        if (chkboxStock.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Quantity"));
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("VAT"));
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("NLC"));
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("Rate"));
                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dt.Columns.Add(new DataColumn("BuyRate"));
                        }
                    }
                }
            }

            dt.Columns.Add(new DataColumn("SalesValue"));

            DataRow dr_final88 = dt.NewRow();
            dt.Rows.Add(dr_final88);

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                    }
                }


                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";

                             dr_final8["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                            }
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            /* dr_final2["Rate"] = "";
                             dr_final2["NLC"] = "";
                             dr_final2["BuyRate"] = "";
                             dr_final2["VAT"] = "";

                             dr_final2["Quantity"] = ""*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /* dr_final1["Rate"] = "";
                             dr_final1["NLC"] = "";
                             dr_final1["BuyRate"] = "";
                             dr_final1["VAT"] = "";
                             dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }



                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            if (DdlFirstSub.SelectedItem.Text == "Brand")
                            {
                                fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fLvlValueTemp = dr[DdlFirstSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            if (DdlSecondSub.SelectedItem.Text == "Brand")
                            {
                                sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                sLvlValueTemp = dr[DdlSecondSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }

                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            if (DdlThirdSub.SelectedItem.Text == "Brand")
                            {
                                tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                tLvlValueTemp = dr[DdlThirdSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            if (DdlFourSub.SelectedItem.Text == "Brand")
                            {
                                frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                frthLvlValueTemp = dr[DdlFourSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            if (DdlFiveSub.SelectedItem.Text == "Brand")
                            {
                                fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                            }
                            else
                            {
                                fifthLvlValueTemp = dr[DdlFiveSub.SelectedItem.Text].ToString().ToUpper().Trim();
                            }
                        }
                    }
                    else
                    {

                        if (chkboxCategory.Checked == true)
                        {
                            fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                        }
                        if (chkboxModel.Checked == true)
                        {
                            frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                        }
                    }
                }

                dispLastTotal = true;

                if (DdlFiveSub.SelectedItem.Text != "None")
                {
                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                         (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                         (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                         (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                         (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["ItemCode"] = "Total : " + fifLvlValue;
                            }
                            else
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifLvlValue;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                        if (FiveLvlSUb == "CategoryName")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            catIDTotal = 0;
                        }
                        else if (FiveLvlSUb == "Brand")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            brandTotal = 0;
                        }
                        else if (FiveLvlSUb == "ProductName")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            modelTotal = 0;
                        }
                        else if (FiveLvlSUb == "Model")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            Pttls = 0;
                        }
                        else if (FiveLvlSUb == "ItemCode")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            Ittls = 0;
                        }
                        dt.Rows.Add(dr_final17);
                    }
                }

                if (DdlFourSub.SelectedItem.Text != "None")
                {
                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                        (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                        (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }

                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total : " + frthLvlValue;
                            }
                            else
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValue;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                        if (FourLvlSub == "CategoryName")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            catIDTotal = 0;
                        }
                        else if (FourLvlSub == "Brand")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            brandTotal = 0;
                        }
                        else if (FourLvlSub == "ProductName")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            modelTotal = 0;
                        }
                        else if (FourLvlSub == "Model")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            Pttls = 0;
                        }
                        else if (FourLvlSub == "ItemCode")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            Ittls = 0;
                        }
                        dt.Rows.Add(dr_final7);
                    }
                }


                if (DdlThirdSub.SelectedItem.Text != "None")
                {
                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                        (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                        (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }

                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total : " + tLvlValue;
                            }
                            else
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValue;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                        if (TLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            catIDTotal = 0;
                        }
                        else if (TLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            brandTotal = 0;
                        }
                        else if (TLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            modelTotal = 0;
                        }
                        else if (TLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            Pttls = 0;
                        }
                        else if (TLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            Ittls = 0;
                        }
                        dt.Rows.Add(dr_final8);
                    }
                }

                if (DdlSecondSub.SelectedItem.Text != "None")
                {
                    if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                           (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }

                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total : " + sLvlValue;
                            }
                            else
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValue;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                        if (SLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            catIDTotal = 0;
                        }
                        else if (SLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            brandTotal = 0;
                        }
                        else if (SLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            modelTotal = 0;
                        }
                        else if (SLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            Pttls = 0;
                        }
                        else if (SLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            Ittls = 0;
                        }
                        dt.Rows.Add(dr_final8);
                    }
                }

                if (DdlFirstSub.SelectedItem.Text != "None")
                {
                    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            } if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {

                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total : " + fLvlValue;
                            }
                            else
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValue;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";
                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        if (FLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            catIDTotal = 0;
                        }
                        else if (FLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            brandTotal = 0;
                        }
                        else if (FLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            modelTotal = 0;
                        }
                        else if (FLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            Pttls = 0;
                        }
                        else if (FLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            Ittls = 0;
                        }
                        dt.Rows.Add(dr_final8);
                    }
                }



                fLvlValue = fLvlValueTemp;
                sLvlValue = sLvlValueTemp;
                tLvlValue = tLvlValueTemp;
                frthLvlValue = frthLvlValueTemp;
                fifLvlValue = fifthLvlValueTemp;

                /////////////////
                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFirstSub.SelectedItem.Text] = fLvlValueTemp;
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlSecondSub.SelectedItem.Text] = sLvlValueTemp;
                        }
                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlThirdSub.SelectedItem.Text] = tLvlValueTemp;
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFourSub.SelectedItem.Text] = frthLvlValueTemp;
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            dr_final5[DdlFiveSub.SelectedItem.Text] = fifthLvlValueTemp;
                        }
                    }
                    else
                    {
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final5["CategoryName"] = dr["CategoryName"];
                        }

                        if (chkboxBrand.Checked == true)
                        {
                            dr_final5["Brand"] = dr["ProductDesc"];
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final5["ProductName"] = dr["ProductName"];
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final5["Model"] = dr["Model"];
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final5["ItemCode"] = dr["ItemCode"];
                        }
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    dr_final5["SalesValue"] = dr["SalesValue"];

                    dt.Rows.Add(dr_final5);
                }

                Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                if (chkboxStock.Checked == true)
                {
                    Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                }
                modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);
            }



            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {

                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                            }
                            else
                            {
                                dr_final17[DdlFiveSub.SelectedItem.Text] = "Total : " + fifthLvlValueTemp;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }
                        if (FiveLvlSUb == "CategoryName")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        }
                        else if (FiveLvlSUb == "Brand")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        }
                        else if (FiveLvlSUb == "ProductName")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        }
                        else if (FiveLvlSUb == "Model")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        }
                        else if (FiveLvlSUb == "ItemCode")
                        {
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        }
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }





                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final7[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total:" + frthLvlValueTemp;
                            }
                            else
                            {
                                dr_final7[DdlFourSub.SelectedItem.Text] = "Total : " + frthLvlValueTemp;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }
                        if (FourLvlSub == "CategoryName")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        }
                        else if (FourLvlSub == "Brand")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        }
                        else if (FourLvlSub == "ProductName")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        }
                        else if (FourLvlSub == "Model")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        }
                        else if (FourLvlSub == "ItemCode")
                        {
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        }
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }



                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();

                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                            }
                            else
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "Total : " + tLvlValueTemp;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }
                        if (TLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        }
                        else if (TLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        }
                        else if (TLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        }
                        else if (TLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        }
                        else if (TLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        }
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();

                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "";
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            }
                            if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total:" + sLvlValueTemp;
                            }
                            else
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "Total : " + sLvlValueTemp;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        if (SLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        }
                        else if (SLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        }
                        else if (SLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        }
                        else if (SLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        }
                        else if (SLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        }

                        dt.Rows.Add(dr_final8);
                        brandTotal = 0;
                    }




                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();

                        if (chkboxAll.Checked == true)
                        {
                            if (DdlFirstSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                            }
                            if (DdlSecondSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlSecondSub.SelectedItem.Text] = "";
                            }
                            if (DdlThirdSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlThirdSub.SelectedItem.Text] = "";
                            } if (DdlFourSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFourSub.SelectedItem.Text] = "";
                            }
                            if (DdlFiveSub.SelectedItem.Text != "None")
                            {
                                dr_final8[DdlFiveSub.SelectedItem.Text] = "";
                            }
                        }
                        else
                        {
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total:" + fLvlValueTemp;
                            }
                            else
                            {
                                dr_final8[DdlFirstSub.SelectedItem.Text] = "Total : " + fLvlValueTemp;
                            }
                        }
                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        if (FLvlSub == "CategoryName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        }
                        else if (FLvlSub == "Brand")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        }
                        else if (FLvlSub == "ProductName")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        }
                        else if (FLvlSub == "Model")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        }
                        else if (FLvlSub == "ItemCode")
                        {
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        }
                        dt.Rows.Add(dr_final8);
                        catIDTotal = 0;
                    }




                    //if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                    //{
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    DataRow dr_final17 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final17["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final17["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final17["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final17["Model"] = "";
                    //    }

                    //    /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                    //    dr_final17["Rate"] = "";
                    //    dr_final17["NLC"] = "";
                    //    dr_final17["BuyRate"] = "";
                    //    dr_final17["VAT"] = "";


                    //    dr_final17["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final17["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final17["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final17["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final17["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final17["BuyRate"] = "";
                    //    }
                    //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //    dt.Rows.Add(dr_final17);
                    //    Ittls = 0;
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    DataRow dr_final7 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final7["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final7["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final7["ProductName"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final7["ItemCode"] = "";
                    //    }

                    //    dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                    //    /*if (selLevels.IndexOf("Brand") < 0)
                    //        dr_final7["Brand"] = "";
                    //    if (selLevels.IndexOf("CategoryName") < 0)
                    //        dr_final7["CategoryName"] = "";
                    //    if (selLevels.IndexOf("ItemCode") < 0)
                    //        dr_final7["ItemCode"] = "";
                    //    if (selLevels.IndexOf("Model") < 0)
                    //        dr_final7["Model"] = "";
                    //    if (selLevels.IndexOf("ProductName") < 0)
                    //        dr_final7["ProductName"] = "";*/
                    //    /*dr_final7["Rate"] = "";
                    //    dr_final7["NLC"] = "";
                    //    dr_final7["BuyRate"] = "";
                    //    dr_final7["VAT"] = "";

                    //    dr_final7["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final7["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final7["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final7["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final7["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final7["BuyRate"] = "";
                    //    }

                    //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //    dt.Rows.Add(dr_final7);
                    //    Pttls = 0;
                    //}

                    //if (chkboxProduct.Checked == true)
                    //{
                    //    DataRow dr_final8 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final8["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final8["Brand"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final8["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final8["ItemCode"] = "";
                    //    }
                    //    dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final8["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final8["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final8["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final8["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final8["ProductName"] = "";*/
                    //    /* dr_final8["Rate"] = "";
                    //     dr_final8["NLC"] = "";
                    //     dr_final8["BuyRate"] = "";
                    //     dr_final8["VAT"] = "";

                    //     dr_final8["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final8["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final8["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final8["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final8["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final8["BuyRate"] = "";
                    //    }
                    //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //    dt.Rows.Add(dr_final8);
                    //    modelTotal = 0;
                    //}

                    //if (chkboxBrand.Checked == true)
                    //{
                    //    DataRow dr_final9 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final9["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final9["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final9["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final9["ItemCode"] = "";
                    //    }
                    //    dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final9["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final9["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final9["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final9["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final9["ProductName"] = "";*/
                    //    /*dr_final9["Rate"] = "";
                    //    dr_final9["NLC"] = "";
                    //    dr_final9["BuyRate"] = "";
                    //    dr_final9["VAT"] = "";

                    //    dr_final9["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final9["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final9["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final9["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final9["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final9["BuyRate"] = "";
                    //    }
                    //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //    dt.Rows.Add(dr_final9);
                    //    catIDTotal = 0;
                    //}

                    //if (chkboxCategory.Checked == true)
                    //{
                    //    DataRow dr_final10 = dt.NewRow();
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final10["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final10["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final10["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final10["ItemCode"] = "";
                    //    }
                    //    dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final10["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final10["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final10["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final10["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final10["ProductName"] = "";*/

                    //    /*dr_final10["Rate"] = "";
                    //    dr_final10["NLC"] = "";
                    //    dr_final10["BuyRate"] = "";
                    //    dr_final10["VAT"] = "";

                    //    dr_final10["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final10["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final10["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final10["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final10["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final10["BuyRate"] = "";
                    //    }
                    //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //    dt.Rows.Add(dr_final10);
                    //    brandTotal = 0;
                    //}

                    DataRow dr_final888 = dt.NewRow();
                    dt.Rows.Add(dr_final888);

                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxAll.Checked == true)
                    {
                        if (DdlFirstSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFirstSub.SelectedItem.Text] = "Grand Total: ";
                        }
                        if (DdlSecondSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlSecondSub.SelectedItem.Text] = "";
                        }
                        if (DdlThirdSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlThirdSub.SelectedItem.Text] = "";
                        }
                        if (DdlFourSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFourSub.SelectedItem.Text] = "";
                        }
                        if (DdlFiveSub.SelectedItem.Text != "None")
                        {
                            dr_final6[DdlFiveSub.SelectedItem.Text] = "";
                        }
                    }
                    else
                    {
                        if (chkboxCategory.Checked == true)
                        {
                            dr_final6["CategoryName"] = "Grand Total: ";
                        }
                        if (chkboxBrand.Checked == true)
                        {
                            dr_final6["Brand"] = "";
                        }
                        if (chkboxProduct.Checked == true)
                        {
                            dr_final6["ProductName"] = "";
                        }
                        if (chkboxModel.Checked == true)
                        {
                            dr_final6["Model"] = "";
                        }
                        if (chkboxItemCode.Checked == true)
                        {
                            dr_final6["ItemCode"] = "";
                        }
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);

                    dt.Rows.Add(dr_final6);
                }


                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }


    public void BindDataSubTotOld(string sDataSource, DateTime refDate, string selCols, string field2, string cond, string grpBy, string ordrby)
    {
        //if (ddlfourlvl.SelectedItem.Text != "None")

        bool dispLastTotal = false;
        DataSet ds = new DataSet();
        ds = objBL.getstockdate(sDataSource, refDate, selCols, field2, cond, grpBy, ordrby);
        //ds = objBL.getStock(selCols, field2, cond, grpBy, ordrby);
        DataTable dt = new DataTable();
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
            {
                if (ddlfirstlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfirstlvl.SelectedItem.Text));
                }
                if (ddlsecondlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlsecondlvl.SelectedItem.Text));
                }
                if (ddlthirdlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlthirdlvl.SelectedItem.Text));
                }
                if (ddlfourlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfourlvl.SelectedItem.Text));
                }
                if (ddlfifthlvl.SelectedItem.Text != "None")
                {
                    dt.Columns.Add(new DataColumn(ddlfifthlvl.SelectedItem.Text));
                }
                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }
            }
            else if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked) || (chkboxStock.Checked) || (chkboxNlc.Checked) || (chkboxRate.Checked) || (chkboxVat.Checked) || (chkboxBuyrate.Checked))
            {
                if (chkboxCategory.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("CategoryName"));
                }
                if (chkboxBrand.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Brand"));
                }
                if (chkboxProduct.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ProductName"));
                }
                if (chkboxModel.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Model"));
                }
                if (chkboxItemCode.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("ItemCode"));
                }

                if (chkboxStock.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Quantity"));
                }
                if (chkboxVat.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("VAT"));
                }
                if (chkboxNlc.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("NLC"));
                }
                if (chkboxRate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("Rate"));
                }
                if (chkboxBuyrate.Checked == true)
                {
                    dt.Columns.Add(new DataColumn("BuyRate"));
                }

            }
            /* if (selLevels.IndexOf("Brand") < 0)
                 dt.Columns.Add(new DataColumn("Brand"));
             if (selLevels.IndexOf("CategoryName") < 0)
                 dt.Columns.Add(new DataColumn("CategoryName"));
             if (selLevels.IndexOf("ItemCode") < 0)
                 dt.Columns.Add(new DataColumn("ItemCode"));
             if (selLevels.IndexOf("Model") < 0)
                 dt.Columns.Add(new DataColumn("Model"));
             if (selLevels.IndexOf("ProductName") < 0)
                 dt.Columns.Add(new DataColumn("ProductName"));*/









            dt.Columns.Add(new DataColumn("SalesValue"));

            //initialize column values for entire row
            string fLvlValue = "", sLvlValue = "", tLvlValue = "", frthLvlValue = "", fifLvlValue = "";
            string fLvlValueTemp = "", sLvlValueTemp = "", tLvlValueTemp = "", frthLvlValueTemp = "", fifthLvlValueTemp = "";
            string FLvlSub = "", SLvlSub = "", TLvlSub = "", FourLvlSub = "", FiveLvlSUb = "";

            foreach (DataRow dr in ds.Tables[0].Rows)
            {

                if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
                {
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        FLvlSub = DdlFirstSub.SelectedItem.Text;
                    }
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        SLvlSub = DdlSecondSub.SelectedItem.Text;
                    }
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        TLvlSub = DdlThirdSub.SelectedItem.Text;
                    }
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        FourLvlSub = DdlFourSub.SelectedItem.Text;
                    }
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        FiveLvlSUb = DdlFiveSub.SelectedItem.Text;
                    }
                }


                if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {
                    //initialize column values for entire row
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfirstlvl.SelectedItem.Text == "Brand")
                        {
                            fLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fLvlValueTemp = dr[ddlfirstlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (ddlsecondlvl.SelectedItem.Text == "Brand")
                        {
                            sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            sLvlValueTemp = dr[ddlsecondlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (ddlthirdlvl.SelectedItem.Text == "Brand")
                        {
                            tLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            tLvlValueTemp = dr[ddlthirdlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfourlvl.SelectedItem.Text == "Brand")
                        {
                            frthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            frthLvlValueTemp = dr[ddlfourlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (ddlfifthlvl.SelectedItem.Text == "Brand")
                        {
                            fifthLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                        }
                        else
                        {
                            fifthLvlValueTemp = dr[ddlfifthlvl.SelectedItem.Text].ToString().ToUpper().Trim();
                        }
                    }

                    //dispLastTotal = true;
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                           (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final17 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                            }

                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final17["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final17["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final17["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final17["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final17["ProductName"] = "";*/

                            /* dr_final17["Rate"] = "";
                             dr_final17["NLC"] = "";
                             dr_final17["BuyRate"] = "";
                             dr_final17["VAT"] = "";
                             dr_final17["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }
                            dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            dt.Rows.Add(dr_final17);
                            Ittls = 0;
                        }
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final7 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValue;
                            }
                            //dr_final7["Brand"] = "";
                            ////dr_final7[ddlOrdBySel1.selectedvalue] = "";
                            //dr_final7["CategoryName"] = "";
                            //dr_final7["Model"] = "";
                            //dr_final7["ProductName"] = "";

                            //dr_final7["ItemCode"] = "Total:" + frthLvlValueTemp;
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final7["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final7["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final7["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final7["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final7["ProductName"] = "";*/

                            /*dr_final7["Rate"] = "";
                            dr_final7["NLC"] = "";
                            dr_final7["BuyRate"] = "";
                            dr_final7["VAT"] = "";
                            dr_final7["Quantity"] = */

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }
                            dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            dt.Rows.Add(dr_final7);
                            Pttls = 0;
                        }
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total " + tLvlValue;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final8["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final8["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final8["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final8["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }
                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            dt.Rows.Add(dr_final8);
                            //dt.Rows.Add(dr_final8);
                            modelTotal = 0;
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "Total " + sLvlValue;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final8["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final8["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final8["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final8["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final8["ProductName"] = "";*/
                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";

                             dr_final8["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final8 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfirstlvl.SelectedItem.Text] = "Total " + fLvlValue;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /* if (selLevels.IndexOf("Brand") < 0)
                                 dr_final8["Brand"] = "";
                             if (selLevels.IndexOf("CategoryName") < 0)
                                 dr_final8["CategoryName"] = "";
                             if (selLevels.IndexOf("ItemCode") < 0)
                                 dr_final8["ItemCode"] = "";
                             if (selLevels.IndexOf("Model") < 0)
                                 dr_final8["Model"] = "";
                             if (selLevels.IndexOf("ProductName") < 0)
                                 dr_final8["ProductName"] = "";*/

                            /* dr_final8["Rate"] = "";
                             dr_final8["NLC"] = "";
                             dr_final8["BuyRate"] = "";
                             dr_final8["VAT"] = "";
                             dr_final8["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;
                        }
                    }
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = fLvlValueTemp;
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                        {
                            DataRow dr_final2 = dt.NewRow();
                            if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                            {
                                if (ddlsecondlvl.SelectedItem.Text != "None")
                                {
                                    dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                                }
                            }
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlsecondlvl.SelectedItem.Text] = sLvlValueTemp;
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlthirdlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final2[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final2[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final2["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final2["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final2["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final2["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final2["ProductName"] = "";*/
                            /* dr_final2["Rate"] = "";
                             dr_final2["NLC"] = "";
                             dr_final2["BuyRate"] = "";
                             dr_final2["VAT"] = "";

                             dr_final2["Quantity"] = ""*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final2["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final2["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final2["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final2["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final2["BuyRate"] = "";
                            }


                            dr_final2["SalesValue"] = "";
                            dt.Rows.Add(dr_final2);
                        }
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                            {
                                if (ddlthirdlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                                }
                            }
                            //else
                            //{
                            if (ddlfirstlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                            }
                            if (ddlsecondlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                            }
                            if (ddlthirdlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlthirdlvl.SelectedItem.Text] = tLvlValueTemp;
                            }
                            if (ddlfourlvl.SelectedItem.Text != "None")
                            {
                                dr_final1[ddlfourlvl.SelectedItem.Text] = "";
                            }
                            if (ddlfifthlvl.SelectedItem.Text != "None")
                            {
                                //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                            }
                            /*if (selLevels.IndexOf("Brand") < 0)
                                dr_final1["Brand"] = "";
                            if (selLevels.IndexOf("CategoryName") < 0)
                                dr_final1["CategoryName"] = "";
                            if (selLevels.IndexOf("ItemCode") < 0)
                                dr_final1["ItemCode"] = "";
                            if (selLevels.IndexOf("Model") < 0)
                                dr_final1["Model"] = "";
                            if (selLevels.IndexOf("ProductName") < 0)
                                dr_final1["ProductName"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            /*dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";

                            dr_final1["Quantity"] = "";
                            dr_final1["Rate"] = "";
                            dr_final1["NLC"] = "";
                            dr_final1["BuyRate"] = "";
                            dr_final1["VAT"] = "";*/

                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                        {
                            DataRow dr_final1 = dt.NewRow();
                            if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                            {
                                if (ddlfourlvl.SelectedItem.Text != "None")
                                {
                                    dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final1[ddlfourlvl.SelectedItem.Text] = frthLvlValueTemp;
                                    }
                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                                        dr_final1[ddlfifthlvl.SelectedItem.Text] = "";
                                    }
                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final1["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final1["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)

                                  dr_final1["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final1["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final1["ProductName"] = "";*/
                            /* dr_final1["Rate"] = "";
                             dr_final1["NLC"] = "";
                             dr_final1["BuyRate"] = "";
                             dr_final1["VAT"] = "";
                             dr_final1["Quantity"] = "";*/

                            if (chkboxStock.Checked == true)
                            {
                                dr_final1["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final1["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final1["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final1["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final1["BuyRate"] = "";
                            }


                            dr_final1["SalesValue"] = "";
                            dt.Rows.Add(dr_final1);
                        }
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                            (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                        {
                            DataRow dr_final111 = dt.NewRow();
                            if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                            {
                                if (ddlfifthlvl.SelectedItem.Text != "None")
                                {
                                    dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                }
                                else
                                {
                                    if (ddlfirstlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfirstlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlsecondlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlsecondlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlthirdlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlthirdlvl.SelectedItem.Text] = "";
                                    }
                                    if (ddlfourlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfourlvl.SelectedItem.Text] = "";
                                    }

                                    if (ddlfifthlvl.SelectedItem.Text != "None")
                                    {
                                        dr_final111[ddlfifthlvl.SelectedItem.Text] = fifthLvlValueTemp;
                                    }

                                }
                            }

                            /*  if (selLevels.IndexOf("Brand") < 0)
                                  dr_final111["Brand"] = "";
                              if (selLevels.IndexOf("CategoryName") < 0)
                                  dr_final111["CategoryName"] = "";
                              if (selLevels.IndexOf("ItemCode") < 0)
                                  dr_final111["ItemCode"] = "";
                              if (selLevels.IndexOf("Model") < 0)
                                  dr_final111["Model"] = "";
                              if (selLevels.IndexOf("ProductName") < 0)
                                  dr_final111["ProductName"] = "";*/

                            /*dr_final111["Rate"] = "";
                            dr_final111["NLC"] = "";
                            dr_final111["BuyRate"] = "";
                            dr_final111["VAT"] = "";
                            dr_final111["Quantity"] = "";*/
                            if (chkboxStock.Checked == true)
                            {
                                dr_final111["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final111["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final111["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final111["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final111["BuyRate"] = "";
                            }



                            dr_final111["SalesValue"] = "";
                            dt.Rows.Add(dr_final111);
                        }
                    }

                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;

                    DataRow dr_final5 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {

                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfirstlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfirstlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlsecondlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlsecondlvl.SelectedItem.Text] = dr["Model"];
                        }

                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlthirdlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlthirdlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfourlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfourlvl.SelectedItem.Text] = dr["Model"];
                        }


                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Brand")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductDesc"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "CategoryName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["CategoryName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ItemCode")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ItemCode"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "ProductName")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["ProductName"];
                        }
                        if (dr_final5[ddlfifthlvl.SelectedItem.Text] == "Model")
                        {
                            dr_final5[ddlfifthlvl.SelectedItem.Text] = dr["Model"];
                        }
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);

                }


                else
                {
                    if (chkboxCategory.Checked == true)
                    {
                        fLvlValueTemp = dr["CategoryName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        sLvlValueTemp = dr["ProductDesc"].ToString().ToUpper().Trim();
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        tLvlValueTemp = dr["ProductName"].ToString().ToUpper().Trim();
                    }
                    if (chkboxModel.Checked == true)
                    {
                        frthLvlValueTemp = dr["Model"].ToString().ToUpper().Trim();
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        fifthLvlValueTemp = dr["ItemCode"].ToString().ToUpper().Trim();
                    }
                    dispLastTotal = true;

                    //if (FLvlSub == "ItemCode")
                    //{
                    if (DdlFiveSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                             (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                             (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                             (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp) ||
                             (fifLvlValue != "" && fifLvlValue != fifthLvlValueTemp))
                        {

                            //DataRow dr_final88 = dt.NewRow();
                            //dt.Rows.Add(dr_final88);

                            DataRow dr_final17 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final17["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final17["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final17["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final17["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final17["ItemCode"] = "Total : " + fifLvlValue;
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final17["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final17["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final17["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final17["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final17["BuyRate"] = "";
                            }

                            //dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));

                            if (FiveLvlSUb == "CategoryName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FiveLvlSUb == "Brand")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FiveLvlSUb == "ProductName")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FiveLvlSUb == "Model")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FiveLvlSUb == "ItemCode")
                            {
                                dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }


                            dt.Rows.Add(dr_final17);

                            //DataRow dr_final888 = dt.NewRow();
                            //dt.Rows.Add(dr_final888);

                            Ittls = 0;
                            //}
                        }
                    }


                    //if (FLvlSub == "Model")
                    //{
                    if (DdlFourSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp) ||
                            (frthLvlValue != "" && frthLvlValue != frthLvlValueTemp))
                        {

                            //DataRow dr_final888 = dt.NewRow();
                            //dt.Rows.Add(dr_final888);

                            DataRow dr_final7 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final7["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final7["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final7["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final7["Model"] = "Total : " + frthLvlValue;
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final7["ItemCode"] = "";
                            }

                            if (chkboxStock.Checked == true)
                            {
                                dr_final7["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final7["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final7["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final7["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final7["BuyRate"] = "";
                            }

                            //dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));

                            if (FourLvlSub == "CategoryName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FourLvlSub == "Brand")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FourLvlSub == "ProductName")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FourLvlSub == "Model")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FourLvlSub == "ItemCode")
                            {
                                dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }

                            dt.Rows.Add(dr_final7);

                            //DataRow dr_final88 = dt.NewRow();
                            //dt.Rows.Add(dr_final88);

                            Pttls = 0;
                            //}
                        }
                    }



                    //if (FLvlSub == "ProductName")
                    //{
                    if (DdlThirdSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                            (sLvlValue != "" && sLvlValue != sLvlValueTemp) ||
                            (tLvlValue != "" && tLvlValue != tLvlValueTemp))
                        {

                            //DataRow dr_final88 = dt.NewRow();
                            //dt.Rows.Add(dr_final88);

                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "Total : " + tLvlValue;
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }


                            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));

                            if (TLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (TLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (TLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (TLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (TLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }
                            dt.Rows.Add(dr_final8);
                            modelTotal = 0;

                            //DataRow dr_final888 = dt.NewRow();
                            //dt.Rows.Add(dr_final888);

                            //}
                        }
                    }


                    //if (FLvlSub == "Brand")
                    //{
                    if (DdlSecondSub.SelectedItem.Text != "None")
                    {
                        if ((fLvlValue != "" && fLvlValue != fLvlValueTemp) ||
                               (sLvlValue != "" && sLvlValue != sLvlValueTemp))
                        {
                            //DataRow dr_final888 = dt.NewRow();
                            //dt.Rows.Add(dr_final888);

                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "";
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "Total : " + sLvlValue;
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            //dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));

                            if (SLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (SLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (SLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (SLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (SLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }


                            dt.Rows.Add(dr_final8);
                            brandTotal = 0;

                            //DataRow dr_final88 = dt.NewRow();
                            //dt.Rows.Add(dr_final88);

                            //}
                        }
                    }


                    //if (FLvlSub == "CategoryName")
                    //{
                    if (DdlFirstSub.SelectedItem.Text != "None")
                    {
                        if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                        {

                            //DataRow dr_final888 = dt.NewRow();
                            //dt.Rows.Add(dr_final888);


                            DataRow dr_final8 = dt.NewRow();
                            if (chkboxCategory.Checked == true)
                            {
                                dr_final8["CategoryName"] = "Total : " + fLvlValue;
                            }
                            if (chkboxBrand.Checked == true)
                            {
                                dr_final8["Brand"] = "";
                            }
                            if (chkboxProduct.Checked == true)
                            {
                                dr_final8["ProductName"] = "";
                            }
                            if (chkboxModel.Checked == true)
                            {
                                dr_final8["Model"] = "";
                            }
                            if (chkboxItemCode.Checked == true)
                            {
                                dr_final8["ItemCode"] = "";
                            }
                            if (chkboxStock.Checked == true)
                            {
                                dr_final8["Quantity"] = "";
                            }
                            if (chkboxVat.Checked == true)
                            {
                                dr_final8["VAT"] = "";
                            }
                            if (chkboxNlc.Checked == true)
                            {
                                dr_final8["NLC"] = "";
                            }
                            if (chkboxRate.Checked == true)
                            {
                                dr_final8["Rate"] = "";

                            }
                            if (chkboxBuyrate.Checked == true)
                            {
                                dr_final8["BuyRate"] = "";
                            }

                            if (FLvlSub == "CategoryName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                            }
                            else if (FLvlSub == "Brand")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                            }
                            else if (FLvlSub == "ProductName")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                            }
                            else if (FLvlSub == "Model")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                            }
                            else if (FLvlSub == "ItemCode")
                            {
                                dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                            }




                            dt.Rows.Add(dr_final8);
                            catIDTotal = 0;

                            //DataRow dr_final88 = dt.NewRow();
                            //dt.Rows.Add(dr_final88);

                            //}
                        }
                    }




                    //////if (chkboxCategory.Checked == true)
                    //////{
                    //////    if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //////    {
                    //////        DataRow dr_final1 = dt.NewRow();
                    //////        if (chkboxCategory.Checked == true)
                    //////        {
                    //////            dr_final1["CategoryName"] = fLvlValueTemp;
                    //////        }
                    //////        if (chkboxBrand.Checked == true)
                    //////        {
                    //////            dr_final1["Brand"] = "";
                    //////        }
                    //////        if (chkboxProduct.Checked == true)
                    //////        {
                    //////            dr_final1["ProductName"] = "";
                    //////        }
                    //////        if (chkboxModel.Checked == true)
                    //////        {
                    //////            dr_final1["Model"] = "";
                    //////        }
                    //////        if (chkboxItemCode.Checked == true)
                    //////        {
                    //////            dr_final1["ItemCode"] = "";
                    //////        }
                    //////        /*if (selLevels.IndexOf("Brand") < 0)
                    //////            dr_final1["Brand"] = "";
                    //////        if (selLevels.IndexOf("CategoryName") < 0)
                    //////            dr_final1["CategoryName"] = "";
                    //////        if (selLevels.IndexOf("ItemCode") < 0)
                    //////            dr_final1["ItemCode"] = "";
                    //////        if (selLevels.IndexOf("Model") < 0)
                    //////            dr_final1["Model"] = "";
                    //////        if (selLevels.IndexOf("ProductName") < 0)
                    //////            dr_final1["ProductName"] = "";*/
                    //////        if (chkboxStock.Checked == true)
                    //////        {
                    //////            dr_final1["Quantity"] = "";
                    //////        }
                    //////        if (chkboxVat.Checked == true)
                    //////        {
                    //////            dr_final1["VAT"] = "";
                    //////        }
                    //////        if (chkboxNlc.Checked == true)
                    //////        {
                    //////            dr_final1["NLC"] = "";
                    //////        }
                    //////        if (chkboxRate.Checked == true)
                    //////        {
                    //////            dr_final1["Rate"] = "";

                    //////        }
                    //////        if (chkboxBuyrate.Checked == true)
                    //////        {
                    //////            dr_final1["BuyRate"] = "";
                    //////        }
                    //////        /*dr_final1["Rate"] = "";
                    //////        dr_final1["NLC"] = "";
                    //////        dr_final1["BuyRate"] = "";
                    //////        dr_final1["VAT"] = "";

                    //////        dr_final1["Quantity"] = "";*/


                    //////        dr_final1["SalesValue"] = "";
                    //////        dt.Rows.Add(dr_final1);
                    //////    }
                    //////}
                    //////if (chkboxBrand.Checked == true)
                    //////{
                    //////    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //////        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //////    {
                    //////        DataRow dr_final2 = dt.NewRow();
                    //////        if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //////        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp))
                    //////        {
                    //////            if (chkboxBrand.Checked == true)
                    //////            {
                    //////                dr_final2["Brand"] = sLvlValueTemp;
                    //////            }
                    //////        }
                    //////        if (chkboxCategory.Checked == true)
                    //////        {
                    //////            dr_final2["CategoryName"] = "";
                    //////        }
                    //////        if (chkboxBrand.Checked == true)
                    //////        {
                    //////            dr_final2["Brand"] = sLvlValueTemp;
                    //////        }
                    //////        if (chkboxProduct.Checked == true)
                    //////        {
                    //////            dr_final2["ProductName"] = "";
                    //////        }
                    //////        if (chkboxModel.Checked == true)
                    //////        {
                    //////            dr_final2["Model"] = "";
                    //////        }
                    //////        if (chkboxItemCode.Checked == true)
                    //////        {
                    //////            dr_final2["ItemCode"] = "";
                    //////        }
                    //////        /*  if (selLevels.IndexOf("Brand") < 0)
                    //////              dr_final2["Brand"] = "";
                    //////          if (selLevels.IndexOf("CategoryName") < 0)
                    //////              dr_final2["CategoryName"] = "";
                    //////          if (selLevels.IndexOf("ItemCode") < 0)
                    //////              dr_final2["ItemCode"] = "";
                    //////          if (selLevels.IndexOf("Model") < 0)
                    //////              dr_final2["Model"] = "";
                    //////          if (selLevels.IndexOf("ProductName") < 0)
                    //////              dr_final2["ProductName"] = "";*/
                    //////        if (chkboxStock.Checked == true)
                    //////        {
                    //////            dr_final2["Quantity"] = "";
                    //////        }
                    //////        if (chkboxVat.Checked == true)
                    //////        {
                    //////            dr_final2["VAT"] = "";
                    //////        }
                    //////        if (chkboxNlc.Checked == true)
                    //////        {
                    //////            dr_final2["NLC"] = "";
                    //////        }
                    //////        if (chkboxRate.Checked == true)
                    //////        {
                    //////            dr_final2["Rate"] = "";

                    //////        }
                    //////        if (chkboxBuyrate.Checked == true)
                    //////        {
                    //////            dr_final2["BuyRate"] = "";
                    //////        }
                    //////        /*dr_final2["Rate"] = "";
                    //////        dr_final2["NLC"] = "";
                    //////        dr_final2["BuyRate"] = "";
                    //////        dr_final2["VAT"] = "";

                    //////        dr_final2["Quantity"] = "";*/


                    //////        dr_final2["SalesValue"] = "";
                    //////        dt.Rows.Add(dr_final2);
                    //////    }
                    //////}
                    //////if (chkboxProduct.Checked == true)
                    //////{
                    //////    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //////        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //////        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp))
                    //////    {
                    //////        DataRow dr_final1 = dt.NewRow();
                    //////        if (fLvlValueTemp != "" && fLvlValue != fLvlValueTemp)
                    //////        {
                    //////            if (chkboxProduct.Checked == true)
                    //////            {
                    //////                dr_final1["ProductName"] = tLvlValueTemp;
                    //////            }
                    //////        }
                    //////        //else
                    //////        //{
                    //////        if (chkboxCategory.Checked == true)
                    //////        {
                    //////            dr_final1["CategoryName"] = "";
                    //////        }
                    //////        if (chkboxBrand.Checked == true)
                    //////        {
                    //////            dr_final1["Brand"] = "";
                    //////        }
                    //////        if (chkboxProduct.Checked == true)
                    //////        {
                    //////            dr_final1["ProductName"] = tLvlValueTemp;
                    //////        }
                    //////        if (chkboxModel.Checked == true)
                    //////        {
                    //////            dr_final1["Model"] = "";
                    //////        }
                    //////        if (chkboxItemCode.Checked == true)
                    //////        {
                    //////            dr_final1["ItemCode"] = "";
                    //////        }
                    //////        if (chkboxStock.Checked == true)
                    //////        {
                    //////            dr_final1["Quantity"] = "";
                    //////        }
                    //////        if (chkboxVat.Checked == true)
                    //////        {
                    //////            dr_final1["VAT"] = "";
                    //////        }
                    //////        if (chkboxNlc.Checked == true)
                    //////        {
                    //////            dr_final1["NLC"] = "";
                    //////        }
                    //////        if (chkboxRate.Checked == true)
                    //////        {
                    //////            dr_final1["Rate"] = "";

                    //////        }
                    //////        if (chkboxBuyrate.Checked == true)
                    //////        {
                    //////            dr_final1["BuyRate"] = "";
                    //////        }
                    //////        /*if (selLevels.IndexOf("Brand") < 0)
                    //////            dr_final1["Brand"] = "";
                    //////        if (selLevels.IndexOf("CategoryName") < 0)
                    //////            dr_final1["CategoryName"] = "";
                    //////        if (selLevels.IndexOf("ItemCode") < 0)
                    //////            dr_final1["ItemCode"] = "";
                    //////        if (selLevels.IndexOf("Model") < 0)
                    //////            dr_final1["Model"] = "";
                    //////        if (selLevels.IndexOf("ProductName") < 0)
                    //////            dr_final1["ProductName"] = "";*/

                    //////        /*dr_final1["Rate"] = "";
                    //////        dr_final1["NLC"] = "";
                    //////        dr_final1["BuyRate"] = "";
                    //////        dr_final1["VAT"] = "";

                    //////        dr_final1["Quantity"] = "";
                    //////        dr_final1["Rate"] = "";
                    //////        dr_final1["NLC"] = "";
                    //////        dr_final1["BuyRate"] = "";
                    //////        dr_final1["VAT"] = "";*/

                    //////        dr_final1["SalesValue"] = "";
                    //////        dt.Rows.Add(dr_final1);
                    //////    }
                    //////}
                    //////if (chkboxModel.Checked == true)
                    //////{
                    //////    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //////        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //////        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //////        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp))
                    //////    {
                    //////        DataRow dr_final1 = dt.NewRow();
                    //////        if (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp)
                    //////        {
                    //////            if (chkboxModel.Checked == true)
                    //////            {
                    //////                dr_final1["Model"] = frthLvlValueTemp;
                    //////            }
                    //////            else
                    //////            {
                    //////                if (chkboxCategory.Checked == true)
                    //////                {
                    //////                    dr_final1["CategoryName"] = "";
                    //////                }
                    //////                if (chkboxBrand.Checked == true)
                    //////                {
                    //////                    dr_final1["Brand"] = "";
                    //////                }
                    //////                if (chkboxProduct.Checked == true)
                    //////                {
                    //////                    dr_final1["ProductName"] = "";
                    //////                }
                    //////                if (chkboxModel.Checked == true)
                    //////                {
                    //////                    dr_final1["Model"] = frthLvlValueTemp;
                    //////                }
                    //////                if (chkboxItemCode.Checked == true)
                    //////                {
                    //////                    dr_final1["ItemCode"] = "";
                    //////                }
                    //////            }
                    //////        }

                    //////        /*  if (selLevels.IndexOf("Brand") < 0)
                    //////              dr_final1["Brand"] = "";
                    //////          if (selLevels.IndexOf("CategoryName") < 0)
                    //////              dr_final1["CategoryName"] = "";
                    //////          if (selLevels.IndexOf("ItemCode") < 0)

                    //////              dr_final1["ItemCode"] = "";
                    //////          if (selLevels.IndexOf("Model") < 0)
                    //////              dr_final1["Model"] = "";
                    //////          if (selLevels.IndexOf("ProductName") < 0)
                    //////              dr_final1["ProductName"] = "";*/
                    //////        /*dr_final1["Rate"] = "";
                    //////        dr_final1["NLC"] = "";
                    //////        dr_final1["BuyRate"] = "";
                    //////        dr_final1["VAT"] = "";
                    //////        dr_final1["Quantity"] = "";*/
                    //////        if (chkboxStock.Checked == true)
                    //////        {
                    //////            dr_final1["Quantity"] = "";
                    //////        }
                    //////        if (chkboxVat.Checked == true)
                    //////        {
                    //////            dr_final1["VAT"] = "";
                    //////        }
                    //////        if (chkboxNlc.Checked == true)
                    //////        {
                    //////            dr_final1["NLC"] = "";
                    //////        }
                    //////        if (chkboxRate.Checked == true)
                    //////        {
                    //////            dr_final1["Rate"] = "";

                    //////        }
                    //////        if (chkboxBuyrate.Checked == true)
                    //////        {
                    //////            dr_final1["BuyRate"] = "";
                    //////        }


                    //////        dr_final1["SalesValue"] = "";
                    //////        dt.Rows.Add(dr_final1);
                    //////    }
                    //////}
                    //////if (chkboxItemCode.Checked == true)
                    //////{
                    //////    if ((fLvlValueTemp != "" && fLvlValue != fLvlValueTemp) ||
                    //////        (sLvlValueTemp != "" && sLvlValue != sLvlValueTemp) ||
                    //////        (tLvlValueTemp != "" && tLvlValue != tLvlValueTemp) ||
                    //////        (frthLvlValueTemp != "" && frthLvlValue != frthLvlValueTemp) ||
                    //////        (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp))
                    //////    {
                    //////        DataRow dr_final111 = dt.NewRow();
                    //////        if (fifthLvlValueTemp != "" && fifLvlValue != fifthLvlValueTemp)
                    //////        {
                    //////            if (chkboxItemCode.Checked == true)
                    //////            {
                    //////                dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //////            }
                    //////            else
                    //////            {
                    //////                if (chkboxCategory.Checked == true)
                    //////                {
                    //////                    dr_final111["CategoryName"] = "";
                    //////                }
                    //////                if (chkboxBrand.Checked == true)
                    //////                {
                    //////                    dr_final111["Brand"] = "";
                    //////                }
                    //////                if (chkboxProduct.Checked == true)
                    //////                {
                    //////                    dr_final111["ProductName"] = "";
                    //////                }
                    //////                if (chkboxModel.Checked == true)
                    //////                {
                    //////                    dr_final111["Model"] = "";
                    //////                }
                    //////                if (chkboxItemCode.Checked == true)
                    //////                {
                    //////                    dr_final111["ItemCode"] = fifthLvlValueTemp;
                    //////                }

                    //////            }
                    //////        }

                    //////        /*  if (selLevels.IndexOf("Brand") < 0)
                    //////              dr_final111["Brand"] = "";
                    //////          if (selLevels.IndexOf("CategoryName") < 0)
                    //////              dr_final111["CategoryName"] = "";
                    //////          if (selLevels.IndexOf("ItemCode") < 0)
                    //////              dr_final111["ItemCode"] = "";
                    //////          if (selLevels.IndexOf("Model") < 0)
                    //////              dr_final111["Model"] = "";
                    //////          if (selLevels.IndexOf("ProductName") < 0)
                    //////              dr_final111["ProductName"] = "";*/

                    //////        /* dr_final111["Rate"] = "";
                    //////         dr_final111["NLC"] = "";
                    //////         dr_final111["BuyRate"] = "";
                    //////         dr_final111["VAT"] = "";
                    //////         dr_final111["Quantity"] = "";*/

                    //////        if (chkboxStock.Checked == true)
                    //////        {
                    //////            dr_final111["Quantity"] = "";
                    //////        }
                    //////        if (chkboxVat.Checked == true)
                    //////        {
                    //////            dr_final111["VAT"] = "";
                    //////        }
                    //////        if (chkboxNlc.Checked == true)
                    //////        {
                    //////            dr_final111["NLC"] = "";
                    //////        }
                    //////        if (chkboxRate.Checked == true)
                    //////        {
                    //////            dr_final111["Rate"] = "";

                    //////        }
                    //////        if (chkboxBuyrate.Checked == true)
                    //////        {
                    //////            dr_final111["BuyRate"] = "";
                    //////        }
                    //////        dr_final111["SalesValue"] = "";
                    //////        dt.Rows.Add(dr_final111);
                    //////    }
                    //////}


                    ////FLvlSub

                    //if (DdlFirstSub.SelectedItem.Text != "None")
                    //{

                    //    if (fLvlValue != "" && fLvlValue != fLvlValueTemp)
                    //    {


                    //        DataRow dr_final55 = dt.NewRow();
                    //        if (chkboxCategory.Checked == true)
                    //        {
                    //            dr_final55["CategoryName"] = "Total : " + fLvlValueTemp;
                    //        }

                    //        if (chkboxBrand.Checked == true)
                    //        {
                    //            dr_final55["Brand"] = "";
                    //        }
                    //        if (chkboxProduct.Checked == true)
                    //        {
                    //            dr_final55["ProductName"] = "";
                    //        }
                    //        if (chkboxModel.Checked == true)
                    //        {
                    //            dr_final55["Model"] = "";
                    //        }
                    //        if (chkboxItemCode.Checked == true)
                    //        {
                    //            dr_final55["ItemCode"] = "";
                    //        }
                    //        if (chkboxStock.Checked == true)
                    //        {
                    //            dr_final55["Quantity"] = "";
                    //        }
                    //        if (chkboxVat.Checked == true)
                    //        {
                    //            dr_final55["VAT"] = "";
                    //        }
                    //        if (chkboxNlc.Checked == true)
                    //        {
                    //            dr_final55["NLC"] = "";
                    //        }
                    //        if (chkboxRate.Checked == true)
                    //        {
                    //            dr_final55["Rate"] = "";

                    //        }
                    //        if (chkboxBuyrate.Checked == true)
                    //        {
                    //            dr_final55["BuyRate"] = "";
                    //        }

                    //        dr_final55["SalesValue"] = catIDTotal;
                    //        dt.Rows.Add(dr_final55);
                    //    }
                    //}



                    fLvlValue = fLvlValueTemp;
                    sLvlValue = sLvlValueTemp;
                    tLvlValue = tLvlValueTemp;
                    frthLvlValue = frthLvlValueTemp;
                    fifLvlValue = fifthLvlValueTemp;


                    DataRow dr_final5 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final5["CategoryName"] = dr["CategoryName"];
                    }

                    if (chkboxBrand.Checked == true)
                    {
                        dr_final5["Brand"] = dr["ProductDesc"];
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final5["ProductName"] = dr["ProductName"];
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final5["Model"] = dr["Model"];
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final5["ItemCode"] = dr["ItemCode"];
                    }
                    if (chkboxStock.Checked == true)
                    {
                        dr_final5["Quantity"] = dr["Stock"];
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final5["VAT"] = dr["VAT"];
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final5["NLC"] = dr["NLC"];
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final5["Rate"] = dr["Rate"];

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final5["BuyRate"] = dr["BuyRate"];
                    }
                    /* dr_final5["Rate"] = dr["Rate"];
                     dr_final5["NLC"] = dr["NLC"];
                     dr_final5["BuyRate"] = dr["BuyRate"];
                     dr_final5["VAT"] = dr["VAT"];
                     dr_final5["Quantity"] = dr["Stock"];*/


                    dr_final5["SalesValue"] = dr["SalesValue"];
                    dt.Rows.Add(dr_final5);
                    Gtotal = Gtotal + Convert.ToDecimal(dr["SalesValue"]);
                    if (chkboxStock.Checked == true)
                    {
                        Gttl = Gttl + Convert.ToInt32(dr["Stock"]);
                    }
                    modelTotal = modelTotal + Convert.ToDecimal(dr["SalesValue"]);
                    catIDTotal = catIDTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Pttls = Pttls + Convert.ToDecimal(dr["SalesValue"]);
                    brandTotal = brandTotal + Convert.ToDecimal(dr["SalesValue"]);
                    Ittls = Ittls + Convert.ToDecimal(dr["SalesValue"]);






                }






                /* if (selLevels.IndexOf("Brand") < 0)
                     dr_final5["Brand"] = dr["ProductDesc"];
                 if (selLevels.IndexOf("CategoryName") < 0)
                     dr_final5["CategoryName"] = dr["CategoryName"];
                 if (selLevels.IndexOf("ItemCode") < 0)
                     dr_final5["ItemCode"] = dr["ItemCode"];
                 if (selLevels.IndexOf("Model") < 0)
                     dr_final5["Model"] = dr["Model"];
                 if (selLevels.IndexOf("ProductName") < 0)
                     dr_final5["ProductName"] = dr["ProductName"];*/


            }



            //Display the last Total and Grand Total
            if (dispLastTotal)
            {
                if ((chkboxCategory.Checked) || (chkboxBrand.Checked) || (chkboxProduct.Checked) || (chkboxModel.Checked) || (chkboxItemCode.Checked))
                {
                    //if (chkboxItemCode.Checked == true)
                    //{
                    //    DataRow dr_final17 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final17["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final17["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final17["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final17["Model"] = "";
                    //    }

                    //    /*dr_final17["Itemcode"] = "Total:" + fifthLvlValueTemp;
                    //    dr_final17["Rate"] = "";
                    //    dr_final17["NLC"] = "";
                    //    dr_final17["BuyRate"] = "";
                    //    dr_final17["VAT"] = "";


                    //    dr_final17["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final17["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final17["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final17["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final17["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final17["BuyRate"] = "";
                    //    }
                    //    dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                    //    dt.Rows.Add(dr_final17);
                    //    Ittls = 0;
                    //}
                    //if (chkboxModel.Checked == true)
                    //{
                    //    DataRow dr_final7 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final7["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final7["Brand"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final7["ProductName"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final7["ItemCode"] = "";
                    //    }

                    //    dr_final7["Model"] = "Total:" + frthLvlValueTemp;

                    //    /*if (selLevels.IndexOf("Brand") < 0)
                    //        dr_final7["Brand"] = "";
                    //    if (selLevels.IndexOf("CategoryName") < 0)
                    //        dr_final7["CategoryName"] = "";
                    //    if (selLevels.IndexOf("ItemCode") < 0)
                    //        dr_final7["ItemCode"] = "";
                    //    if (selLevels.IndexOf("Model") < 0)
                    //        dr_final7["Model"] = "";
                    //    if (selLevels.IndexOf("ProductName") < 0)
                    //        dr_final7["ProductName"] = "";*/
                    //    /*dr_final7["Rate"] = "";
                    //    dr_final7["NLC"] = "";
                    //    dr_final7["BuyRate"] = "";
                    //    dr_final7["VAT"] = "";

                    //    dr_final7["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final7["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final7["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final7["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final7["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final7["BuyRate"] = "";
                    //    }

                    //    dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                    //    dt.Rows.Add(dr_final7);
                    //    Pttls = 0;
                    //}

                    //if (chkboxProduct.Checked == true)
                    //{
                    //    DataRow dr_final8 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final8["CategoryName"] = "";
                    //    }
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final8["Brand"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final8["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final8["ItemCode"] = "";
                    //    }
                    //    dr_final8["ProductName"] = "Total:" + tLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final8["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final8["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final8["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final8["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final8["ProductName"] = "";*/
                    //    /* dr_final8["Rate"] = "";
                    //     dr_final8["NLC"] = "";
                    //     dr_final8["BuyRate"] = "";
                    //     dr_final8["VAT"] = "";

                    //     dr_final8["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final8["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final8["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final8["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final8["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final8["BuyRate"] = "";
                    //    }
                    //    dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                    //    dt.Rows.Add(dr_final8);
                    //    modelTotal = 0;
                    //}

                    //if (chkboxBrand.Checked == true)
                    //{
                    //    DataRow dr_final9 = dt.NewRow();
                    //    if (chkboxCategory.Checked == true)
                    //    {
                    //        dr_final9["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final9["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final9["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final9["ItemCode"] = "";
                    //    }
                    //    dr_final9["Brand"] = "Total:" + sLvlValueTemp;
                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final9["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final9["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final9["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final9["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final9["ProductName"] = "";*/
                    //    /*dr_final9["Rate"] = "";
                    //    dr_final9["NLC"] = "";
                    //    dr_final9["BuyRate"] = "";
                    //    dr_final9["VAT"] = "";

                    //    dr_final9["Quantity"] = "";*/

                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final9["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final9["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final9["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final9["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final9["BuyRate"] = "";
                    //    }
                    //    dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                    //    dt.Rows.Add(dr_final9);
                    //    catIDTotal = 0;
                    //}

                    //if (chkboxCategory.Checked == true)
                    //{
                    //    DataRow dr_final10 = dt.NewRow();
                    //    if (chkboxBrand.Checked == true)
                    //    {
                    //        dr_final10["CategoryName"] = "";
                    //    }
                    //    if (chkboxProduct.Checked == true)
                    //    {
                    //        dr_final10["ProductName"] = "";
                    //    }
                    //    if (chkboxModel.Checked == true)
                    //    {
                    //        dr_final10["Model"] = "";
                    //    }
                    //    if (chkboxItemCode.Checked == true)
                    //    {
                    //        dr_final10["ItemCode"] = "";
                    //    }
                    //    dr_final10["CategoryName"] = "Total:" + fLvlValueTemp;

                    //    /* if (selLevels.IndexOf("Brand") < 0)
                    //         dr_final10["Brand"] = "";
                    //     if (selLevels.IndexOf("CategoryName") < 0)
                    //         dr_final10["CategoryName"] = "";
                    //     if (selLevels.IndexOf("ItemCode") < 0)
                    //         dr_final10["ItemCode"] = "";
                    //     if (selLevels.IndexOf("Model") < 0)
                    //         dr_final10["Model"] = "";
                    //     if (selLevels.IndexOf("ProductName") < 0)
                    //         dr_final10["ProductName"] = "";*/

                    //    /*dr_final10["Rate"] = "";
                    //    dr_final10["NLC"] = "";
                    //    dr_final10["BuyRate"] = "";
                    //    dr_final10["VAT"] = "";

                    //    dr_final10["Quantity"] = "";*/
                    //    if (chkboxStock.Checked == true)
                    //    {
                    //        dr_final10["Quantity"] = "";
                    //    }
                    //    if (chkboxVat.Checked == true)
                    //    {
                    //        dr_final10["VAT"] = "";
                    //    }
                    //    if (chkboxNlc.Checked == true)
                    //    {
                    //        dr_final10["NLC"] = "";
                    //    }
                    //    if (chkboxRate.Checked == true)
                    //    {
                    //        dr_final10["Rate"] = "";

                    //    }
                    //    if (chkboxBuyrate.Checked == true)
                    //    {
                    //        dr_final10["BuyRate"] = "";
                    //    }
                    //    dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                    //    dt.Rows.Add(dr_final10);
                    //    brandTotal = 0;
                    //}

                    DataRow dr_final6 = dt.NewRow();
                    if (chkboxCategory.Checked == true)
                    {
                        dr_final6["CategoryName"] = "Grand Total: ";
                    }
                    if (chkboxBrand.Checked == true)
                    {
                        dr_final6["Brand"] = "";
                    }
                    if (chkboxProduct.Checked == true)
                    {
                        dr_final6["ProductName"] = "";
                    }
                    if (chkboxModel.Checked == true)
                    {
                        dr_final6["Model"] = "";
                    }
                    if (chkboxItemCode.Checked == true)
                    {
                        dr_final6["ItemCode"] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }
                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }

                else if ((ddlfirstlvl.SelectedItem.Text != "None") || (ddlsecondlvl.SelectedItem.Text != "None") || (ddlthirdlvl.SelectedItem.Text != "None") || (ddlfourlvl.SelectedItem.Text != "None") || (ddlfifthlvl.SelectedItem.Text != "None"))
                {

                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final17 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final17[ddlfourlvl.SelectedItem.Text] = "";
                        }


                        dr_final17[ddlfifthlvl.SelectedItem.Text] = "Total:" + fifthLvlValueTemp;

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final17["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final17["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final17["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final17["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final17["ProductName"] = "";*/
                        /*dr_final17["Rate"] = "";
                        dr_final17["NLC"] = "";
                        dr_final17["BuyRate"] = "";
                        dr_final17["VAT"] = "";


                        dr_final17["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final17["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final17["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final17["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final17["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final17["BuyRate"] = "";
                        }

                        dr_final17["SalesValue"] = Convert.ToString(Convert.ToDecimal(Ittls));
                        dt.Rows.Add(dr_final17);
                        Ittls = 0;
                    }


                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final7 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final7[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final7[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        dr_final7[ddlfourlvl.SelectedItem.Text] = "Total:" + frthLvlValueTemp;

                        /*if (selLevels.IndexOf("Brand") < 0)
                            dr_final7["Brand"] = "";
                        if (selLevels.IndexOf("CategoryName") < 0)
                            dr_final7["CategoryName"] = "";
                        if (selLevels.IndexOf("ItemCode") < 0)
                            dr_final7["ItemCode"] = "";
                        if (selLevels.IndexOf("Model") < 0)
                            dr_final7["Model"] = "";
                        if (selLevels.IndexOf("ProductName") < 0)
                            dr_final7["ProductName"] = "";*/
                        /*dr_final7["Rate"] = "";
                        dr_final7["NLC"] = "";
                        dr_final7["BuyRate"] = "";
                        dr_final7["VAT"] = "";

                        dr_final7["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final7["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final7["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final7["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final7["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final7["BuyRate"] = "";
                        }

                        dr_final7["SalesValue"] = Convert.ToString(Convert.ToDecimal(Pttls));
                        dt.Rows.Add(dr_final7);
                        Pttls = 0;
                    }

                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final8 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlthirdlvl.SelectedItem.Text] = "Total: " + tLvlValueTemp;
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final8[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final8[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final8["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final8["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final8["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final8["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final8["ProductName"] = "";*/
                        /* dr_final8["Rate"] = "";
                         dr_final8["NLC"] = "";
                         dr_final8["BuyRate"] = "";
                         dr_final8["VAT"] = "";

                         dr_final8["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final8["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final8["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final8["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final8["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final8["BuyRate"] = "";
                        }

                        dr_final8["SalesValue"] = Convert.ToString(Convert.ToDecimal(modelTotal));
                        dt.Rows.Add(dr_final8);
                        modelTotal = 0;
                    }

                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final9 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfirstlvl.SelectedItem.Text] = "";
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlsecondlvl.SelectedItem.Text] = "Total: " + sLvlValueTemp;
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final9[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final9[ddlfifthlvl.SelectedItem.Text] = "";
                        }
                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final9["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final9["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final9["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final9["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final9["ProductName"] = "";*/
                        /*["Rate"] = "";
                        dr_final9["NLC"] = "";
                        dr_final9["BuyRate"] = "";
                        dr_final9["VAT"] = "";

                        dr_final9["Quantity"] = "";*/

                        if (chkboxStock.Checked == true)
                        {
                            dr_final9["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final9["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final9["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final9["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final9["BuyRate"] = "";
                        }

                        dr_final9["SalesValue"] = Convert.ToString(Convert.ToDecimal(catIDTotal));
                        dt.Rows.Add(dr_final9);
                        catIDTotal = 0;
                    }

                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        DataRow dr_final10 = dt.NewRow();
                        if (ddlfirstlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfirstlvl.SelectedItem.Text] = "Total: " + fLvlValueTemp;
                        }
                        if (ddlsecondlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlsecondlvl.SelectedItem.Text] = "";
                        }
                        if (ddlthirdlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlthirdlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfourlvl.SelectedItem.Text != "None")
                        {
                            dr_final10[ddlfourlvl.SelectedItem.Text] = "";
                        }
                        if (ddlfifthlvl.SelectedItem.Text != "None")
                        {
                            //dr_final8[ddlfourlvl.SelectedItem.Text] = "Total " + tLvlValueTemp;
                            dr_final10[ddlfifthlvl.SelectedItem.Text] = "";
                        }

                        /* if (selLevels.IndexOf("Brand") < 0)
                             dr_final10["Brand"] = "";
                         if (selLevels.IndexOf("CategoryName") < 0)
                             dr_final10["CategoryName"] = "";
                         if (selLevels.IndexOf("ItemCode") < 0)
                             dr_final10["ItemCode"] = "";
                         if (selLevels.IndexOf("Model") < 0)
                             dr_final10["Model"] = "";
                         if (selLevels.IndexOf("ProductName") < 0)
                             dr_final10["ProductName"] = "";*/

                        /* dr_final10["Rate"] = "";
                         dr_final10["NLC"] = "";
                         dr_final10["BuyRate"] = "";
                         dr_final10["VAT"] = "";

                         dr_final10["Quantity"] = "";*/
                        if (chkboxStock.Checked == true)
                        {
                            dr_final10["Quantity"] = "";
                        }
                        if (chkboxVat.Checked == true)
                        {
                            dr_final10["VAT"] = "";
                        }
                        if (chkboxNlc.Checked == true)
                        {
                            dr_final10["NLC"] = "";
                        }
                        if (chkboxRate.Checked == true)
                        {
                            dr_final10["Rate"] = "";

                        }
                        if (chkboxBuyrate.Checked == true)
                        {
                            dr_final10["BuyRate"] = "";
                        }

                        dr_final10["SalesValue"] = Convert.ToString(Convert.ToDecimal(brandTotal));
                        dt.Rows.Add(dr_final10);
                        brandTotal = 0;
                    }

                    DataRow dr_final6 = dt.NewRow();
                    if (ddlfirstlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfirstlvl.SelectedItem.Text] = "Grand Total: ";
                    }
                    if (ddlsecondlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlsecondlvl.SelectedItem.Text] = "";
                    }
                    if (ddlthirdlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlthirdlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfourlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfourlvl.SelectedItem.Text] = "";
                    }
                    if (ddlfifthlvl.SelectedItem.Text != "None")
                    {
                        dr_final6[ddlfifthlvl.SelectedItem.Text] = "";
                    }

                    /* if (selLevels.IndexOf("Brand") < 0)
                         dr_final6["Brand"] = "";
                     if (selLevels.IndexOf("CategoryName") < 0)
                         dr_final6["CategoryName"] = "";
                     if (selLevels.IndexOf("ItemCode") < 0)
                         dr_final6["ItemCode"] = "Grand Total: ";
                     if (selLevels.IndexOf("Model") < 0)
                         dr_final6["Model"] = "";
                     if (selLevels.IndexOf("ProductName") < 0)
                         dr_final6["ProductName"] = "";*/

                    /*dr_final6["Rate"] = "";
                    dr_final6["NLC"] = "";
                    dr_final6["BuyRate"] = "";
                    dr_final6["VAT"] = "";
                    dr_final6["Quantity"] = Convert.ToInt32(Gttl);*/

                    if (chkboxStock.Checked == true)
                    {
                        dr_final6["Quantity"] = Convert.ToInt32(Gttl);
                    }
                    if (chkboxVat.Checked == true)
                    {
                        dr_final6["VAT"] = "";
                    }
                    if (chkboxNlc.Checked == true)
                    {
                        dr_final6["NLC"] = "";
                    }
                    if (chkboxRate.Checked == true)
                    {
                        dr_final6["Rate"] = "";

                    }
                    if (chkboxBuyrate.Checked == true)
                    {
                        dr_final6["BuyRate"] = "";
                    }

                    dr_final6["SalesValue"] = Convert.ToDecimal(Gtotal);
                    dt.Rows.Add(dr_final6);
                }
            }

            ExportToExcel(dt);
        }
        else
        {
            ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('No Data Found');", true);
        }
    }


    private bool isValidLevelsF()
    {
        if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
        {
            if ((DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
            {
                if (chkboxBrand.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Brand');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
            {
                if (chkboxModel.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Model');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
            {
                if (chkboxCategory.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Category Name');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
            {
                if (chkboxProduct.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Product Name');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
            {
                if (chkboxItemCode.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Product Code');", true);
                    return false;
                }
            }
            
        }


        if (chkboxCategory.Checked == true)
        {
            if ((DdlFirstSub.SelectedItem.Text != "CategoryName") && (DdlSecondSub.SelectedItem.Text != "CategoryName") && (DdlThirdSub.SelectedItem.Text != "CategoryName") && (DdlFourSub.SelectedItem.Text != "CategoryName") && (DdlFiveSub.SelectedItem.Text != "CategoryName"))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select Category in Subtotal');", true);
                return false;
            }
        }

        if (chkboxBrand.Checked == true)
        {
            if ((DdlFirstSub.SelectedItem.Text != "Brand") && (DdlSecondSub.SelectedItem.Text != "Brand") && (DdlThirdSub.SelectedItem.Text != "Brand") && (DdlFourSub.SelectedItem.Text != "Brand") && (DdlFiveSub.SelectedItem.Text != "Brand"))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select Brand in Subtotal');", true);
                return false;
            }
        }

        if (chkboxModel.Checked == true)
        {
            if ((DdlFirstSub.SelectedItem.Text != "Model") && (DdlSecondSub.SelectedItem.Text != "Model") && (DdlThirdSub.SelectedItem.Text != "Model") && (DdlFourSub.SelectedItem.Text != "Model") && (DdlFiveSub.SelectedItem.Text != "Model"))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select Model in Subtotal');", true);
                return false;
            }
        }

        if (chkboxProduct.Checked == true)
        {
            if ((DdlFirstSub.SelectedItem.Text != "ProductName") && (DdlSecondSub.SelectedItem.Text != "ProductName") && (DdlThirdSub.SelectedItem.Text != "ProductName") && (DdlFourSub.SelectedItem.Text != "ProductName") && (DdlFiveSub.SelectedItem.Text != "ProductName"))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select ProductName in Subtotal');", true);
                return false;
            }
        }
        if (chkboxItemCode.Checked == true)
        {
            if ((DdlFirstSub.SelectedItem.Text != "ItemCode") && (DdlSecondSub.SelectedItem.Text != "ItemCode") && (DdlThirdSub.SelectedItem.Text != "ItemCode") && (DdlFourSub.SelectedItem.Text != "ItemCode") && (DdlFiveSub.SelectedItem.Text != "ItemCode"))
            {
                ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please select ProductCode in Subtotal');", true);
                return false;
            }
        }
        
        return true;
    }


    private bool isValidLevelsFF()
    {
        if ((DdlFirstSub.SelectedItem.Text != "None") || (DdlSecondSub.SelectedItem.Text != "None") || (DdlThirdSub.SelectedItem.Text != "None") || (DdlFourSub.SelectedItem.Text != "None") || (DdlFiveSub.SelectedItem.Text != "None"))
        {
            if ((DdlFirstSub.SelectedItem.Text == "Brand") || (DdlSecondSub.SelectedItem.Text == "Brand") || (DdlThirdSub.SelectedItem.Text == "Brand") || (DdlFourSub.SelectedItem.Text == "Brand") || (DdlFiveSub.SelectedItem.Text == "Brand"))
            {
                if (chkboxBrand.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Brand');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "Model") || (DdlSecondSub.SelectedItem.Text == "Model") || (DdlThirdSub.SelectedItem.Text == "Model") || (DdlFourSub.SelectedItem.Text == "Model") || (DdlFiveSub.SelectedItem.Text == "Model"))
            {
                if (chkboxModel.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Model');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "CategoryName") || (DdlSecondSub.SelectedItem.Text == "CategoryName") || (DdlThirdSub.SelectedItem.Text == "CategoryName") || (DdlFourSub.SelectedItem.Text == "CategoryName") || (DdlFiveSub.SelectedItem.Text == "CategoryName"))
            {
                if (chkboxCategory.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Category Name');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "ProductName") || (DdlSecondSub.SelectedItem.Text == "ProductName") || (DdlThirdSub.SelectedItem.Text == "ProductName") || (DdlFourSub.SelectedItem.Text == "ProductName") || (DdlFiveSub.SelectedItem.Text == "ProductName"))
            {
                if (chkboxProduct.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Product Name');", true);
                    return false;
                }
            }
            if ((DdlFirstSub.SelectedItem.Text == "ItemCode") || (DdlSecondSub.SelectedItem.Text == "ItemCode") || (DdlThirdSub.SelectedItem.Text == "ItemCode") || (DdlFourSub.SelectedItem.Text == "ItemCode") || (DdlFiveSub.SelectedItem.Text == "ItemCode"))
            {
                if (chkboxItemCode.Checked != true)
                {
                    ScriptManager.RegisterStartupScript(Page, typeof(Button), "MyScript", "alert('Please Check Product Code');", true);
                    return false;
                }
            }

        }


        return true;
    }



}